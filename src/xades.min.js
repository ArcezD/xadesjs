"use strict";function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var h,g=a[Symbol.iterator]();!(d=(h=g.next()).done)&&(c.push(h.value),!b||c.length!==b);d=!0);}catch(a){e=!0,f=a}finally{try{!d&&g.return&&g.return()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_get=function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(void 0===e){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if("value"in e)return e.value;var g=e.get;if(void 0!==g)return g.call(d)},_createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};!function(a,b){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?b(exports):"function"==typeof define&&define.amd?define(["exports"],b):b(a.XAdES=a.XAdES||{})}(this,function(a){function c(a,c){function d(){this.constructor=a}b(a,c),a.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}function d(a,b,c,d){var g,e=arguments.length,f=e<3?b:null===d?d=Object.getOwnPropertyDescriptor(b,c):d;if("object"===("undefined"==typeof Reflect?"undefined":_typeof(Reflect))&&"function"==typeof Reflect.decorate)f=Reflect.decorate(a,b,c,d);else for(var h=a.length-1;h>=0;h--)(g=a[h])&&(f=(e<3?g(f):e>3?g(b,c,f):g(b,c))||f);return e>3&&f&&Object.defineProperty(b,c,f),f}function e(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d.throw(a))}catch(a){f(a)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})}function f(a,b){function g(a){return function(b){return h([a,b])}}function h(g){if(d)throw new TypeError("Generator is already executing.");for(;c;)try{if(d=1,e&&(f=e[2&g[0]?"return":g[0]?"throw":"next"])&&!(f=f.call(e,g[1])).done)return f;switch(e=0,f&&(g=[0,f.value]),g[0]){case 0:case 1:f=g;break;case 4:return c.label++,{value:g[1],done:!1};case 5:c.label++,e=g[1],g=[0];continue;case 7:g=c.ops.pop(),c.trys.pop();continue;default:if(f=c.trys,!(f=f.length>0&&f[f.length-1])&&(6===g[0]||2===g[0])){c=0;continue}if(3===g[0]&&(!f||g[1]>f[0]&&g[1]<f[3])){c.label=g[1];break}if(6===g[0]&&c.label<f[1]){c.label=f[1],f=g;break}if(f&&c.label<f[2]){c.label=f[2],c.ops.push(g);break}f[2]&&c.ops.pop(),c.trys.pop();continue}g=b.call(a,c)}catch(a){g=[6,a],e=0}finally{d=f=0}if(5&g[0])throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}var d,e,f,c={label:0,sent:function(){if(1&f[0])throw f[1];return f[1]},trys:[],ops:[]};return{next:g(0),throw:g(1),return:g(2)}}function k(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];for(var e=arguments[0],f=1;f<arguments.length;f++){var g=arguments[f];for(var h in g)e[h]=g[h]}return e}function l(a){return function(b){var c=b;c.localName=a.localName||c.name,c.namespaceURI=a.namespaceURI||c.namespaceURI||null,c.prefix=a.prefix||c.prefix||null,c.parser=a.parser||c.parser,c.target!==c&&(c.items=k({},c.items)),c.target=b}}function m(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(b,c){var d=b.constructor,e=c;d.items||(d.items={}),d.target!==d&&(d.items=k({},d.items)),d.target=b,a.parser?d.items[e]={parser:a.parser,required:a.required||!1,maxOccurs:a.maxOccurs||j,minOccurs:void 0===a.minOccurs?0:a.minOccurs,noRoot:a.noRoot||!1}:d.items[e]={namespaceURI:a.namespaceURI||null,required:a.required||!1,prefix:a.prefix||null,defaultValue:a.defaultValue,converter:a.converter},a.localName=a.localName||a.parser&&a.parser.localName||e,d.items[e].namespaceURI=a.namespaceURI||a.parser&&a.parser.namespaceURI||null,d.items[e].prefix=a.prefix||a.parser&&a.parser.prefix||null,d.items[e].localName=a.localName,d.items[e].type=g,p(b,e,a)}}function n(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{required:!1,namespaceURI:null};return function(b,c){var d=b.constructor,e=c;a.localName||(a.localName=c),d.items||(d.items={}),d.target!==d&&(d.items=k({},d.items)),d.target=b,d.items[c]=a,d.items[c].type=h,p(b,e,a)}}function o(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{required:!1};return function(b,c){var d=b.constructor,e=c;d.items||(d.items={}),d.target!==d&&(d.items=k({},d.items)),d.target=b,d.items[c]=a,d.items[c].type=i,p(b,e,a)}}function p(a,b,c){var d="_"+b,e={set:function(b){this[d]!==b&&(this.element=null,this[d]=b)},get:function(){if(void 0===this[d]){var b=c.defaultValue;c.parser&&(b=new c.parser,b.localName=c.localName),this[d]=b}return this[d]}};Object.defineProperty(a,d,{writable:!0,enumerable:!1}),Object.defineProperty(a,b,e)}function w(a,b){for(var c=null==a.ownerDocument?a:a.ownerDocument,d=document.createNSResolver(null==a.ownerDocument?a.documentElement:a.ownerDocument.documentElement),e=c.evaluate(b,a,d,XPathResult.ANY_TYPE,null),f=[],g=void 0;g=e.iterateNext();)f.push(g);return f}function y(a){return(new DOMParser).parseFromString(a,r)}function z(a,b){var c=x(a,b);return c&&c.length>0?c[0]:null}function A(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(a&&a.nodeType===s.Element){var c=a;c.namespaceURI&&"http://www.w3.org/XML/1998/namespace"!==c.namespaceURI&&!b[c.prefix||""]&&(b[c.prefix?c.prefix:""]=a.namespaceURI);for(var d=0;d<a.childNodes.length;d++){var e=a.childNodes.item(d);e&&e.nodeType===s.Element&&A(e,b)}}}function B(a){var b={};return A(a,b),b}function C(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];for(var e=arguments[0],f=1;f<arguments.length;f++){var g=arguments[f];for(var h in g)e[h]=g[h]}return e}function D(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];for(var e=a,f=/[^%](%\d+)/g,g=null,h=[];g=f.exec(e);)h.push({arg:g[1],index:g.index});for(var i=h.length-1;i>=0;i--){var j=h[i],k=j.arg.substring(1),l=j.index+1;e=e.substring(0,l)+arguments[+k]+e.substring(l+1+k.length)}return e=e.replace("%%","%")}function E(a,b){for(var c=a+"";c.length<b;)c="0"+c;return c}function ia(a,b,c){return a instanceof Object==!1?c:b in a?a[b]:c}function ja(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.byteLength,d="",e=!0,f=!1,g=void 0;try{for(var i,h=new Uint8Array(a,b,c)[Symbol.iterator]();!(e=(i=h.next()).done);e=!0){var j=i.value,k=j.toString(16).toUpperCase();d=d+(1===k.length?"0":"")+k}}catch(a){f=!0,g=a}finally{try{!e&&h.return&&h.return()}finally{if(f)throw g}}return d}function ka(a,b,c,d){return b instanceof ArrayBuffer==!1?(a.error='Wrong parameter: inputBuffer must be "ArrayBuffer"',!1):0===b.byteLength?(a.error="Wrong parameter: inputBuffer has zero length",!1):c<0?(a.error="Wrong parameter: inputOffset less than zero",!1):d<0?(a.error="Wrong parameter: inputLength less than zero",!1):!(b.byteLength-c-d<0)||(a.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1)}function la(a,b){for(var c=0,d=a.length-1;d>=0;d--)c+=a[a.length-1-d]*Math.pow(2,b*d);return c}function ma(a,b){for(var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,d=c||-1,e=a,f=0,g=Math.pow(2,b),h=1;h<8;h++){if(a<g){var i=void 0;if(d<0)i=new ArrayBuffer(h),f=h;else{if(d<h)return new ArrayBuffer(0);i=new ArrayBuffer(d),f=d}for(var j=new Uint8Array(i),k=h-1;k>=0;k--){var l=Math.pow(2,k*b);j[f-k-1]=Math.floor(e/l),e-=j[f-k-1]*l}return i}g*=Math.pow(2,b)}return new ArrayBuffer(0)}function na(){for(var a=0,b=0,c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];var f=!0,g=!1,h=void 0;try{for(var j,i=d[Symbol.iterator]();!(f=(j=i.next()).done);f=!0){var k=j.value;a+=k.byteLength}}catch(a){g=!0,h=a}finally{try{!f&&i.return&&i.return()}finally{if(g)throw h}}var l=new ArrayBuffer(a),m=new Uint8Array(l),n=!0,o=!1,p=void 0;try{for(var r,q=d[Symbol.iterator]();!(n=(r=q.next()).done);n=!0){var s=r.value;m.set(new Uint8Array(s),b),b+=s.byteLength}}catch(a){o=!0,p=a}finally{try{!n&&q.return&&q.return()}finally{if(o)throw p}}return l}function oa(){var a=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){var b=255===a[0]&&128&a[1],c=0===a[0]&&0===(128&a[1]);(b||c)&&this.warnings.push("Needlessly long format")}for(var d=new ArrayBuffer(this.valueHex.byteLength),e=new Uint8Array(d),f=0;f<this.valueHex.byteLength;f++)e[f]=0;e[0]=128&a[0];for(var g=la(e,8),h=new ArrayBuffer(this.valueHex.byteLength),i=new Uint8Array(h),j=0;j<this.valueHex.byteLength;j++)i[j]=a[j];i[0]&=127;var k=la(i,8);return k-g}function pa(a){for(var b=a<0?a*-1:a,c=128,d=1;d<8;d++){if(b<=c){if(a<0){var e=c-b,f=ma(e,8,d),g=new Uint8Array(f);return g[0]|=128,f}var h=ma(b,8,d),i=new Uint8Array(h);if(128&i[0]){var j=h.slice(0),k=new Uint8Array(j);h=new ArrayBuffer(h.byteLength+1),i=new Uint8Array(h);for(var l=0;l<j.byteLength;l++)i[l+1]=k[l];i[0]=0}return h}c*=Math.pow(2,8)}return new ArrayBuffer(0)}function qa(a,b){if(a.byteLength!==b.byteLength)return!1;for(var c=new Uint8Array(a),d=new Uint8Array(b),e=0;e<c.length;e++)if(c[e]!==d[e])return!1;return!0}function ra(a,b){for(var c=a.toString(10),d=b-c.length,e=new Array(d),f=0;f<d;f++)e[f]="0";var g=e.join("");return g.concat(c)}function ua(a){for(var b=arguments.length>1&&void 0!==arguments[1]&&arguments[1],c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],d=0,e=0,f=0,g="",h=b?ta:sa;d<a.length;){var i=a.charCodeAt(d++);d>=a.length&&(e=1);var j=a.charCodeAt(d++);d>=a.length&&(f=1);var k=a.charCodeAt(d++),l=i>>2,m=(3&i)<<4|j>>4,n=(15&j)<<2|k>>6,o=63&k;1===e?n=o=64:1===f&&(o=64),g+=c?64===n?""+h.charAt(l)+h.charAt(m):64===o?""+h.charAt(l)+h.charAt(m)+h.charAt(n):""+h.charAt(l)+h.charAt(m)+h.charAt(n)+h.charAt(o):""+h.charAt(l)+h.charAt(m)+h.charAt(n)+h.charAt(o)}return g}function va(a){function e(a){for(var b=0;b<64;b++)if(d.charAt(b)===a)return b;return 64}function f(a){return 64===a?0:a}for(var b=arguments.length>1&&void 0!==arguments[1]&&arguments[1],c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],d=b?ta:sa,g=0,h="";g<a.length;){var i=e(a.charAt(g++)),j=g>=a.length?0:e(a.charAt(g++)),k=g>=a.length?0:e(a.charAt(g++)),l=g>=a.length?0:e(a.charAt(g++)),m=f(i)<<2|f(j)>>4,n=(15&f(j))<<4|f(k)>>2,o=(3&f(k))<<6|f(l);h+=String.fromCharCode(m),64!==k&&(h+=String.fromCharCode(n)),64!==l&&(h+=String.fromCharCode(o))}if(c){for(var p=h.length,q=-1,r=p-1;r>=0;r--)if(0!==h.charCodeAt(r)){q=r;break}q!==-1&&(h=h.slice(0,q+1))}return h}function wa(a){var b="",c=new Uint8Array(a),d=!0,e=!1,f=void 0;try{for(var h,g=c[Symbol.iterator]();!(d=(h=g.next()).done);d=!0){var i=h.value;b+=String.fromCharCode(i)}}catch(a){e=!0,f=a}finally{try{!d&&g.return&&g.return()}finally{if(e)throw f}}return b}function xa(a){for(var b=a.length,c=new ArrayBuffer(b),d=new Uint8Array(c),e=0;e<b;e++)d[e]=a.charCodeAt(e);return c}function za(a){var b=Math.log(a)/ya,c=Math.floor(b),d=Math.round(b);return c===d?c:d}function Bb(a,b,c){function e(a,b){if(a instanceof b)return a;var c=new b;return c.idBlock=a.idBlock,c.lenBlock=a.lenBlock,c.warnings=a.warnings,c.valueBeforeDecode=a.valueBeforeDecode.slice(0),c}var d=b,f=new Fa({},Object);if(ka(new Aa,a,b,c)===!1)return f.error="Wrong input parameters",{offset:-1,result:f};var g=new Uint8Array(a,b,c);if(0===g.length)return this.error="Zero buffer length",{offset:-1,result:f};var h=f.idBlock.fromBER(a,b,c);if(f.warnings.concat(f.idBlock.warnings),h===-1)return f.error=f.idBlock.error,{offset:-1,result:f};if(b=h,c-=f.idBlock.blockLength,h=f.lenBlock.fromBER(a,b,c),f.warnings.concat(f.lenBlock.warnings),h===-1)return f.error=f.lenBlock.error,{offset:-1,result:f};if(b=h,c-=f.lenBlock.blockLength,f.idBlock.isConstructed===!1&&f.lenBlock.isIndefiniteForm===!0)return f.error="Indefinite length form used for primitive encoding form",{offset:-1,result:f};var i=Fa;switch(f.idBlock.tagClass){case 1:if(f.idBlock.tagNumber>=37&&f.idBlock.isHexOnly===!1)return f.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:f};switch(f.idBlock.tagNumber){case 0:if(f.idBlock.isConstructed===!0&&f.lenBlock.length>0)return f.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:f};i=La;break;case 1:i=Na;break;case 2:i=Wa;break;case 3:i=Ua;break;case 4:i=Sa;break;case 5:i=Qa;break;case 6:i=$a;break;case 10:i=Xa;break;case 12:i=ab;break;case 14:i=wb;break;case 15:return f.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:f};case 16:i=Oa;break;case 17:i=Pa;break;case 18:i=hb;break;case 19:i=ib;break;case 20:i=jb;break;case 21:i=kb;break;case 22:i=lb;break;case 23:i=qb;break;case 24:i=rb;break;case 25:i=mb;break;case 26:i=nb;break;case 27:i=ob;break;case 28:i=eb;break;case 29:i=pb;break;case 30:i=cb;break;case 31:i=sb;break;case 32:i=tb;break;case 33:i=ub;break;case 34:i=vb;break;default:var j=void 0;j=f.idBlock.isConstructed===!0?new Ja:new Ha,j.idBlock=f.idBlock,j.lenBlock=f.lenBlock,j.warnings=f.warnings,f=j,h=f.fromBER(a,b,c)}break;case 2:case 3:case 4:default:i=f.idBlock.isConstructed===!0?Ja:Ha}return f=e(f,i),h=f.fromBER(a,b,f.lenBlock.isIndefiniteForm===!0?c:f.lenBlock.length),f.valueBeforeDecode=a.slice(d,d+f.blockLength),{offset:h,result:f}}function Cb(a){if(0===a.byteLength){var b=new Fa({},Object);return b.error="Input buffer has zero length",{offset:-1,result:b}}return Bb(a,0,a.byteLength)}function Db(a,b,c){if(c instanceof xb){for(var d=!1,e=0;e<c.value.length;e++){var f=Db(a,b,c.value[e]);if(f.verified===!0)return{verified:!0,result:a}}if(d===!1){var g={verified:!1,result:{error:"Wrong values for Choice type"}};return c.hasOwnProperty("name")&&(g.name=c.name),g}}if(c instanceof yb)return c.hasOwnProperty("name")&&(a[c.name]=b),{verified:!0,result:a};if(a instanceof Object==!1)return{verified:!1,result:{error:"Wrong root object"}};if(b instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(c instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("idBlock"in c==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("fromBER"in c.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("toBER"in c.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};var h=c.idBlock.toBER(!1);if(0===h.byteLength)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};var i=c.idBlock.fromBER(h,0,h.byteLength);if(i===-1)return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(c.idBlock.hasOwnProperty("tagClass")===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(c.idBlock.tagClass!==b.idBlock.tagClass)return{verified:!1,result:a};if(c.idBlock.hasOwnProperty("tagNumber")===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(c.idBlock.tagNumber!==b.idBlock.tagNumber)return{verified:!1,result:a};if(c.idBlock.hasOwnProperty("isConstructed")===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(c.idBlock.isConstructed!==b.idBlock.isConstructed)return{verified:!1,result:a};if("isHexOnly"in c.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(c.idBlock.isHexOnly!==b.idBlock.isHexOnly)return{verified:!1,result:a};if(c.idBlock.isHexOnly===!0){if("valueHex"in c.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};var j=new Uint8Array(c.idBlock.valueHex),k=new Uint8Array(b.idBlock.valueHex);if(j.length!==k.length)return{verified:!1,result:a};for(var l=0;l<j.length;l++)if(j[l]!==k[1])return{verified:!1,result:a}}if(c.hasOwnProperty("name")&&(c.name=c.name.replace(/^\s+|\s+$/g,""),""!==c.name&&(a[c.name]=b)),c.idBlock.isConstructed===!0){var m=0,n={verified:!1},o=c.valueBlock.value.length;if(o>0&&c.valueBlock.value[0]instanceof zb&&(o=b.valueBlock.value.length),0===o)return{verified:!0,result:a};if(0===b.valueBlock.value.length&&0!==c.valueBlock.value.length){for(var p=!0,q=0;q<c.valueBlock.value.length;q++)p=p&&(c.valueBlock.value[q].optional||!1);return p===!0?{verified:!0,result:a}:(c.hasOwnProperty("name")&&(c.name=c.name.replace(/^\s+|\s+$/g,""),""!==c.name&&delete a[c.name]),a.error="Inconsistent object length",{verified:!1,result:a})}for(var r=0;r<o;r++)if(r-m>=b.valueBlock.value.length){if(c.valueBlock.value[r].optional===!1){var s={verified:!1,result:a};return a.error="Inconsistent length between ASN.1 data and schema",c.hasOwnProperty("name")&&(c.name=c.name.replace(/^\s+|\s+$/g,""),""!==c.name&&(delete a[c.name],s.name=c.name)),s}}else if(c.valueBlock.value[0]instanceof zb){if(n=Db(a,b.valueBlock.value[r],c.valueBlock.value[0].value),n.verified===!1){if(c.valueBlock.value[0].optional!==!0)return c.hasOwnProperty("name")&&(c.name=c.name.replace(/^\s+|\s+$/g,""),""!==c.name&&delete a[c.name]),n;m++}if("name"in c.valueBlock.value[0]&&c.valueBlock.value[0].name.length>0){var t={};t="local"in c.valueBlock.value[0]&&c.valueBlock.value[0].local===!0?b:a,"undefined"==typeof t[c.valueBlock.value[0].name]&&(t[c.valueBlock.value[0].name]=[]),t[c.valueBlock.value[0].name].push(b.valueBlock.value[r])}}else if(n=Db(a,b.valueBlock.value[r-m],c.valueBlock.value[r]),n.verified===!1){if(c.valueBlock.value[r].optional!==!0)return c.hasOwnProperty("name")&&(c.name=c.name.replace(/^\s+|\s+$/g,""),""!==c.name&&delete a[c.name]),n;m++}if(n.verified===!1){var u={verified:!1,result:a};return c.hasOwnProperty("name")&&(c.name=c.name.replace(/^\s+|\s+$/g,""),""!==c.name&&(delete a[c.name],u.name=c.name)),u}return{verified:!0,result:a}}if("primitiveSchema"in c&&"valueHex"in b.valueBlock){var v=Cb(b.valueBlock.valueHex);if(v.offset===-1){var w={verified:!1,result:v.result};return c.hasOwnProperty("name")&&(c.name=c.name.replace(/^\s+|\s+$/g,""),""!==c.name&&(delete a[c.name],w.name=c.name)),w}return Db(a,v.result,c.primitiveSchema)}return{verified:!0,result:a}}function Qb(a,b,c){Pb={name:a,crypto:b,subtle:c}}function Rb(){if(null!==Pb.subtle)return Pb.subtle}function Sb(a){if(null!==Pb.crypto)return Pb.crypto.getRandomValues(a);throw new Error("No support for Web Cryptography API")}function Tb(a){var b="";switch(a.name.toUpperCase()){case"RSASSA-PKCS1-V1_5":switch(a.hash.name.toUpperCase()){case"SHA-1":b="1.2.840.113549.1.1.5";break;case"SHA-256":b="1.2.840.113549.1.1.11";break;case"SHA-384":b="1.2.840.113549.1.1.12";break;case"SHA-512":b="1.2.840.113549.1.1.13"}break;case"RSA-PSS":b="1.2.840.113549.1.1.10";break;case"RSA-OAEP":b="1.2.840.113549.1.1.7";break;case"ECDSA":switch(a.hash.name.toUpperCase()){case"SHA-1":b="1.2.840.10045.4.1";break;case"SHA-256":b="1.2.840.10045.4.3.2";break;case"SHA-384":b="1.2.840.10045.4.3.3";break;case"SHA-512":b="1.2.840.10045.4.3.4"}break;case"ECDH":switch(a.kdf.toUpperCase()){case"SHA-1":b="1.3.133.16.840.63.0.2";break;case"SHA-256":b="1.3.132.1.11.1";break;case"SHA-384":b="1.3.132.1.11.2";break;case"SHA-512":b="1.3.132.1.11.3"}break;case"AES-CTR":break;case"AES-CBC":switch(a.length){case 128:b="2.16.840.1.101.3.4.1.2";break;case 192:b="2.16.840.1.101.3.4.1.22";break;case 256:b="2.16.840.1.101.3.4.1.42"}break;case"AES-CMAC":break;case"AES-GCM":switch(a.length){case 128:b="2.16.840.1.101.3.4.1.6";break;case 192:b="2.16.840.1.101.3.4.1.26";break;case 256:b="2.16.840.1.101.3.4.1.46"}break;case"AES-CFB":switch(a.length){case 128:b="2.16.840.1.101.3.4.1.4";break;case 192:b="2.16.840.1.101.3.4.1.24";break;case 256:b="2.16.840.1.101.3.4.1.44"}break;case"AES-KW":switch(a.length){case 128:b="2.16.840.1.101.3.4.1.5";break;case 192:b="2.16.840.1.101.3.4.1.25";break;case 256:b="2.16.840.1.101.3.4.1.45"}break;case"HMAC":switch(a.hash.name.toUpperCase()){case"SHA-1":b="1.2.840.113549.2.7";break;case"SHA-256":b="1.2.840.113549.2.9";break;case"SHA-384":b="1.2.840.113549.2.10";break;case"SHA-512":b="1.2.840.113549.2.11"}break;case"DH":b="1.2.840.113549.1.9.16.3.5";break;case"SHA-1":b="1.3.14.3.2.26";break;case"SHA-256":b="2.16.840.1.101.3.4.2.1";break;case"SHA-384":b="2.16.840.1.101.3.4.2.2";break;case"SHA-512":b="2.16.840.1.101.3.4.2.3";break;case"CONCAT":break;case"HKDF":break;case"PBKDF2":b="1.2.840.113549.1.5.12";break;case"P-256":b="1.2.840.10045.3.1.7";break;case"P-384":b="1.3.132.0.34";break;case"P-521":b="1.3.132.0.35"}return b}function Ub(a,b){var c={algorithm:{},usages:[]};switch(a.toUpperCase()){case"RSASSA-PKCS1-V1_5":switch(b.toLowerCase()){case"generatekey":c={algorithm:{name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["sign","verify"]};break;case"verify":case"sign":case"importkey":c={algorithm:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},usages:["verify"]};break;case"exportkey":default:return{algorithm:{name:"RSASSA-PKCS1-v1_5"},usages:[]}}break;case"RSA-PSS":switch(b.toLowerCase()){case"sign":case"verify":c={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"},saltLength:20},usages:["sign","verify"]};break;case"generatekey":c={algorithm:{name:"RSA-PSS",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-1"}},usages:["sign","verify"]};break;case"importkey":c={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"}},usages:["verify"]};break;case"exportkey":default:return{algorithm:{name:"RSA-PSS"},usages:[]}}break;case"RSA-OAEP":switch(b.toLowerCase()){case"encrypt":case"decrypt":c={algorithm:{name:"RSA-OAEP"},usages:["encrypt","decrypt"]};break;case"generatekey":c={algorithm:{name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"importkey":c={algorithm:{name:"RSA-OAEP",hash:{name:"SHA-256"}},usages:["encrypt"]};break;case"exportkey":default:return{algorithm:{name:"RSA-OAEP"},usages:[]}}break;case"ECDSA":switch(b.toLowerCase()){case"generatekey":c={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["sign","verify"]};break;case"importkey":c={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["verify"]};break;case"verify":case"sign":c={algorithm:{name:"ECDSA",hash:{name:"SHA-256"}},usages:["sign"]};break;default:return{algorithm:{name:"ECDSA"},usages:[]}}break;case"ECDH":switch(b.toLowerCase()){case"exportkey":case"importkey":case"generatekey":c={algorithm:{name:"ECDH",namedCurve:"P-256"},usages:["deriveKey","deriveBits"]};break;case"derivekey":case"derivebits":c={algorithm:{name:"ECDH",namedCurve:"P-256",public:[]},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"ECDH"},usages:[]}}break;case"AES-CTR":switch(b.toLowerCase()){case"importkey":case"exportkey":case"generatekey":c={algorithm:{name:"AES-CTR",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":c={algorithm:{name:"AES-CTR",counter:new Uint8Array(16),length:10},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-CTR"},usages:[]}}break;case"AES-CBC":switch(b.toLowerCase()){case"importkey":case"exportkey":case"generatekey":c={algorithm:{name:"AES-CBC",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":c={algorithm:{name:"AES-CBC",iv:Sb(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-CBC"},usages:[]}}break;case"AES-GCM":switch(b.toLowerCase()){case"importkey":case"exportkey":case"generatekey":c={algorithm:{name:"AES-GCM",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":c={algorithm:{name:"AES-GCM",iv:Sb(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-GCM"},usages:[]}}break;case"AES-KW":switch(b.toLowerCase()){case"importkey":case"exportkey":case"generatekey":case"wrapkey":case"unwrapkey":c={algorithm:{name:"AES-KW",length:256},usages:["wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-KW"},usages:[]}}break;case"HMAC":switch(b.toLowerCase()){case"sign":case"verify":c={algorithm:{name:"HMAC"},usages:["sign","verify"]};break;case"importkey":case"exportkey":case"generatekey":c={algorithm:{name:"HMAC",length:32,hash:{name:"SHA-256"}},usages:["sign","verify"]};break;default:return{algorithm:{name:"HMAC"},usages:[]}}break;case"HKDF":switch(b.toLowerCase()){case"derivekey":c={algorithm:{name:"HKDF",hash:"SHA-256",salt:new Uint8Array([]),info:new Uint8Array([])},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"HKDF"},usages:[]}}break;case"PBKDF2":switch(b.toLowerCase()){case"derivekey":c={algorithm:{name:"PBKDF2",hash:{name:"SHA-256"},salt:new Uint8Array([]),iterations:1e3},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"PBKDF2"},usages:[]}}}return c}function Vb(a){if(a.byteLength%2!==0)return new ArrayBuffer(0);var b=a.byteLength/2,c=new ArrayBuffer(b),d=new Uint8Array(c);d.set(new Uint8Array(a,0,b));var e=void 0,f=void 0,g=new ArrayBuffer(b),h=new Uint8Array(g);h.set(new Uint8Array(a,b,b));var i=void 0,j=void 0;switch(!0){case 0!==(128&d[0]):e=new ArrayBuffer(b+1),f=new Uint8Array(e),f[0]=0,f.set(d,1);break;case 0===d[0]&&0===(128&d[1]):e=new ArrayBuffer(b-1),f=new Uint8Array(e),f.set(new Uint8Array(a,1,b-1));break;default:e=c,f=d}switch(!0){case 0!==(128&h[0]):i=new ArrayBuffer(b+1),j=new Uint8Array(i),j[0]=0,j.set(h,1);break;case 0===h[0]&&0===(128&h[1]):i=new ArrayBuffer(b-1),j=new Uint8Array(i),j.set(new Uint8Array(a,1,b-1));break;default:i=g,j=h}var k=new Wa;k.valueBlock.isHexOnly=!0,k.valueBlock.valueHex=e.slice();var l=new Wa;return l.valueBlock.isHexOnly=!0,l.valueBlock.valueHex=i.slice(),new Oa({value:[k,l]}).toBER(!1)}function Wb(a){var b=a.replace(/^\s+|\s+$/g,"");return b=b.replace(/\s+/g," "),b=b.toLowerCase()}function Xb(a){function b(a){var b=new Uint8Array(a.valueBlock.valueHex);switch(a.valueBlock.valueHex.byteLength){case 32:case 48:case 66:return a.valueBlock.valueHex;case 33:case 49:case 67:return b.slice(1).buffer;case 31:case 47:case 65:var c=new ArrayBuffer(a.valueBlock.valueHex.byteLength+1),d=new Uint8Array(c);return d.set(b,1),c;default:return new ArrayBuffer(0)}}if(a instanceof Oa==!1)return new ArrayBuffer(0);if(2!==a.valueBlock.value.length)return new ArrayBuffer(0);if(a.valueBlock.value[0]instanceof Wa==!1)return new ArrayBuffer(0);if(a.valueBlock.value[1]instanceof Wa==!1)return new ArrayBuffer(0);var c=b(a.valueBlock.value[0]),d=b(a.valueBlock.value[1]);return na(c,d)}function Yb(a){switch(a){case"1.2.840.113549.1.1.1":case"1.2.840.113549.1.1.5":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case"1.2.840.113549.1.1.11":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"1.2.840.113549.1.1.12":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case"1.2.840.113549.1.1.13":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}};case"1.2.840.113549.1.1.10":return{name:"RSA-PSS"};case"1.2.840.113549.1.1.7":return{name:"RSA-OAEP"};case"1.2.840.10045.2.1":case"1.2.840.10045.4.1":return{name:"ECDSA",hash:{name:"SHA-1"}};case"1.2.840.10045.4.3.2":return{name:"ECDSA",hash:{name:"SHA-256"}};case"1.2.840.10045.4.3.3":return{name:"ECDSA",hash:{name:"SHA-384"}};case"1.2.840.10045.4.3.4":return{name:"ECDSA",hash:{name:"SHA-512"}};case"1.3.133.16.840.63.0.2":return{name:"ECDH",kdf:"SHA-1"};case"1.3.132.1.11.1":return{name:"ECDH",kdf:"SHA-256"};case"1.3.132.1.11.2":return{name:"ECDH",kdf:"SHA-384"};case"1.3.132.1.11.3":return{name:"ECDH",kdf:"SHA-512"};case"2.16.840.1.101.3.4.1.2":return{name:"AES-CBC",length:128};case"2.16.840.1.101.3.4.1.22":return{name:"AES-CBC",length:192};case"2.16.840.1.101.3.4.1.42":return{name:"AES-CBC",length:256};case"2.16.840.1.101.3.4.1.6":return{name:"AES-GCM",length:128};case"2.16.840.1.101.3.4.1.26":return{name:"AES-GCM",length:192};case"2.16.840.1.101.3.4.1.46":return{name:"AES-GCM",length:256};case"2.16.840.1.101.3.4.1.4":return{name:"AES-CFB",length:128};case"2.16.840.1.101.3.4.1.24":return{name:"AES-CFB",length:192};case"2.16.840.1.101.3.4.1.44":return{name:"AES-CFB",length:256};case"2.16.840.1.101.3.4.1.5":return{name:"AES-KW",length:128};case"2.16.840.1.101.3.4.1.25":return{name:"AES-KW",length:192};case"2.16.840.1.101.3.4.1.45":return{name:"AES-KW",length:256};case"1.2.840.113549.2.7":return{name:"HMAC",hash:{name:"SHA-1"}};case"1.2.840.113549.2.9":return{name:"HMAC",hash:{name:"SHA-256"}};case"1.2.840.113549.2.10":return{name:"HMAC",hash:{name:"SHA-384"}};case"1.2.840.113549.2.11":return{name:"HMAC",hash:{name:"SHA-512"}};case"1.2.840.113549.1.9.16.3.5":return{name:"DH"};case"1.3.14.3.2.26":return{name:"SHA-1"};case"2.16.840.1.101.3.4.2.1":return{name:"SHA-256"};case"2.16.840.1.101.3.4.2.2":return{name:"SHA-384"};case"2.16.840.1.101.3.4.2.3":return{name:"SHA-512"};case"1.2.840.113549.1.5.12":return{name:"PBKDF2"};case"1.2.840.10045.3.1.7":return{name:"P-256"};case"1.3.132.0.34":return{name:"P-384"};case"1.3.132.0.35":return{name:"P-521"}}return{}}function Zb(a){var b="";switch(a.algorithmId){case"1.2.840.10045.4.1":case"1.2.840.113549.1.1.5":b="SHA-1";break;case"1.2.840.10045.4.3.2":case"1.2.840.113549.1.1.11":b="SHA-256";break;case"1.2.840.10045.4.3.3":case"1.2.840.113549.1.1.12":b="SHA-384";break;case"1.2.840.10045.4.3.4":case"1.2.840.113549.1.1.13":b="SHA-512";break;case"1.2.840.113549.1.1.10":try{var c=new Fb({schema:a.algorithmParams});if("hashAlgorithm"in c){var d=Yb(c.hashAlgorithm.algorithmId);if("name"in d==!1)return"";b=d.name}else b="SHA-1"}catch(a){}}return b}function bc(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b=arguments.length>1&&void 0!==arguments[1]&&arguments[1],c=ia(a,"names",{});return new Oa({optional:b,value:[new Ja({optional:!0,idBlock:{tagClass:2,tagNumber:1},name:c.country_name||"",value:[new xb({value:[new hb,new ib]})]}),new Ja({optional:!0,idBlock:{tagClass:2,tagNumber:2},name:c.administration_domain_name||"",value:[new xb({value:[new hb,new ib]})]}),new Ha({optional:!0,idBlock:{tagClass:3,tagNumber:0},name:c.network_address||"",isHexOnly:!0}),new Ha({optional:!0,idBlock:{tagClass:3,tagNumber:1},name:c.terminal_identifier||"",isHexOnly:!0}),new Ja({optional:!0,idBlock:{tagClass:3,tagNumber:2},name:c.private_domain_name||"",value:[new xb({value:[new hb,new ib]})]}),new Ha({optional:!0,idBlock:{tagClass:3,tagNumber:3},name:c.organization_name||"",isHexOnly:!0}),new Ha({optional:!0,name:c.numeric_user_identifier||"",idBlock:{tagClass:3,tagNumber:4},isHexOnly:!0}),new Ja({optional:!0,name:c.personal_name||"",idBlock:{tagClass:3,tagNumber:5},value:[new Ha({idBlock:{tagClass:3,tagNumber:0},isHexOnly:!0}),new Ha({optional:!0,idBlock:{tagClass:3,tagNumber:1},isHexOnly:!0}),new Ha({optional:!0,idBlock:{tagClass:3,tagNumber:2},isHexOnly:!0}),new Ha({optional:!0,idBlock:{tagClass:3,tagNumber:3},isHexOnly:!0})]}),new Ja({optional:!0,name:c.organizational_unit_names||"",idBlock:{tagClass:3,tagNumber:6},value:[new zb({value:new ib})]})]})}function cc(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new Oa({optional:a,value:[new ib,new ib]})}function dc(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new Pa({optional:a,value:[new Ha({optional:!0,idBlock:{tagClass:3,tagNumber:0},isHexOnly:!0}),new Ja({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new yb]})]});
}function Cc(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b=ia(a,"names",{});return new Oa({name:b.blockName||"tbsCertificate",value:[new Ja({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Wa({name:b.tbsCertificateVersion||"tbsCertificate.version"})]}),new Wa({name:b.tbsCertificateSerialNumber||"tbsCertificate.serialNumber"}),Eb.schema(b.signature||{names:{blockName:"tbsCertificate.signature"}}),ac.schema(b.issuer||{names:{blockName:"tbsCertificate.issuer"}}),new Oa({name:b.tbsCertificateValidity||"tbsCertificate.validity",value:[hc.schema(b.notBefore||{names:{utcTimeName:"tbsCertificate.notBefore",generalTimeName:"tbsCertificate.notBefore"}}),hc.schema(b.notAfter||{names:{utcTimeName:"tbsCertificate.notAfter",generalTimeName:"tbsCertificate.notAfter"}})]}),ac.schema(b.subject||{names:{blockName:"tbsCertificate.subject"}}),Ib.schema(b.subjectPublicKeyInfo||{names:{blockName:"tbsCertificate.subjectPublicKeyInfo"}}),new Ha({name:b.tbsCertificateIssuerUniqueID||"tbsCertificate.issuerUniqueID",optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new Ha({name:b.tbsCertificateSubjectUniqueID||"tbsCertificate.subjectUniqueID",optional:!0,idBlock:{tagClass:3,tagNumber:2}}),new Ja({optional:!0,idBlock:{tagClass:3,tagNumber:3},value:[Bc.schema(b.extensions||{names:{blockName:"tbsCertificate.extensions"}})]})]})}function Ic(a,b){return a==b?0:a?b?a.prefix?b.prefix?a.prefix.localeCompare(b.prefix):1:-1:1:-1}function Jc(a,b){if(!a.namespaceURI&&b.namespaceURI)return-1;if(!b.namespaceURI&&a.namespaceURI)return 1;var c=a.namespaceURI+a.localName,d=b.namespaceURI+b.localName;return c===d?0:c<d?-1:1}function Kc(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,d=b||null;if(a.prefix===d)return++c;if(a.attributes)for(var e=0;e<a.attributes.length;e++){var f=a.attributes[e];if(!Lc(f)&&b&&a.attributes[e].prefix===b)return++c}for(var g=a.firstChild;g;g=g.nextSibling)if(g.nodeType===s.Element){var h=g,i=Kc(h,b,c);if(g.nodeType===s.Element&&i)return++c+i}return c}function Lc(a){var b=/xmlns:/;return!(null===a||a.nodeType!==s.Attribute||"xmlns"!==a.nodeName&&!b.test(a.nodeName))}function ce(a,b){var c=new b;return c.element=a.Element,c}function pe(a){switch(a){case"P-256":return"urn:oid:1.2.840.10045.3.1.7";case"P-384":return"urn:oid:1.3.132.0.34";case"P-521":return"urn:oid:1.3.132.0.35"}throw new F(G.CRYPTOGRAPHIC,"Unknown NamedCurve")}function qe(a){switch(a){case"urn:oid:1.2.840.10045.3.1.7":return"P-256";case"urn:oid:1.3.132.0.34":return"P-384";case"urn:oid:1.3.132.0.35":return"P-521"}throw new F(G.CRYPTOGRAPHIC,"Unknown NamedCurve OID")}function Ce(a,b){if(a.nodeType!==s.Element)return null;if(a.hasAttribute("Id")&&a.getAttribute("Id")===b)return a;if(a.childNodes&&a.childNodes.length)for(var c=0;c<a.childNodes.length;c++){var d=Ce(a.childNodes[c],b);if(d)return d}return null}var s,b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},g="element",h="attribute",i="content",j=1e9,q=function(){function a(b){_classCallCheck(this,a),this.items=new Array,b&&(this.items=b)}return _createClass(a,[{key:"Item",value:function(b){return this.items[b]||null}},{key:"Add",value:function(b){this.items.push(b)}},{key:"Pop",value:function(){return this.items.pop()}},{key:"RemoveAt",value:function(b){this.items=this.items.filter(function(a,c){return c!==b})}},{key:"Clear",value:function(){this.items=new Array}},{key:"GetIterator",value:function(){return this.items}},{key:"ForEach",value:function(b){this.GetIterator().forEach(b)}},{key:"Map",value:function(c){return new a(this.GetIterator().map(c))}},{key:"Filter",value:function(c){return new a(this.GetIterator().filter(c))}},{key:"Sort",value:function(c){return new a(this.GetIterator().sort(c))}},{key:"Every",value:function(b){return this.GetIterator().every(b)}},{key:"Some",value:function(b){return this.GetIterator().some(b)}},{key:"IsEmpty",value:function(){return 0===this.Count}},{key:"Count",get:function(){return this.items.length}}]),a}(),r="application/xml";!function(a){a[a.None=0]="None",a[a.Element=1]="Element",a[a.Attribute=2]="Attribute",a[a.Text=3]="Text",a[a.CDATA=4]="CDATA",a[a.EntityReference=5]="EntityReference",a[a.Entity=6]="Entity",a[a.ProcessingInstruction=7]="ProcessingInstruction",a[a.Comment=8]="Comment",a[a.Document=9]="Document",a[a.DocumentType=10]="DocumentType",a[a.DocumentFragment=11]="DocumentFragment",a[a.Notation=12]="Notation",a[a.Whitespace=13]="Whitespace",a[a.SignificantWhitespace=14]="SignificantWhitespace",a[a.EndElement=15]="EndElement",a[a.EndEntity=16]="EndEntity",a[a.XmlDeclaration=17]="XmlDeclaration"}(s||(s={}));var t=function(b,c){throw new Error("Not implemented")},u=void 0;if("undefined"==typeof self){u=global;var v=require("xmldom-alpha");t=require("xpath.js"),u.XMLSerializer=v.XMLSerializer,u.DOMParser=v.DOMParser,u.DOMImplementation=v.DOMImplementation,u.document=(new DOMImplementation).createDocument("http://www.w3.org/1999/xhtml","html",null)}else u=self;var G,x="undefined"!=typeof self?w:t,F=function a(b){for(var c=arguments.length,d=Array(c>1?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];_classCallCheck(this,a),this.prefix="XMLJS",this.code=b,this.name=this.constructor.name,arguments[0]=H[b];var f=D.apply(this,arguments);this.message=""+this.prefix+E(b,4)+": "+f,this.stack=new Error(this.message).stack};!function(a){a[a.NONE=0]="NONE",a[a.NULL_REFERENCE=1]="NULL_REFERENCE",a[a.NULL_PARAM=2]="NULL_PARAM",a[a.DECORATOR_NULL_PARAM=3]="DECORATOR_NULL_PARAM",a[a.COLLECTION_LIMIT=4]="COLLECTION_LIMIT",a[a.METHOD_NOT_IMPLEMENTED=5]="METHOD_NOT_IMPLEMENTED",a[a.METHOD_NOT_SUPPORTED=6]="METHOD_NOT_SUPPORTED",a[a.PARAM_REQUIRED=7]="PARAM_REQUIRED",a[a.CONVERTER_UNSUPPORTED=8]="CONVERTER_UNSUPPORTED",a[a.ELEMENT_MALFORMED=9]="ELEMENT_MALFORMED",a[a.ELEMENT_MISSING=10]="ELEMENT_MISSING",a[a.ATTRIBUTE_MISSING=11]="ATTRIBUTE_MISSING",a[a.CONTENT_MISSING=12]="CONTENT_MISSING",a[a.CRYPTOGRAPHIC=13]="CRYPTOGRAPHIC",a[a.CRYPTOGRAPHIC_NO_MODULE=14]="CRYPTOGRAPHIC_NO_MODULE",a[a.CRYPTOGRAPHIC_UNKNOWN_TRANSFORM=15]="CRYPTOGRAPHIC_UNKNOWN_TRANSFORM",a[a.ALGORITHM_NOT_SUPPORTED=16]="ALGORITHM_NOT_SUPPORTED",a[a.ALGORITHM_WRONG_NAME=17]="ALGORITHM_WRONG_NAME",a[a.XML_EXCEPTION=18]="XML_EXCEPTION"}(G||(G={}));var H={};H[G.NONE]="No decription",H[G.NULL_REFERENCE]="Null reference",H[G.NULL_PARAM]="'%1' has empty '%2' object",H[G.DECORATOR_NULL_PARAM]="Decorator '%1' has empty '%2' parameter",H[G.COLLECTION_LIMIT]="Collection of '%1' in element '%2' has wrong amount of items",H[G.METHOD_NOT_IMPLEMENTED]="Method is not implemented",H[G.METHOD_NOT_SUPPORTED]="Method is not supported",H[G.PARAM_REQUIRED]="Required parameter is missing '%1'",H[G.CONVERTER_UNSUPPORTED]="Converter is not supported",H[G.ELEMENT_MALFORMED]="Malformed element '%1'",H[G.ELEMENT_MISSING]="Element '%1' is missing in '%2'",H[G.ATTRIBUTE_MISSING]="Attribute '%1' is missing in '%2'",H[G.CONTENT_MISSING]="Content is missing in '%1'",H[G.CRYPTOGRAPHIC]="Cryptographic error: %1",H[G.CRYPTOGRAPHIC_NO_MODULE]="WebCrypto module is not found",H[G.CRYPTOGRAPHIC_UNKNOWN_TRANSFORM]="Unknown transform %1",H[G.ALGORITHM_NOT_SUPPORTED]="Algorithm is not supported '%1'",H[G.ALGORITHM_WRONG_NAME]="Algorithm wrong name in use '%1'",H[G.XML_EXCEPTION]="XML exception: %1";var I=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"ToString",value:function(b){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8",d=new Uint8Array(b);switch(c.toLowerCase()){case"utf8":return this.ToUtf8String(d);case"binary":return this.ToBinary(d);case"hex":return this.ToHex(d);case"base64":return this.ToBase64(d);case"base64url":return this.ToBase64Url(d);default:throw new F(G.CONVERTER_UNSUPPORTED)}}},{key:"FromString",value:function(b){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";switch(c.toLowerCase()){case"utf8":return this.FromUtf8String(b);case"binary":return this.FromBinary(b);case"hex":return this.FromHex(b);case"base64":return this.FromBase64(b);case"base64url":return this.FromBase64Url(b);default:throw new F(G.CONVERTER_UNSUPPORTED)}}},{key:"ToBase64",value:function(b){if("undefined"!=typeof btoa){var c=this.ToString(b,"binary");return btoa(c)}if("undefined"!=typeof Buffer)return new Buffer(b).toString("base64");throw new F(G.CONVERTER_UNSUPPORTED)}},{key:"FromBase64",value:function(b){if(b=b.replace(/\n/g,"").replace(/\r/g,"").replace(/\t/g,"").replace(/\s/g,""),"undefined"!=typeof atob)return this.FromBinary(atob(b));if("undefined"!=typeof Buffer)return new Buffer(b,"base64");throw new F(G.CONVERTER_UNSUPPORTED)}},{key:"Base64Padding",value:function(b){var c=4-b.length%4;if(c<4)for(var d=0;d<c;d++)b+="=";return b}},{key:"FromBase64Url",value:function(b){return this.FromBase64(this.Base64Padding(b.replace(/\-/g,"+").replace(/\_/g,"/")))}},{key:"ToBase64Url",value:function(b){return this.ToBase64(b).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}},{key:"FromUtf8String",value:function(b){for(var c=unescape(encodeURIComponent(b)),d=new Uint8Array(c.length),e=0;e<c.length;e++)d[e]=c.charCodeAt(e);return d}},{key:"ToUtf8String",value:function(b){var c=String.fromCharCode.apply(null,b),d=decodeURIComponent(escape(c));return d}},{key:"FromBinary",value:function(b){for(var c=b.length,d=new Uint8Array(c),e=0;e<c;e++)d[e]=b.charCodeAt(e);return d}},{key:"ToBinary",value:function(b){for(var c="",d=0;d<b.length;d++)c+=String.fromCharCode(b[d]);return c}},{key:"ToHex",value:function(b){for(var c="",d=[],e=0;e<b.length;e++){var f=b[e].toString(16);d.push(1===f.length?"0"+f:f)}return d.join(c)}},{key:"FromHex",value:function(b){for(var c=new Uint8Array(b.length/2),d=0;d<b.length;d+=2){var e=b.slice(d,d+2);c[d/2]=parseInt(e,16)}return c}},{key:"ToDateTime",value:function(b){return new Date(b)}},{key:"FromDateTime",value:function(b){var c=b.toISOString();return c}}]),a}(),J={get:function(b){if(b)return I.ToBase64(b)},set:function(b){return I.FromBase64(b)}},K={get:function(b){return b?b.toString():"0"},set:function(b){return Number(b)}},L="xml_root",M=function(){function a(){_classCallCheck(this,a),this.prefix=this.GetStatic().prefix||null,this.localName=this.GetStatic().localName,this.namespaceURI=this.GetStatic().namespaceURI}return _createClass(a,[{key:"GetStatic",value:function(){return this.constructor}},{key:"GetPrefix",value:function(){return this.Prefix?this.prefix+":":""}},{key:"HasChanged",value:function(){var b=this.GetStatic();if(b.items)for(var c in b.items){var d=b.items[c],e=this[c];if(d.parser&&e&&e.HasChanged())return!0}return null===this.element}},{key:"OnGetXml",value:function(b){}},{key:"GetXml",value:function(b){if(!b&&!this.HasChanged())return this.element||null;var c=this.CreateDocument(),d=this.CreateElement(),e=this.GetStatic(),f=this.localName;if(e.items)for(var j in e.items){var k=this[j],l=e.items[j];switch(l.type){case i:var m=l,n=m.converter?m.converter.get(k):k;if(m.required&&(null===n||void 0===n))throw new F(G.CONTENT_MISSING,f);(m.defaultValue!==k||m.required)&&(d.textContent=n);break;case h:var o=l,p=o.converter?o.converter.get(k):k;if(o.required&&(null===p||void 0===p))throw new F(G.ATTRIBUTE_MISSING,o.localName,f);(o.defaultValue!==k||o.required)&&(o.namespaceURI?d.setAttributeNS(o.namespaceURI,o.localName,p):d.setAttribute(o.localName,p));break;case g:var q=l,r=null;if(q.parser){if(q.required&&!k||q.minOccurs&&!k.Count)throw new F(G.ELEMENT_MISSING,k.localName,f);k&&(r=k.GetXml(void 0===k.element&&(q.required||k.Count)))}else{var t=q.converter?q.converter.get(k):k;if(q.required&&void 0===t)throw new F(G.ELEMENT_MISSING,q.localName,f);(k!==q.defaultValue||q.required)&&(r=q.namespaceURI?c.createElementNS(q.namespaceURI,""+(q.prefix?q.prefix+":":"")+q.localName):c.createElement(""+(q.prefix?q.prefix+":":"")+q.localName),r.textContent=t)}if(r)if(q.noRoot){for(var u=[],v=0;v<r.childNodes.length;v++){var w=r.childNodes.item(v);w.nodeType===s.Element&&u.push(w)}if(u.length<q.minOccurs||u.length>q.maxOccurs)throw new F(G.COLLECTION_LIMIT,k.localName,e.localName);u.forEach(function(a){return d.appendChild(a.cloneNode(!0))})}else{if(r.childNodes.length<q.minOccurs||r.childNodes.length>q.maxOccurs)throw new F(G.COLLECTION_LIMIT,k.localName,e.localName);d.appendChild(r)}}}return this.OnGetXml(d),this.element=d,d}},{key:"OnLoadXml",value:function(b){}},{key:"LoadXml",value:function(b){var c=void 0;if("string"==typeof b){var d=y(b);c=d.documentElement}else c=b;if(!c)throw new F(G.PARAM_REQUIRED,"element");var e=this.GetStatic(),f=this.localName;if(c.localName!==f||c.namespaceURI!=this.NamespaceURI)throw new F(G.ELEMENT_MALFORMED,f);if(e.items)for(var j in e.items){var k=e.items[j];switch(k.type){case i:var l=k;if(l.required&&!c.textContent)throw new F(G.CONTENT_MISSING,f);if(c.textContent){var m=l.converter?l.converter.set(c.textContent):c.textContent;this[j]=m}else this[j]=l.defaultValue;break;case h:var n=k,o=void 0,p=void 0;if(n.namespaceURI?(o=c.hasAttributeNS.bind(c,n.namespaceURI,n.localName),p=c.getAttributeNS.bind(c,n.namespaceURI,n.localName)):(o=c.hasAttribute.bind(c,n.localName),p=c.getAttribute.bind(c,n.localName)),n.required&&!o())throw new F(G.ATTRIBUTE_MISSING,n.localName,f);if(o()){var q=n.converter?n.converter.set(p()):p();this[j]=q}else this[j]=n.defaultValue;break;case g:var r=k;if(r.noRoot){if(!r.parser)throw new F(G.XML_EXCEPTION,"Schema for '"+r.localName+"' with flag noRoot must have 'parser'");var t=new r.parser;if(!(t instanceof N))throw new F(G.XML_EXCEPTION,"Schema for '"+r.localName+"' with flag noRoot must have 'parser' like instance of XmlCollection");if(t.OnLoadXml(c),delete t.element,t.Count<r.minOccurs||t.Count>r.maxOccurs)throw new F(G.COLLECTION_LIMIT,r.parser.localName,f);this[j]=t;continue}for(var u=null,v=0;v<c.childNodes.length;v++){var w=c.childNodes.item(v);if(w.nodeType===s.Element){var x=w;if(x.localName===r.localName&&x.namespaceURI==r.namespaceURI){u=x;break}}}if(r.required&&!u)throw new F(G.ELEMENT_MISSING,r.parser?r.parser.localName:r.localName,f);if(r.parser){if(u){var A=new r.parser;A.localName=r.localName,A.namespaceURI=r.namespaceURI,this[j]=A,A.LoadXml(u)}}else if(u){var z=r.converter?r.converter.set(u.textContent):u.textContent;this[j]=z}else this[j]=r.defaultValue}}this.OnLoadXml(c),this.prefix=c.prefix||"",this.element=c}},{key:"toString",value:function(){var b=this.GetXml();return b?(new XMLSerializer).serializeToString(b):""}},{key:"GetElement",value:function(c){var d=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.element)throw new F(G.NULL_PARAM,this.localName);return a.GetElement(this.element,c,d)}},{key:"GetAttribute",value:function(c,d){var e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!this.element)throw new F(G.NULL_PARAM,this.localName);return a.GetAttribute(this.element,c,d,e)}},{key:"CreateElement",value:function(b,c){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;b||(b=this.CreateDocument()),c=c||this.localName,d=d||this.NamespaceURI,e=e||this.prefix;var f=b.createElementNS(this.NamespaceURI,(e?e+":":"")+c);return b.importNode(f,!0),f}},{key:"CreateDocument",value:function(){return a.CreateDocument(this.localName,this.NamespaceURI,this.Prefix)}},{key:"GetChildren",value:function(c,d){if(!this.element)throw new F(G.NULL_PARAM,this.localName);return a.GetChildren(this.element,c,d||this.NamespaceURI||void 0)}},{key:"GetChild",value:function(c){var d=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.element)throw new F(G.NULL_PARAM,this.localName);return a.GetChild(this.element,c,this.NamespaceURI||void 0,d)}},{key:"GetFirstChild",value:function(c,d){if(!this.element)throw new F(G.NULL_PARAM,this.localName);return a.GetFirstChild(this.element,c,d)}},{key:"IsEmpty",value:function(){return void 0===this.Element}},{key:"Element",get:function(){return this.element}},{key:"Prefix",get:function(){return this.prefix},set:function(b){this.prefix=b}},{key:"LocalName",get:function(){return this.localName}},{key:"NamespaceURI",get:function(){return this.namespaceURI||null}}],[{key:"LoadXml",value:function(b){var c=new this;return c.LoadXml(b),c}},{key:"GetElement",value:function(b,c){var d=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],e=b.getElementsByTagName(c);if(d&&0===e.length)throw new F(G.ELEMENT_MISSING,c,b.localName);return e[0]||null}},{key:"GetAttribute",value:function(b,c,d){var e=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(b.hasAttribute(c))return b.getAttribute(c);if(e)throw new F(G.ATTRIBUTE_MISSING,c,b.localName);return d}},{key:"GetElementById",value:function(b,c){if(null==b||null==c)return null;var d=null;return b.nodeType===s.Document&&(d=b.getElementById(c)),null==d&&(d=z(b,"//*[@Id='"+c+"']"),null==d&&(d=z(b,"//*[@ID='"+c+"']"),null==d&&(d=z(b,"//*[@id='"+c+"']")))),d}},{key:"CreateDocument",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,e="",f="",g="";d&&(e=d+":",f=":"+d),c&&(g=" xmlns"+f+'="'+c+'"');var h=""+e+b,i=(new DOMParser).parseFromString("<"+h+g+"></"+h+">",r);return i}},{key:"GetChildren",value:function(b,c,d){b=b.documentElement||b;for(var e=[],f=0;f<b.childNodes.length;f++){var g=b.childNodes[f];g.nodeType!==s.Element||g.localName!==c||g.namespaceURI!==d&&d||e.push(g)}return e}},{key:"GetFirstChild",value:function(b,c,d){b=b.documentElement||b;for(var e=0;e<b.childNodes.length;e++){var f=b.childNodes[e];if(f.nodeType===s.Element&&f.localName===c&&(f.namespaceURI===d||!d))return f}return null}},{key:"GetChild",value:function(b,c,d){for(var e=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],f=0;f<b.childNodes.length;f++){var g=b.childNodes[f];if(g.nodeType===s.Element&&g.localName===c&&(g.namespaceURI===d||!d))return g}if(e)throw new F(G.ELEMENT_MISSING,c,b.localName);return null}}]),a}(),N=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return a.items=new Array,a}return _inherits(b,a),_createClass(b,[{key:"HasChanged",value:function(){var c=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"HasChanged",this).call(this),d=this.Some(function(a){return a.HasChanged()});return c||d}},{key:"OnGetXml",value:function(b){var c=!0,d=!1,e=void 0;try{for(var g,f=this.GetIterator()[Symbol.iterator]();!(c=(g=f.next()).done);c=!0){var h=g.value,i=h.GetXml();i&&b.appendChild(i)}}catch(a){d=!0,e=a}finally{try{!c&&f.return&&f.return()}finally{if(d)throw e}}}},{key:"OnLoadXml",value:function(b){var c=this.GetStatic();if(!c.parser)throw new F(G.XML_EXCEPTION,c.localName+" doesn't have required 'parser' in @XmlElement");for(var d=0;d<b.childNodes.length;d++){var e=b.childNodes.item(d);if(e.nodeType===s.Element&&e.localName===c.parser.localName&&e.namespaceURI==c.namespaceURI){var f=e,g=new c.parser;g.LoadXml(f),this.Add(g)}}}},{key:"Item",value:function(b){return this.items[b]||null}},{key:"Add",value:function(b){this.items.push(b),this.element=null}},{key:"Pop",value:function(){return this.element=null,this.items.pop()}},{key:"RemoveAt",value:function(b){this.items=this.items.filter(function(a,c){return c!==b}),this.element=null}},{key:"Clear",value:function(){this.items=new Array,this.element=null}},{key:"GetIterator",value:function(){return this.items}},{key:"ForEach",value:function(b){this.GetIterator().forEach(b)}},{key:"Map",value:function(b){return new q(this.GetIterator().map(b))}},{key:"Filter",value:function(b){return new q(this.GetIterator().filter(b))}},{key:"Sort",value:function(b){return new q(this.GetIterator().sort(b))}},{key:"Every",value:function(b){return this.GetIterator().every(b)}},{key:"Some",value:function(b){return this.GetIterator().some(b)}},{key:"IsEmpty",value:function(){return 0===this.Count}},{key:"Count",get:function(){return this.items.length}}]),b}(M),O=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),_createClass(b,[{key:"Add",value:function(c){c.prefix=c.prefix||"",c.namespace=c.namespace||"",_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"Add",this).call(this,c)}},{key:"GetPrefix",value:function(b){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.Count-1,d=this.Count-1;b=b||"",c>d&&(c=d);for(var e=c;e>=0;e--){var f=this.items[e];if(f.prefix===b)return f}return null}},{key:"GetNamespace",value:function(b){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.Count-1,d=this.Count-1;b=b||"",c>d&&(c=d);for(var e=c;e>=0;e--){var f=this.items[e];if(f.namespace===b)return f}return null}}]),b}(q),P={DefaultPrefix:"xades",NamespaceURI:"http://uri.etsi.org/01903/v1.3.2#",SignedPropertiesType:"http://uri.etsi.org/01903/v1.3.2#SignedProperties",ElementNames:{Any:"Any",ByName:"ByName",ByKey:"ByKey",AttrAuthoritiesCertValues:"AttrAuthoritiesCertValues",AttributeRevocationValues:"AttributeRevocationValues",AttributeCertificateRefs:"AttributeCertificateRefs",AttributeRevocationRefs:"AttributeRevocationRefs",QualifyingProperties:"QualifyingProperties",QualifyingPropertiesReference:"QualifyingPropertiesReference",SignedProperties:"SignedProperties",SignedSignatureProperties:"SignedSignatureProperties",SignedDataObjectProperties:"SignedDataObjectProperties",UnsignedProperties:"UnsignedProperties",UnsignedSignatureProperties:"UnsignedSignatureProperties",UnsignedDataObjectProperties:"UnsignedDataObjectProperties",UnsignedDataObjectProperty:"UnsignedDataObjectProperty",SigningTime:"SigningTime",SigningCertificate:"SigningCertificate",SignaturePolicyIdentifier:"SignaturePolicyIdentifier",SignatureProductionPlace:"SignatureProductionPlace",SignerRole:"SignerRole",Cert:"Cert",CertDigest:"CertDigest",IssuerSerial:"IssuerSerial",DataObjectFormat:"DataObjectFormat",CommitmentTypeIndication:"CommitmentTypeIndication",AllDataObjectsTimeStamp:"AllDataObjectsTimeStamp",IndividualDataObjectsTimeStamp:"IndividualDataObjectsTimeStamp",HashDataInfo:"HashDataInfo",EncapsulatedTimeStamp:"EncapsulatedTimeStamp",XMLTimeStamp:"XMLTimeStamp",XAdESTimeStamp:"XAdESTimeStamp",OtherTimeStamp:"OtherTimeStamp",Description:"Description",ObjectIdentifier:"ObjectIdentifier",MimeType:"MimeType",Encoding:"Encoding",Identifier:"Identifier",DocumentationReferences:"DocumentationReferences",DocumentationReference:"DocumentationReference",CommitmentTypeId:"CommitmentTypeId",ObjectReference:"ObjectReference",CommitmentTypeQualifiers:"CommitmentTypeQualifiers",AllSignedDataObjects:"AllSignedDataObjects",CommitmentTypeQualifier:"CommitmentTypeQualifier",SignaturePolicyId:"SignaturePolicyId",SignaturePolicyImplied:"SignaturePolicyImplied",SigPolicyId:"SigPolicyId",SigPolicyHash:"SigPolicyHash",SigPolicyQualifier:"SigPolicyQualifier",SigPolicyQualifiers:"SigPolicyQualifiers",SPURI:"SPURI",SPUserNotice:"SPUserNotice",NoticeRef:"NoticeRef",ExplicitText:"ExplicitText",ClaimedRoles:"ClaimedRoles",ClaimedRole:"ClaimedRole",CertifiedRoles:"CertifiedRoles",CertifiedRole:"CertifiedRole",Organization:"Organization",NoticeNumbers:"NoticeNumbers",Int:"int",City:"City",PostalCode:"PostalCode",StateOrProvince:"StateOrProvince",CountryName:"CountryName",CounterSignature:"CounterSignature",SignatureTimeStamp:"SignatureTimeStamp",CompleteCertificateRefs:"CompleteCertificateRefs",CompleteRevocationRefs:"CompleteRevocationRefs",SigAndRefsTimeStamp:"SigAndRefsTimeStamp",RefsOnlyTimeStamp:"RefsOnlyTimeStamp",CertificateValues:"CertificateValues",RevocationValues:"RevocationValues",ArchiveTimeStamp:"ArchiveTimeStamp",CertRefs:"CertRefs",CRLRefs:"CRLRefs",CRLRef:"CRLRef",OCSPRefs:"OCSPRefs",OtherRefs:"OtherRefs",OtherRef:"OtherRef",DigestAlgAndValue:"DigestAlgAndValue",CRLIdentifier:"CRLIdentifier",Issuer:"Issuer",IssueTime:"IssueTime",Number:"Number",OCSPRef:"OCSPRef",OCSPIdentifier:"OCSPIdentifier",ResponderID:"ResponderID",ProducedAt:"ProducedAt",EncapsulatedX509Certificate:"EncapsulatedX509Certificate",OtherCertificate:"OtherCertificate",CRLValues:"CRLValues",OCSPValues:"OCSPValues",OtherValues:"OtherValues",OtherValue:"OtherValue",EncapsulatedCRLValue:"EncapsulatedCRLValue",EncapsulatedOCSPValue:"EncapsulatedOCSPValue",ReferenceInfo:"ReferenceInfo",Include:"Include"},AttributeNames:{Id:"Id",Encoding:"Encoding",Target:"Target",ObjectReference:"ObjectReference",Qualifier:"Qualifier",Uri:"uri",URI:"URI",ReferencedData:"referencedData"}},Q=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(M);Q=d([l({localName:"xades",namespaceURI:P.NamespaceURI,prefix:P.DefaultPrefix})],Q);var R=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(N);R=d([l({localName:"xades_collection",namespaceURI:P.NamespaceURI,prefix:P.DefaultPrefix})],R);var S=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([o()],S.prototype,"Value",void 0),S=d([l({localName:P.ElementNames.Any})],S);var T={get:function(b){switch(b){case"der":case"ber":case"cer":case"per":case"xer":return"http://uri.etsi.org/01903/v1.2.2#"+b.toUpperCase()}},set:function(b){var c=/#(\w+)$/,d=c.exec(b);return d?d[1].toLowerCase():null}},U=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([n({localName:P.AttributeNames.Id,defaultValue:""})],U.prototype,"Id",void 0),d([n({localName:P.AttributeNames.Encoding,defaultValue:null,converter:T})],U.prototype,"Encoding",void 0),d([o({required:!0,converter:J})],U.prototype,"Value",void 0),U=d([l({localName:"EncapsulatedPKIData"})],U);var V=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(S);V=d([l({localName:P.ElementNames.OtherCertificate})],V);var W=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(R);W=d([l({localName:"OtherCertificateCollection",parser:V})],W);var X=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(U);X=d([l({localName:P.ElementNames.EncapsulatedX509Certificate})],X);var Y=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(R);Y=d([l({localName:"EncapsulatedX509CertificateCollection",parser:X})],Y);var Z=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([n({localName:P.AttributeNames.Id,defaultValue:""})],Z.prototype,"Id",void 0),d([m({parser:Y,noRoot:!0})],Z.prototype,"EncapsulatedX509Certificates",void 0),d([m({parser:W,noRoot:!0})],Z.prototype,"OtherCertificates",void 0),Z=d([l({localName:P.ElementNames.CertificateValues})],Z);var $=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([n({localName:P.AttributeNames.Qualifier})],$.prototype,"Qualifier",void 0),d([o({defaultValue:"",required:!0})],$.prototype,"Value",void 0),$=d([l({localName:P.ElementNames.Identifier})],$);var _=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b.prototype.OnLoadXml=function(a){a.textContent&&(this.Uri=a.textContent)},b.prototype.OnGetXml=function(a){this.Uri&&(a.textContent=this.Uri)},b}(Q);d([o({defaultValue:"",required:!0})],_.prototype,"Uri",void 0),_=d([l({localName:P.ElementNames.DocumentationReference})],_);var aa=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(R);aa=d([l({localName:P.ElementNames.DocumentationReferences,parser:_})],aa);var ba=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([m({parser:$,required:!0})],ba.prototype,"Identifier",void 0),d([m({localName:P.ElementNames.Description,namespaceURI:P.NamespaceURI,prefix:P.DefaultPrefix,defaultValue:""})],ba.prototype,"Description",void 0),d([m({parser:aa})],ba.prototype,"DocumentationReferences",void 0),ba=d([l({localName:P.ElementNames.ObjectIdentifier})],ba);var ca=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(S);ca=d([l({localName:P.ElementNames.CommitmentTypeQualifier})],ca);var da=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(R);da=d([l({localName:P.ElementNames.CommitmentTypeQualifiers,parser:ca})],da);var ea=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([o({required:!0})],ea.prototype,"Value",void 0),ea=d([l({localName:P.ElementNames.ObjectReference})],ea);var fa=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(R);fa=d([l({localName:"ObjectReferences",parser:ea})],fa);var ga={set:function(b){return!0},get:function(b){}},ha=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([m({localName:P.ElementNames.CommitmentTypeId,required:!0,namespaceURI:P.NamespaceURI,prefix:P.DefaultPrefix,parser:ba})],ha.prototype,"CommitmentTypeId",void 0),d([m({parser:fa,noRoot:!0})],ha.prototype,"ObjectReference",void 0),d([m({localName:P.ElementNames.AllSignedDataObjects,namespaceURI:P.NamespaceURI,prefix:P.DefaultPrefix,converter:ga,defaultValue:!1})],ha.prototype,"AllSignedDataObjects",void 0),d([m({localName:P.ElementNames.CommitmentTypeQualifiers,parser:ca})],ha.prototype,"CommitmentTypeQualifiers",void 0),ha=d([l({localName:P.ElementNames.CommitmentTypeIndication})],ha);var sa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ta="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",ya=Math.log(2),Aa=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.blockLength=ia(b,"blockLength",0),this.error=ia(b,"error",""),this.warnings=ia(b,"warnings",[]),"valueBeforeDecode"in b?this.valueBeforeDecode=b.valueBeforeDecode.slice(0):this.valueBeforeDecode=new ArrayBuffer(0)}return _createClass(a,[{key:"toJSON",value:function(){return{blockName:this.constructor.blockName(),blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:ja(this.valueBeforeDecode,0,this.valueBeforeDecode.byteLength)}}}],[{key:"blockName",value:function(){return"baseBlock"}}]),a}(),Ba=function(b){return function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.isHexOnly=ia(a,"isHexOnly",!1),"valueHex"in a?c.valueHex=a.valueHex.slice(0):c.valueHex=new ArrayBuffer(0),c}return _inherits(b,a),_createClass(b,[{key:"fromBER",value:function(b,c,d){if(ka(this,b,c,d)===!1)return-1;var e=new Uint8Array(b,c,d);return 0===e.length?(this.warnings.push("Zero buffer length"),c):(this.valueHex=b.slice(c,c+d),this.blockLength=d,c+d)}},{key:"toBER",value:function(){var b=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.isHexOnly!==!0?(this.error='Flag "isHexOnly" is not set, abort',new ArrayBuffer(0)):b===!0?new ArrayBuffer(this.valueHex.byteLength):this.valueHex.slice(0)}},{key:"toJSON",value:function(){var c={};try{c=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"toJSON",this).call(this)}catch(a){}return c.blockName=this.constructor.blockName(),c.isHexOnly=this.isHexOnly,c.valueHex=ja(this.valueHex,0,this.valueHex.byteLength),c}}],[{key:"blockName",value:function(){return"hexBlock"}}]),b}(b)},Ca=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return"idBlock"in a?(c.isHexOnly=ia(a.idBlock,"isHexOnly",!1),c.valueHex=ia(a.idBlock,"valueHex",new ArrayBuffer(0)),c.tagClass=ia(a.idBlock,"tagClass",-1),c.tagNumber=ia(a.idBlock,"tagNumber",-1),c.isConstructed=ia(a.idBlock,"isConstructed",!1)):(c.tagClass=-1,
c.tagNumber=-1,c.isConstructed=!1),c}return _inherits(b,a),_createClass(b,[{key:"toBER",value:function(){var b=arguments.length>0&&void 0!==arguments[0]&&arguments[0],c=0,d=void 0,e=void 0;switch(this.tagClass){case 1:c|=0;break;case 2:c|=64;break;case 3:c|=128;break;case 4:c|=192;break;default:return this.error="Unknown tag class",new ArrayBuffer(0)}if(this.isConstructed&&(c|=32),this.tagNumber<31&&!this.isHexOnly){if(d=new ArrayBuffer(1),e=new Uint8Array(d),!b){var f=this.tagNumber;f&=31,c|=f,e[0]=c}return d}if(this.isHexOnly===!1){var g=ma(this.tagNumber,7),h=new Uint8Array(g),i=g.byteLength;if(d=new ArrayBuffer(i+1),e=new Uint8Array(d),e[0]=31|c,!b){for(var j=0;j<i-1;j++)e[j+1]=128|h[j];e[i]=h[i-1]}return d}if(d=new ArrayBuffer(this.valueHex.byteLength+1),e=new Uint8Array(d),e[0]=31|c,b===!1){for(var k=new Uint8Array(this.valueHex),l=0;l<k.length-1;l++)e[l+1]=128|k[l];e[this.valueHex.byteLength]=k[k.length-1]}return d}},{key:"fromBER",value:function(b,c,d){if(ka(this,b,c,d)===!1)return-1;var e=new Uint8Array(b,c,d);if(0===e.length)return this.error="Zero buffer length",-1;var f=192&e[0];switch(f){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=32===(32&e[0]),this.isHexOnly=!1;var g=31&e[0];if(31!==g)this.tagNumber=g,this.blockLength=1;else{var h=1;this.valueHex=new ArrayBuffer(255);for(var i=255,j=new Uint8Array(this.valueHex);128&e[h];){if(j[h-1]=127&e[h],h++,h>=e.length)return this.error="End of input reached before message was fully decoded",-1;if(h===i){i+=255;for(var k=new ArrayBuffer(i),l=new Uint8Array(k),m=0;m<j.length;m++)l[m]=j[m];this.valueHex=new ArrayBuffer(i),j=new Uint8Array(this.valueHex)}}this.blockLength=h+1,j[h-1]=127&e[h];for(var n=new ArrayBuffer(h),o=new Uint8Array(n),p=0;p<h;p++)o[p]=j[p];this.valueHex=new ArrayBuffer(h),j=new Uint8Array(this.valueHex),j.set(o),this.blockLength<=9?this.tagNumber=la(j,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return c+this.blockLength}},{key:"toJSON",value:function(){var c={};try{c=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"toJSON",this).call(this)}catch(a){}return c.blockName=this.constructor.blockName(),c.tagClass=this.tagClass,c.tagNumber=this.tagNumber,c.isConstructed=this.isConstructed,c}}],[{key:"blockName",value:function(){return"identificationBlock"}}]),b}(Ba(Aa)),Da=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return"lenBlock"in a?(c.isIndefiniteForm=ia(a.lenBlock,"isIndefiniteForm",!1),c.longFormUsed=ia(a.lenBlock,"longFormUsed",!1),c.length=ia(a.lenBlock,"length",0)):(c.isIndefiniteForm=!1,c.longFormUsed=!1,c.length=0),c}return _inherits(b,a),_createClass(b,[{key:"fromBER",value:function(b,c,d){if(ka(this,b,c,d)===!1)return-1;var e=new Uint8Array(b,c,d);if(0===e.length)return this.error="Zero buffer length",-1;if(255===e[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===e[0],this.isIndefiniteForm===!0)return this.blockLength=1,c+this.blockLength;if(this.longFormUsed=!!(128&e[0]),this.longFormUsed===!1)return this.length=e[0],this.blockLength=1,c+this.blockLength;var f=127&e[0];if(f>8)return this.error="Too big integer",-1;if(f+1>e.length)return this.error="End of input reached before message was fully decoded",-1;for(var g=new Uint8Array(f),h=0;h<f;h++)g[h]=e[h+1];return 0===g[f-1]&&this.warnings.push("Needlessly long encoded length"),this.length=la(g,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unneccesary usage of long length form"),this.blockLength=f+1,c+this.blockLength}},{key:"toBER",value:function(){var b=arguments.length>0&&void 0!==arguments[0]&&arguments[0],c=void 0,d=void 0;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return c=new ArrayBuffer(1),b===!1&&(d=new Uint8Array(c),d[0]=128),c;if(this.longFormUsed===!0){var e=ma(this.length,8);if(e.byteLength>127)return this.error="Too big length",new ArrayBuffer(0);if(c=new ArrayBuffer(e.byteLength+1),b===!0)return c;var f=new Uint8Array(e);d=new Uint8Array(c),d[0]=128|e.byteLength;for(var g=0;g<e.byteLength;g++)d[g+1]=f[g];return c}return c=new ArrayBuffer(1),b===!1&&(d=new Uint8Array(c),d[0]=this.length),c}},{key:"toJSON",value:function(){var c={};try{c=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"toJSON",this).call(this)}catch(a){}return c.blockName=this.constructor.blockName(),c.isIndefiniteForm=this.isIndefiniteForm,c.longFormUsed=this.longFormUsed,c.length=this.length,c}}],[{key:"blockName",value:function(){return"lengthBlock"}}]),b}(Aa),Ea=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a))}return _inherits(b,a),_createClass(b,[{key:"fromBER",value:function(b,c,d){throw TypeError('User need to make a specific function in a class which extends "LocalValueBlock"')}},{key:"toBER",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];throw TypeError('User need to make a specific function in a class which extends "LocalValueBlock"')}}],[{key:"blockName",value:function(){return"valueBlock"}}]),b}(Aa),Fa=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ea;_classCallCheck(this,b);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return"name"in a&&(d.name=a.name),"optional"in a&&(d.optional=a.optional),"primitiveSchema"in a&&(d.primitiveSchema=a.primitiveSchema),d.idBlock=new Ca(a),d.lenBlock=new Da(a),d.valueBlock=new c(a),d}return _inherits(b,a),_createClass(b,[{key:"fromBER",value:function(b,c,d){var e=this.valueBlock.fromBER(b,c,this.lenBlock.isIndefiniteForm===!0?d:this.lenBlock.length);return e===-1?(this.error=this.valueBlock.error,e):(0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),e)}},{key:"toBER",value:function(){var b=arguments.length>0&&void 0!==arguments[0]&&arguments[0],c=void 0,d=this.idBlock.toBER(b),e=this.valueBlock.toBER(!0);this.lenBlock.length=e.byteLength;var f=this.lenBlock.toBER(b);c=na(d,f);var g=void 0;if(g=b===!1?this.valueBlock.toBER(b):new ArrayBuffer(this.lenBlock.length),c=na(c,g),this.lenBlock.isIndefiniteForm===!0){var h=new ArrayBuffer(2);if(b===!1){var i=new Uint8Array(h);i[0]=0,i[1]=0}c=na(c,h)}return c}},{key:"toJSON",value:function(){var c={};try{c=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"toJSON",this).call(this)}catch(a){}return c.idBlock=this.idBlock.toJSON(),c.lenBlock=this.lenBlock.toJSON(),c.valueBlock=this.valueBlock.toJSON(),"name"in this&&(c.name=this.name),"optional"in this&&(c.optional=this.optional),"primitiveSchema"in this&&(c.primitiveSchema=this.primitiveSchema.toJSON()),c}}],[{key:"blockName",value:function(){return"BaseBlock"}}]),b}(Aa),Ga=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return"valueHex"in a?c.valueHex=a.valueHex.slice(0):c.valueHex=new ArrayBuffer(0),c.isHexOnly=ia(a,"isHexOnly",!0),c}return _inherits(b,a),_createClass(b,[{key:"fromBER",value:function(b,c,d){if(ka(this,b,c,d)===!1)return-1;var e=new Uint8Array(b,c,d);if(0===e.length)return this.warnings.push("Zero buffer length"),c;this.valueHex=new ArrayBuffer(e.length);for(var f=new Uint8Array(this.valueHex),g=0;g<e.length;g++)f[g]=e[g];return this.blockLength=d,c+d}},{key:"toBER",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.valueHex.slice(0)}},{key:"toJSON",value:function(){var c={};try{c=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"toJSON",this).call(this)}catch(a){}return c.valueHex=ja(this.valueHex,0,this.valueHex.byteLength),c.isHexOnly=this.isHexOnly,c}}],[{key:"blockName",value:function(){return"PrimitiveValueBlock"}}]),b}(Ea),Ha=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,Ga));return c.idBlock.isConstructed=!1,c}return _inherits(b,a),_createClass(b,null,[{key:"blockName",value:function(){return"PRIMITIVE"}}]),b}(Fa),Ia=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.value=ia(a,"value",[]),c.isIndefiniteForm=ia(a,"isIndefiniteForm",!1),c}return _inherits(b,a),_createClass(b,[{key:"fromBER",value:function(b,c,d){function h(a,b){return a===!0?1:b}var e=c,f=d;if(ka(this,b,c,d)===!1)return-1;var g=new Uint8Array(b,c,d);if(0===g.length)return this.warnings.push("Zero buffer length"),c;for(var i=c;h(this.isIndefiniteForm,d)>0;){var j=Bb(b,i,d);if(j.offset===-1)return this.error=j.result.error,this.warnings.concat(j.result.warnings),-1;if(i=j.offset,this.blockLength+=j.result.blockLength,d-=j.result.blockLength,this.value.push(j.result),this.isIndefiniteForm===!0&&j.result.constructor.blockName()===La.blockName())break}return this.isIndefiniteForm===!0&&(this.value[this.value.length-1].constructor.blockName()===La.blockName()?this.value.pop():this.warnings.push("No EndOfContent block encoded")),this.valueBeforeDecode=b.slice(e,e+f),i}},{key:"toBER",value:function(){for(var b=arguments.length>0&&void 0!==arguments[0]&&arguments[0],c=new ArrayBuffer(0),d=0;d<this.value.length;d++){var e=this.value[d].toBER(b);c=na(c,e)}return c}},{key:"toJSON",value:function(){var c={};try{c=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"toJSON",this).call(this)}catch(a){}c.isIndefiniteForm=this.isIndefiniteForm,c.value=[];for(var d=0;d<this.value.length;d++)c.value.push(this.value[d].toJSON());return c}}],[{key:"blockName",value:function(){return"ConstructedValueBlock"}}]),b}(Ea),Ja=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,Ia));return c.idBlock.isConstructed=!0,c}return _inherits(b,a),_createClass(b,[{key:"fromBER",value:function(b,c,d){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;var e=this.valueBlock.fromBER(b,c,this.lenBlock.isIndefiniteForm===!0?d:this.lenBlock.length);return e===-1?(this.error=this.valueBlock.error,e):(0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),e)}}],[{key:"blockName",value:function(){return"CONSTRUCTED"}}]),b}(Fa),Ka=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a))}return _inherits(b,a),_createClass(b,[{key:"fromBER",value:function(b,c,d){return c}},{key:"toBER",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new ArrayBuffer(0)}}],[{key:"blockName",value:function(){return"EndOfContentValueBlock"}}]),b}(Ea),La=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,Ka));return c.idBlock.tagClass=1,c.idBlock.tagNumber=0,c}return _inherits(b,a),_createClass(b,null,[{key:"blockName",value:function(){return"EndOfContent"}}]),b}(Fa),Ma=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));if(c.value=ia(a,"value",!1),c.isHexOnly=ia(a,"isHexOnly",!1),"valueHex"in a)c.valueHex=a.valueHex.slice(0);else if(c.valueHex=new ArrayBuffer(1),c.value===!0){var d=new Uint8Array(c.valueHex);d[0]=255}return c}return _inherits(b,a),_createClass(b,[{key:"fromBER",value:function(b,c,d){if(ka(this,b,c,d)===!1)return-1;var e=new Uint8Array(b,c,d);d>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.value=0!==e[0],this.isHexOnly=!0,this.valueHex=new ArrayBuffer(e.length);for(var f=new Uint8Array(this.valueHex),g=0;g<e.length;g++)f[g]=e[g];return this.blockLength=d,c+d}},{key:"toBER",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.valueHex}},{key:"toJSON",value:function(){var c={};try{c=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"toJSON",this).call(this)}catch(a){}return c.value=this.value,c.isHexOnly=this.isHexOnly,c.valueHex=ja(this.valueHex,0,this.valueHex.byteLength),c}}],[{key:"blockName",value:function(){return"BooleanValueBlock"}}]),b}(Ea),Na=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,Ma));return c.idBlock.tagClass=1,c.idBlock.tagNumber=1,c}return _inherits(b,a),_createClass(b,null,[{key:"blockName",value:function(){return"Boolean"}}]),b}(Fa),Oa=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.idBlock.tagClass=1,c.idBlock.tagNumber=16,c}return _inherits(b,a),_createClass(b,null,[{key:"blockName",value:function(){return"Sequence"}}]),b}(Ja),Pa=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.idBlock.tagClass=1,c.idBlock.tagNumber=17,c}return _inherits(b,a),_createClass(b,null,[{key:"blockName",value:function(){return"Set"}}]),b}(Ja),Qa=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,Aa));return c.idBlock.tagClass=1,c.idBlock.tagNumber=5,c}return _inherits(b,a),_createClass(b,[{key:"fromBER",value:function(b,c,d){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=d,c+d}},{key:"toBER",value:function(){var b=arguments.length>0&&void 0!==arguments[0]&&arguments[0],c=new ArrayBuffer(2);if(b===!0)return c;var d=new Uint8Array(c);return d[0]=5,d[1]=0,c}}],[{key:"blockName",value:function(){return"Null"}}]),b}(Fa),Ra=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.isConstructed=ia(a,"isConstructed",!1),c}return _inherits(b,a),_createClass(b,[{key:"fromBER",value:function(c,d,e){var f=0;if(this.isConstructed===!0){if(this.isHexOnly=!1,f=Ia.prototype.fromBER.call(this,c,d,e),f===-1)return f;for(var g=0;g<this.value.length;g++){var h=this.value[g].constructor.blockName();if(h===La.blockName()){if(this.isIndefiniteForm===!0)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(h!==Sa.blockName())return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,f=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"fromBER",this).call(this,c,d,e),this.blockLength=e;return f}},{key:"toBER",value:function(){var b=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isConstructed===!0)return Ia.prototype.toBER.call(this,b);var c=new ArrayBuffer(this.valueHex.byteLength);return b===!0?c:0===this.valueHex.byteLength?c:c=this.valueHex.slice(0)}},{key:"toJSON",value:function(){var c={};try{c=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"toJSON",this).call(this)}catch(a){}return c.isConstructed=this.isConstructed,c.isHexOnly=this.isHexOnly,c.valueHex=ja(this.valueHex,0,this.valueHex.byteLength),c}}],[{key:"blockName",value:function(){return"OctetStringValueBlock"}}]),b}(Ba(Ia)),Sa=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,Ra));return c.idBlock.tagClass=1,c.idBlock.tagNumber=4,c}return _inherits(b,a),_createClass(b,[{key:"fromBER",value:function(c,d,e){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===e?(0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),d):_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"fromBER",this).call(this,c,d,e)}},{key:"isEqual",value:function(c){return c instanceof b!=!1&&JSON.stringify(this)===JSON.stringify(c)}}],[{key:"blockName",value:function(){return"OctetString"}}]),b}(Fa),Ta=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.unusedBits=ia(a,"unusedBits",0),c.isConstructed=ia(a,"isConstructed",!1),c.blockLength=c.valueHex.byteLength+1,c}return _inherits(b,a),_createClass(b,[{key:"fromBER",value:function(b,c,d){if(0===d)return c;var e=-1;if(this.isConstructed===!0){if(e=Ia.prototype.fromBER.call(this,b,c,d),e===-1)return e;for(var f=0;f<this.value.length;f++){var g=this.value[f].constructor.blockName();if(g===La.blockName()){if(this.isIndefiniteForm===!0)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(g!==Ua.blockName())return this.error="BIT STRING may consists of BIT STRINGs only",-1;if(this.unusedBits>0&&this.value[f].unusedBits>0)return this.error='Usign of "unused bits" inside constructive BIT STRING allowed for least one only',-1;if(this.unusedBits=this.value[f].unusedBits,this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1}return e}if(ka(this,b,c,d)===!1)return-1;var h=new Uint8Array(b,c,d);if(this.unusedBits=h[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;this.valueHex=new ArrayBuffer(h.length-1);for(var i=new Uint8Array(this.valueHex),j=0;j<d-1;j++)i[j]=h[j+1];return this.blockLength=h.length,c+d}},{key:"toBER",value:function(){var b=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isConstructed===!0)return Ia.prototype.toBER.call(this,b);if(b===!0)return new ArrayBuffer(this.valueHex.byteLength+1);if(0===this.valueHex.byteLength)return new ArrayBuffer(0);var c=new Uint8Array(this.valueHex),d=new ArrayBuffer(this.valueHex.byteLength+1),e=new Uint8Array(d);e[0]=this.unusedBits;for(var f=0;f<this.valueHex.byteLength;f++)e[f+1]=c[f];return d}},{key:"toJSON",value:function(){var c={};try{c=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"toJSON",this).call(this)}catch(a){}return c.unusedBits=this.unusedBits,c.isConstructed=this.isConstructed,c.isHexOnly=this.isHexOnly,c.valueHex=ja(this.valueHex,0,this.valueHex.byteLength),c}}],[{key:"blockName",value:function(){return"BitStringValueBlock"}}]),b}(Ba(Ia)),Ua=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,Ta));return c.idBlock.tagClass=1,c.idBlock.tagNumber=3,c}return _inherits(b,a),_createClass(b,[{key:"fromBER",value:function(c,d,e){return 0===e?d:(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"fromBER",this).call(this,c,d,e))}},{key:"isEqual",value:function(c){return c instanceof b!=!1&&JSON.stringify(this)===JSON.stringify(c)}}],[{key:"blockName",value:function(){return"BitString"}}]),b}(Fa),Va=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return"value"in a&&(c.valueDec=a.value),c}return _inherits(b,a),_createClass(b,[{key:"fromDER",value:function(b,c,d){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,f=this.fromBER(b,c,d);if(f===-1)return f;var g=new Uint8Array(this._valueHex);if(0===g[0]&&0!==(128&g[1])){var h=new ArrayBuffer(this._valueHex.byteLength-1),i=new Uint8Array(h);i.set(new Uint8Array(this._valueHex,1,this._valueHex.byteLength-1)),this._valueHex=h.slice(0)}else if(0!==e&&this._valueHex.byteLength<e){e-this._valueHex.byteLength>1&&(e=this._valueHex.byteLength+1);var j=new ArrayBuffer(e),k=new Uint8Array(j);k.set(g,e-this._valueHex.byteLength),this._valueHex=j.slice(0)}return f}},{key:"toDER",value:function(){var b=arguments.length>0&&void 0!==arguments[0]&&arguments[0],c=new Uint8Array(this._valueHex);switch(!0){case 0!==(128&c[0]):var d=new ArrayBuffer(this._valueHex.byteLength+1),e=new Uint8Array(d);e[0]=0,e.set(c,1),this._valueHex=d.slice(0);break;case 0===c[0]&&0===(128&c[1]):var f=new ArrayBuffer(this._valueHex.byteLength-1),g=new Uint8Array(f);g.set(new Uint8Array(this._valueHex,1,this._valueHex.byteLength-1)),this._valueHex=f.slice(0)}return this.toBER(b)}},{key:"fromBER",value:function(c,d,e){var f=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"fromBER",this).call(this,c,d,e);return f===-1?f:(this.blockLength=e,d+e)}},{key:"toBER",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.valueHex.slice(0)}},{key:"toJSON",value:function(){var c={};try{c=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"toJSON",this).call(this)}catch(a){}return c.valueDec=this.valueDec,c}},{key:"valueHex",set:function(b){this._valueHex=b.slice(0),b.byteLength>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,b.byteLength>0&&(this._valueDec=oa.call(this)))},get:function(){return this._valueHex}},{key:"valueDec",set:function(b){this._valueDec=b,this.isHexOnly=!1,this._valueHex=pa(b)},get:function(){return this._valueDec}}],[{key:"blockName",value:function(){return"IntegerValueBlock"}}]),b}(Ba(Ea)),Wa=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,Va));return c.idBlock.tagClass=1,c.idBlock.tagNumber=2,c}return _inherits(b,a),_createClass(b,[{key:"isEqual",value:function(c){return c instanceof b?this.valueBlock.isHexOnly&&c.valueBlock.isHexOnly?qa(this.valueBlock.valueHex,c.valueBlock.valueHex):this.valueBlock.isHexOnly===c.valueBlock.isHexOnly&&this.valueBlock.valueDec===c.valueBlock.valueDec:c instanceof ArrayBuffer&&qa(this.valueBlock.valueHex,c)}},{key:"convertToDER",value:function(){var c=new b({valueHex:this.valueBlock.valueHex});return c.valueBlock.toDER(),c}},{key:"convertFromDER",value:function(){var c=Math.pow(2,za(this.valueBlock.valueHex.byteLength)),d=new b({valueHex:this.valueBlock.valueHex});return d.valueBlock.fromDER(d.valueBlock.valueHex,0,d.valueBlock.valueHex.byteLength,c),d}}],[{key:"blockName",value:function(){return"Integer"}}]),b}(Fa),Xa=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.idBlock.tagClass=1,c.idBlock.tagNumber=10,c}return _inherits(b,a),_createClass(b,null,[{key:"blockName",value:function(){return"Enumerated"}}]),b}(Wa),Ya=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.valueDec=ia(a,"valueDec",-1),c.isFirstSid=ia(a,"isFirstSid",!1),c}return _inherits(b,a),_createClass(b,[{key:"fromBER",value:function(b,c,d){if(0===d)return c;if(ka(this,b,c,d)===!1)return-1;var e=new Uint8Array(b,c,d);this.valueHex=new ArrayBuffer(d);for(var f=new Uint8Array(this.valueHex),g=0;g<d&&(f[g]=127&e[g],this.blockLength++,0!==(128&e[g]));g++);for(var h=new ArrayBuffer(this.blockLength),i=new Uint8Array(h),j=0;j<this.blockLength;j++)i[j]=f[j];return this.valueHex=h.slice(0),f=new Uint8Array(this.valueHex),0!==(128&e[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===f[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=la(f,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),c+this.blockLength)}},{key:"toBER",value:function(){var b=arguments.length>0&&void 0!==arguments[0]&&arguments[0],c=void 0,d=void 0;if(this.isHexOnly){if(b===!0)return new ArrayBuffer(this.valueHex.byteLength);var e=new Uint8Array(this.valueHex);c=new ArrayBuffer(this.blockLength),d=new Uint8Array(c);for(var f=0;f<this.blockLength-1;f++)d[f]=128|e[f];return d[this.blockLength-1]=e[this.blockLength-1],c}var g=ma(this.valueDec,7);if(0===g.byteLength)return this.error="Error during encoding SID value",new ArrayBuffer(0);if(c=new ArrayBuffer(g.byteLength),b===!1){var h=new Uint8Array(g);d=new Uint8Array(c);for(var i=0;i<g.byteLength-1;i++)d[i]=128|h[i];d[g.byteLength-1]=h[g.byteLength-1]}return c}},{key:"toString",value:function(){var b="";if(this.isHexOnly===!0)b=ja(this.valueHex,0,this.valueHex.byteLength);else if(this.isFirstSid){var c=this.valueDec;this.valueDec<=39?b="0.":this.valueDec<=79?(b="1.",c-=40):(b="2.",c-=80),b+=c.toString()}else b=this.valueDec.toString();return b}},{key:"toJSON",value:function(){var c={};try{c=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"toJSON",this).call(this)}catch(a){}return c.valueDec=this.valueDec,c.isFirstSid=this.isFirstSid,c}}],[{key:"blockName",value:function(){return"sidBlock"}}]),b}(Ba(Aa)),Za=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.fromString(ia(a,"value","")),c}return _inherits(b,a),_createClass(b,[{key:"fromBER",value:function(b,c,d){for(var e=c;d>0;){var f=new Ya;if(e=f.fromBER(b,e,d),e===-1)return this.blockLength=0,this.error=f.error,e;0===this.value.length&&(f.isFirstSid=!0),this.blockLength+=f.blockLength,d-=f.blockLength,this.value.push(f)}return e}},{key:"toBER",value:function(){for(var b=arguments.length>0&&void 0!==arguments[0]&&arguments[0],c=new ArrayBuffer(0),d=0;d<this.value.length;d++){var e=this.value[d].toBER(b);if(0===e.byteLength)return this.error=this.value[d].error,new ArrayBuffer(0);c=na(c,e)}return c}},{key:"fromString",value:function(b){this.value=[];var c=0,d=0,e="",f=!1;do if(d=b.indexOf(".",c),e=d===-1?b.substr(c):b.substr(c,d-c),c=d+1,f){var g=this.value[0],h=0;switch(g.valueDec){case 0:break;case 1:h=40;break;case 2:h=80;break;default:return this.value=[],!1}var i=parseInt(e,10);if(isNaN(i))return!0;g.valueDec=i+h,f=!1}else{var j=new Ya;if(j.valueDec=parseInt(e,10),isNaN(j.valueDec))return!0;0===this.value.length&&(j.isFirstSid=!0,f=!0),this.value.push(j)}while(d!==-1);return!0}},{key:"toString",value:function(){for(var b="",c=!1,d=0;d<this.value.length;d++){c=this.value[d].isHexOnly;var e=this.value[d].toString();0!==d&&(b+="."),c?(e="{"+e+"}",this.value[d].isFirstSid?b="2.{"+e+" - 80}":b+=e):b+=e}return b}},{key:"toJSON",value:function(){var c={};try{c=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"toJSON",this).call(this)}catch(a){}c.value=this.toString(),c.sidArray=[];for(var d=0;d<this.value.length;d++)c.sidArray.push(this.value[d].toJSON());return c}}],[{key:"blockName",value:function(){return"ObjectIdentifierValueBlock"}}]),b}(Ea),$a=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,Za));return c.idBlock.tagClass=1,c.idBlock.tagNumber=6,c}return _inherits(b,a),_createClass(b,null,[{key:"blockName",value:function(){return"ObjectIdentifier"}}]),b}(Fa),_a=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.isHexOnly=!0,c.value="",c}return _inherits(b,a),_createClass(b,[{key:"toJSON",value:function(){var c={};try{c=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"toJSON",this).call(this)}catch(a){}return c.value=this.value,c}}],[{key:"blockName",value:function(){return"Utf8StringValueBlock"}}]),b}(Ba(Aa)),ab=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,_a));return"value"in a&&c.fromString(a.value),c.idBlock.tagClass=1,c.idBlock.tagNumber=12,c}return _inherits(b,a),_createClass(b,[{key:"fromBER",value:function(b,c,d){var e=this.valueBlock.fromBER(b,c,this.lenBlock.isIndefiniteForm===!0?d:this.lenBlock.length);return e===-1?(this.error=this.valueBlock.error,e):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),e)}},{key:"fromBuffer",value:function(b){this.valueBlock.value=String.fromCharCode.apply(null,new Uint8Array(b));try{this.valueBlock.value=decodeURIComponent(escape(this.valueBlock.value))}catch(a){this.warnings.push('Error during "decodeURIComponent": '+a+", using raw string")}}},{key:"fromString",value:function(b){var c=unescape(encodeURIComponent(b)),d=c.length;this.valueBlock.valueHex=new ArrayBuffer(d);for(var e=new Uint8Array(this.valueBlock.valueHex),f=0;f<d;f++)e[f]=c.charCodeAt(f);this.valueBlock.value=b}}],[{key:"blockName",value:function(){return"Utf8String"}}]),b}(Fa),bb=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.isHexOnly=!0,c.value="",c}return _inherits(b,a),_createClass(b,[{key:"toJSON",value:function(){var c={};try{c=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"toJSON",this).call(this)}catch(a){}return c.value=this.value,c}}],[{key:"blockName",value:function(){return"BmpStringValueBlock"}}]),b}(Ba(Aa)),cb=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,bb));
return"value"in a&&c.fromString(a.value),c.idBlock.tagClass=1,c.idBlock.tagNumber=30,c}return _inherits(b,a),_createClass(b,[{key:"fromBER",value:function(b,c,d){var e=this.valueBlock.fromBER(b,c,this.lenBlock.isIndefiniteForm===!0?d:this.lenBlock.length);return e===-1?(this.error=this.valueBlock.error,e):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),e)}},{key:"fromBuffer",value:function(b){for(var c=b.slice(0),d=new Uint8Array(c),e=0;e<d.length;e+=2){var f=d[e];d[e]=d[e+1],d[e+1]=f}this.valueBlock.value=String.fromCharCode.apply(null,new Uint16Array(c))}},{key:"fromString",value:function(b){var c=b.length;this.valueBlock.valueHex=new ArrayBuffer(2*c);for(var d=new Uint8Array(this.valueBlock.valueHex),e=0;e<c;e++){var f=ma(b.charCodeAt(e),8),g=new Uint8Array(f);if(!(g.length>2))for(var h=2-g.length,i=g.length-1;i>=0;i--)d[2*e+i+h]=g[i]}this.valueBlock.value=b}}],[{key:"blockName",value:function(){return"BmpString"}}]),b}(Fa),db=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.isHexOnly=!0,c.value="",c}return _inherits(b,a),_createClass(b,[{key:"toJSON",value:function(){var c={};try{c=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"toJSON",this).call(this)}catch(a){}return c.value=this.value,c}}],[{key:"blockName",value:function(){return"UniversalStringValueBlock"}}]),b}(Ba(Aa)),eb=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,db));return"value"in a&&c.fromString(a.value),c.idBlock.tagClass=1,c.idBlock.tagNumber=28,c}return _inherits(b,a),_createClass(b,[{key:"fromBER",value:function(b,c,d){var e=this.valueBlock.fromBER(b,c,this.lenBlock.isIndefiniteForm===!0?d:this.lenBlock.length);return e===-1?(this.error=this.valueBlock.error,e):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),e)}},{key:"fromBuffer",value:function(b){for(var c=b.slice(0),d=new Uint8Array(c),e=0;e<d.length;e+=4)d[e]=d[e+3],d[e+1]=d[e+2],d[e+2]=0,d[e+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(c))}},{key:"fromString",value:function(b){var c=b.length;this.valueBlock.valueHex=new ArrayBuffer(4*c);for(var d=new Uint8Array(this.valueBlock.valueHex),e=0;e<c;e++){var f=ma(b.charCodeAt(e),8),g=new Uint8Array(f);if(!(g.length>4))for(var h=4-g.length,i=g.length-1;i>=0;i--)d[4*e+i+h]=g[i]}this.valueBlock.value=b}}],[{key:"blockName",value:function(){return"UniversalString"}}]),b}(Fa),fb=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.value="",c.isHexOnly=!0,c}return _inherits(b,a),_createClass(b,[{key:"toJSON",value:function(){var c={};try{c=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"toJSON",this).call(this)}catch(a){}return c.value=this.value,c}}],[{key:"blockName",value:function(){return"SimpleStringValueBlock"}}]),b}(Ba(Aa)),gb=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,fb));return"value"in a&&c.fromString(a.value),c}return _inherits(b,a),_createClass(b,[{key:"fromBER",value:function(b,c,d){var e=this.valueBlock.fromBER(b,c,this.lenBlock.isIndefiniteForm===!0?d:this.lenBlock.length);return e===-1?(this.error=this.valueBlock.error,e):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),e)}},{key:"fromBuffer",value:function(b){this.valueBlock.value=String.fromCharCode.apply(null,new Uint8Array(b))}},{key:"fromString",value:function(b){var c=b.length;this.valueBlock.valueHex=new ArrayBuffer(c);for(var d=new Uint8Array(this.valueBlock.valueHex),e=0;e<c;e++)d[e]=b.charCodeAt(e);this.valueBlock.value=b}}],[{key:"blockName",value:function(){return"SIMPLESTRING"}}]),b}(Fa),hb=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.idBlock.tagClass=1,c.idBlock.tagNumber=18,c}return _inherits(b,a),_createClass(b,null,[{key:"blockName",value:function(){return"NumericString"}}]),b}(gb),ib=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.idBlock.tagClass=1,c.idBlock.tagNumber=19,c}return _inherits(b,a),_createClass(b,null,[{key:"blockName",value:function(){return"PrintableString"}}]),b}(gb),jb=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.idBlock.tagClass=1,c.idBlock.tagNumber=20,c}return _inherits(b,a),_createClass(b,null,[{key:"blockName",value:function(){return"TeletexString"}}]),b}(gb),kb=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.idBlock.tagClass=1,c.idBlock.tagNumber=21,c}return _inherits(b,a),_createClass(b,null,[{key:"blockName",value:function(){return"VideotexString"}}]),b}(gb),lb=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.idBlock.tagClass=1,c.idBlock.tagNumber=22,c}return _inherits(b,a),_createClass(b,null,[{key:"blockName",value:function(){return"IA5String"}}]),b}(gb),mb=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.idBlock.tagClass=1,c.idBlock.tagNumber=25,c}return _inherits(b,a),_createClass(b,null,[{key:"blockName",value:function(){return"GraphicString"}}]),b}(gb),nb=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.idBlock.tagClass=1,c.idBlock.tagNumber=26,c}return _inherits(b,a),_createClass(b,null,[{key:"blockName",value:function(){return"VisibleString"}}]),b}(gb),ob=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.idBlock.tagClass=1,c.idBlock.tagNumber=27,c}return _inherits(b,a),_createClass(b,null,[{key:"blockName",value:function(){return"GeneralString"}}]),b}(gb),pb=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.idBlock.tagClass=1,c.idBlock.tagNumber=29,c}return _inherits(b,a),_createClass(b,null,[{key:"blockName",value:function(){return"CharacterString"}}]),b}(gb),qb=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));if(c.year=0,c.month=0,c.day=0,c.hour=0,c.minute=0,c.second=0,"value"in a){c.fromString(a.value),c.valueBlock.valueHex=new ArrayBuffer(a.value.length);for(var d=new Uint8Array(c.valueBlock.valueHex),e=0;e<a.value.length;e++)d[e]=a.value.charCodeAt(e)}return"valueDate"in a&&(c.fromDate(a.valueDate),c.valueBlock.valueHex=c.toBuffer()),c.idBlock.tagClass=1,c.idBlock.tagNumber=23,c}return _inherits(b,a),_createClass(b,[{key:"fromBER",value:function(b,c,d){var e=this.valueBlock.fromBER(b,c,this.lenBlock.isIndefiniteForm===!0?d:this.lenBlock.length);return e===-1?(this.error=this.valueBlock.error,e):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),e)}},{key:"fromBuffer",value:function(b){this.fromString(String.fromCharCode.apply(null,new Uint8Array(b)))}},{key:"toBuffer",value:function(){for(var b=this.toString(),c=new ArrayBuffer(b.length),d=new Uint8Array(c),e=0;e<b.length;e++)d[e]=b.charCodeAt(e);return c}},{key:"fromDate",value:function(b){this.year=b.getUTCFullYear(),this.month=b.getUTCMonth()+1,this.day=b.getUTCDate(),this.hour=b.getUTCHours(),this.minute=b.getUTCMinutes(),this.second=b.getUTCSeconds()}},{key:"toDate",value:function(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}},{key:"fromString",value:function(b){var c=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/gi,d=c.exec(b);if(null===d)return void(this.error="Wrong input string for convertion");var e=parseInt(d[1],10);e>=50?this.year=1900+e:this.year=2e3+e,this.month=parseInt(d[2],10),this.day=parseInt(d[3],10),this.hour=parseInt(d[4],10),this.minute=parseInt(d[5],10),this.second=parseInt(d[6],10)}},{key:"toString",value:function(){var b=new Array(7);return b[0]=ra(this.year<2e3?this.year-1900:this.year-2e3,2),b[1]=ra(this.month,2),b[2]=ra(this.day,2),b[3]=ra(this.hour,2),b[4]=ra(this.minute,2),b[5]=ra(this.second,2),b[6]="Z",b.join("")}},{key:"toJSON",value:function(){var c={};try{c=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"toJSON",this).call(this)}catch(a){}return c.year=this.year,c.month=this.month,c.day=this.day,c.hour=this.hour,c.minute=this.minute,c.second=this.second,c}}],[{key:"blockName",value:function(){return"UTCTime"}}]),b}(nb),rb=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));if(c.year=0,c.month=0,c.day=0,c.hour=0,c.minute=0,c.second=0,c.millisecond=0,"value"in a){c.fromString(a.value),c.valueBlock.valueHex=new ArrayBuffer(a.value.length);for(var d=new Uint8Array(c.valueBlock.valueHex),e=0;e<a.value.length;e++)d[e]=a.value.charCodeAt(e)}return"valueDate"in a&&(c.fromDate(a.valueDate),c.valueBlock.valueHex=c.toBuffer()),c.idBlock.tagClass=1,c.idBlock.tagNumber=24,c}return _inherits(b,a),_createClass(b,[{key:"fromBER",value:function(b,c,d){var e=this.valueBlock.fromBER(b,c,this.lenBlock.isIndefiniteForm===!0?d:this.lenBlock.length);return e===-1?(this.error=this.valueBlock.error,e):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),e)}},{key:"fromBuffer",value:function(b){this.fromString(String.fromCharCode.apply(null,new Uint8Array(b)))}},{key:"toBuffer",value:function(){for(var b=this.toString(),c=new ArrayBuffer(b.length),d=new Uint8Array(c),e=0;e<b.length;e++)d[e]=b.charCodeAt(e);return c}},{key:"fromDate",value:function(b){this.year=b.getUTCFullYear(),this.month=b.getUTCMonth()+1,this.day=b.getUTCDate(),this.hour=b.getUTCHours(),this.minute=b.getUTCMinutes(),this.second=b.getUTCSeconds(),this.millisecond=b.getUTCMilliseconds()}},{key:"toDate",value:function(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}},{key:"fromString",value:function(b){var c=!1,d="",e="",f=0,g=void 0,h=0,i=0;if("Z"===b[b.length-1])d=b.substr(0,b.length-1),c=!0;else{var j=new Number(b[b.length-1]);if(isNaN(j.valueOf()))throw new Error("Wrong input string for convertion");d=b}if(c){if(d.indexOf("+")!==-1)throw new Error("Wrong input string for convertion");if(d.indexOf("-")!==-1)throw new Error("Wrong input string for convertion")}else{var k=1,l=d.indexOf("+"),m="";if(l===-1&&(l=d.indexOf("-"),k=-1),l!==-1){if(m=d.substr(l+1),d=d.substr(0,l),2!==m.length&&4!==m.length)throw new Error("Wrong input string for convertion");var n=new Number(m.substr(0,2));if(isNaN(n.valueOf()))throw new Error("Wrong input string for convertion");if(h=k*n,4===m.length){if(n=new Number(m.substr(2,2)),isNaN(n.valueOf()))throw new Error("Wrong input string for convertion");i=k*n}}}var o=d.indexOf(".");if(o===-1&&(o=d.indexOf(",")),o!==-1){var p=new Number("0"+d.substr(o));if(isNaN(p.valueOf()))throw new Error("Wrong input string for convertion");f=p.valueOf(),e=d.substr(0,o)}else e=d;switch(!0){case 8===e.length:if(g=/(\d{4})(\d{2})(\d{2})/gi,o!==-1)throw new Error("Wrong input string for convertion");break;case 10===e.length:if(g=/(\d{4})(\d{2})(\d{2})(\d{2})/gi,o!==-1){var q=60*f;this.minute=Math.floor(q),q=60*(q-this.minute),this.second=Math.floor(q),q=1e3*(q-this.second),this.millisecond=Math.floor(q)}break;case 12===e.length:if(g=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/gi,o!==-1){var r=60*f;this.second=Math.floor(r),r=1e3*(r-this.second),this.millisecond=Math.floor(r)}break;case 14===e.length:if(g=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/gi,o!==-1){var s=1e3*f;this.millisecond=Math.floor(s)}break;default:throw new Error("Wrong input string for convertion")}var t=g.exec(e);if(null===t)throw new Error("Wrong input string for convertion");for(var u=1;u<t.length;u++)switch(u){case 1:this.year=parseInt(t[u],10);break;case 2:this.month=parseInt(t[u],10);break;case 3:this.day=parseInt(t[u],10);break;case 4:this.hour=parseInt(t[u],10)+h;break;case 5:this.minute=parseInt(t[u],10)+i;break;case 6:this.second=parseInt(t[u],10);break;default:throw new Error("Wrong input string for convertion")}if(c===!1){var v=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=v.getUTCFullYear(),this.month=v.getUTCMonth(),this.day=v.getUTCDay(),this.hour=v.getUTCHours(),this.minute=v.getUTCMinutes(),this.second=v.getUTCSeconds(),this.millisecond=v.getUTCMilliseconds()}}},{key:"toString",value:function(){var b=[];return b.push(ra(this.year,4)),b.push(ra(this.month,2)),b.push(ra(this.day,2)),b.push(ra(this.hour,2)),b.push(ra(this.minute,2)),b.push(ra(this.second,2)),0!==this.millisecond&&(b.push("."),b.push(ra(this.millisecond,3))),b.push("Z"),b.join("")}},{key:"toJSON",value:function(){var c={};try{c=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"toJSON",this).call(this)}catch(a){}return c.year=this.year,c.month=this.month,c.day=this.day,c.hour=this.hour,c.minute=this.minute,c.second=this.second,c.millisecond=this.millisecond,c}}],[{key:"blockName",value:function(){return"GeneralizedTime"}}]),b}(nb),sb=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.idBlock.tagClass=1,c.idBlock.tagNumber=31,c}return _inherits(b,a),_createClass(b,null,[{key:"blockName",value:function(){return"DATE"}}]),b}(ab),tb=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.idBlock.tagClass=1,c.idBlock.tagNumber=32,c}return _inherits(b,a),_createClass(b,null,[{key:"blockName",value:function(){return"TimeOfDay"}}]),b}(ab),ub=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.idBlock.tagClass=1,c.idBlock.tagNumber=33,c}return _inherits(b,a),_createClass(b,null,[{key:"blockName",value:function(){return"DateTime"}}]),b}(ab),vb=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.idBlock.tagClass=1,c.idBlock.tagNumber=34,c}return _inherits(b,a),_createClass(b,null,[{key:"blockName",value:function(){return"Duration"}}]),b}(ab),wb=function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.idBlock.tagClass=1,c.idBlock.tagNumber=14,c}return _inherits(b,a),_createClass(b,null,[{key:"blockName",value:function(){return"TIME"}}]),b}(ab),xb=function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.value=ia(b,"value",[]),this.optional=ia(b,"optional",!1)},yb=function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.name=ia(b,"name",""),this.optional=ia(b,"optional",!1)},zb=function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.name=ia(b,"name",""),this.optional=ia(b,"optional",!1),this.value=ia(b,"value",new yb),this.local=ia(b,"local",!1)},Ab=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.data=ia(b,"data",new ArrayBuffer(0))}return _createClass(a,[{key:"fromBER",value:function(b,c,d){this.data=b.slice(c,d)}},{key:"toBER",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data}}]),a}(),Eb=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.algorithmId=ia(b,"algorithmId",a.defaultValues("algorithmId")),"algorithmParams"in b&&(this.algorithmParams=ia(b,"algorithmParams",a.defaultValues("algorithmParams"))),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{algorithmIdentifier:"algorithm",algorithmParams:"params"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for AlgorithmIdentifier");this.algorithmId=d.result.algorithm.valueBlock.toString(),"params"in d.result&&(this.algorithmParams=d.result.params)}},{key:"toSchema",value:function(){var b=[];return b.push(new $a({value:this.algorithmId})),"algorithmParams"in this&&this.algorithmParams instanceof yb==!1&&b.push(this.algorithmParams),new Oa({value:b})}},{key:"toJSON",value:function(){var b={algorithmId:this.algorithmId};return"algorithmParams"in this&&this.algorithmParams instanceof yb==!1&&(b.algorithmParams=this.algorithmParams.toJSON()),b}},{key:"isEqual",value:function(c){return c instanceof a!=!1&&(this.algorithmId===c.algorithmId&&("algorithmParams"in this?"algorithmParams"in c&&JSON.stringify(this.algorithmParams)===JSON.stringify(c.algorithmParams):!("algorithmParams"in c)))}}],[{key:"defaultValues",value:function(b){switch(b){case"algorithmId":return"";case"algorithmParams":return new yb;default:throw new Error("Invalid member name for AlgorithmIdentifier class: "+b)}}},{key:"compareWithDefault",value:function(b,c){switch(b){case"algorithmId":return""===c;case"algorithmParams":return c instanceof yb;default:throw new Error("Invalid member name for AlgorithmIdentifier class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",optional:c.optional||!1,value:[new $a({name:c.algorithmIdentifier||""}),new yb({name:c.algorithmParams||"",optional:!0})]})}}]),a}(),Fb=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.hashAlgorithm=ia(b,"hashAlgorithm",a.defaultValues("hashAlgorithm")),this.maskGenAlgorithm=ia(b,"maskGenAlgorithm",a.defaultValues("maskGenAlgorithm")),this.saltLength=ia(b,"saltLength",a.defaultValues("saltLength")),this.trailerField=ia(b,"trailerField",a.defaultValues("trailerField")),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{hashAlgorithm:{names:{blockName:"hashAlgorithm"}},maskGenAlgorithm:{names:{blockName:"maskGenAlgorithm"}},saltLength:"saltLength",trailerField:"trailerField"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for RSASSA_PSS_params");"hashAlgorithm"in d.result&&(this.hashAlgorithm=new Eb({schema:d.result.hashAlgorithm})),"maskGenAlgorithm"in d.result&&(this.maskGenAlgorithm=new Eb({schema:d.result.maskGenAlgorithm})),"saltLength"in d.result&&(this.saltLength=d.result.saltLength.valueBlock.valueDec),"trailerField"in d.result&&(this.trailerField=d.result.trailerField.valueBlock.valueDec)}},{key:"toSchema",value:function(){var c=[];return this.hashAlgorithm.isEqual(a.defaultValues("hashAlgorithm"))||c.push(new Ja({idBlock:{tagClass:3,tagNumber:0},value:[this.hashAlgorithm.toSchema()]})),this.maskGenAlgorithm.isEqual(a.defaultValues("maskGenAlgorithm"))||c.push(new Ja({idBlock:{tagClass:3,tagNumber:1},value:[this.maskGenAlgorithm.toSchema()]})),this.saltLength!==a.defaultValues("saltLength")&&c.push(new Ja({idBlock:{tagClass:3,tagNumber:2},value:[new Wa({value:this.saltLength})]})),this.trailerField!==a.defaultValues("trailerField")&&c.push(new Ja({idBlock:{tagClass:3,tagNumber:3},value:[new Wa({value:this.trailerField})]})),new Oa({value:c})}},{key:"toJSON",value:function(){var c={};return this.hashAlgorithm.isEqual(a.defaultValues("hashAlgorithm"))||(c.hashAlgorithm=this.hashAlgorithm.toJSON()),this.maskGenAlgorithm.isEqual(a.defaultValues("maskGenAlgorithm"))||(c.maskGenAlgorithm=this.maskGenAlgorithm.toJSON()),this.saltLength!==a.defaultValues("saltLength")&&(c.saltLength=this.saltLength),this.trailerField!==a.defaultValues("trailerField")&&(c.trailerField=this.trailerField),c}}],[{key:"defaultValues",value:function(b){switch(b){case"hashAlgorithm":return new Eb({algorithmId:"1.3.14.3.2.26",algorithmParams:new Qa});case"maskGenAlgorithm":return new Eb({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:new Eb({algorithmId:"1.3.14.3.2.26",algorithmParams:new Qa}).toSchema()});case"saltLength":return 20;case"trailerField":return 1;default:throw new Error("Invalid member name for RSASSAPSSParams class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[new Ja({idBlock:{tagClass:3,tagNumber:0},optional:!0,value:[Eb.schema(c.hashAlgorithm||{})]}),new Ja({idBlock:{tagClass:3,tagNumber:1},optional:!0,value:[Eb.schema(c.maskGenAlgorithm||{})]}),new Ja({idBlock:{tagClass:3,tagNumber:2},optional:!0,value:[new Wa({name:c.saltLength||""})]}),new Ja({idBlock:{tagClass:3,tagNumber:3},optional:!0,value:[new Wa({name:c.trailerField||""})]})]})}}]),a}(),Gb=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.x=ia(b,"x",a.defaultValues("x")),this.y=ia(b,"y",a.defaultValues("y")),this.namedCurve=ia(b,"namedCurve",a.defaultValues("namedCurve")),"schema"in b&&this.fromSchema(b.schema),"json"in b&&this.fromJSON(b.json)}return _createClass(a,[{key:"fromSchema",value:function(b){if(b instanceof ArrayBuffer==!1)throw new Error("Object's schema was not verified against input data for ECPublicKey");var c=new Uint8Array(b);if(4!==c[0])throw new Error("Object's schema was not verified against input data for ECPublicKey");var d=void 0;switch(this.namedCurve){case"1.2.840.10045.3.1.7":d=32;break;case"1.3.132.0.34":d=48;break;case"1.3.132.0.35":d=66;break;default:throw new Error("Incorrect curve OID: "+this.namedCurve)}if(b.byteLength!==2*d+1)throw new Error("Object's schema was not verified against input data for ECPublicKey");this.x=b.slice(1,d+1),this.y=b.slice(1+d,2*d+1)}},{key:"toSchema",value:function(){return new Ab({data:na(new Uint8Array([4]).buffer,this.x,this.y)})}},{key:"toJSON",value:function(){var b="";switch(this.namedCurve){case"1.2.840.10045.3.1.7":b="P-256";break;case"1.3.132.0.34":b="P-384";break;case"1.3.132.0.35":b="P-521"}return{crv:b,x:ua(wa(this.x),!0,!0),y:ua(wa(this.y),!0,!0)}}},{key:"fromJSON",value:function(b){var c=0;if(!("crv"in b))throw new Error('Absent mandatory parameter "crv"');switch(b.crv.toUpperCase()){case"P-256":this.namedCurve="1.2.840.10045.3.1.7",c=32;break;case"P-384":this.namedCurve="1.3.132.0.34",c=48;break;case"P-521":this.namedCurve="1.3.132.0.35",c=66}if(!("x"in b))throw new Error('Absent mandatory parameter "x"');if(this.x=xa(va(b.x,!0)).slice(0,c),!("y"in b))throw new Error('Absent mandatory parameter "y"');this.y=xa(va(b.y,!0)).slice(0,c)}}],[{key:"defaultValues",value:function(b){switch(b){case"x":case"y":return new ArrayBuffer(0);case"namedCurve":return"";default:throw new Error("Invalid member name for ECCPublicKey class: "+b)}}},{key:"compareWithDefault",value:function(c,d){switch(c){case"x":case"y":return qa(d,a.defaultValues(c));case"namedCurve":return""===d;default:throw new Error("Invalid member name for ECCPublicKey class: "+c)}}},{key:"schema",value:function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Ab}}]),a}(),Hb=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.modulus=ia(b,"modulus",a.defaultValues("modulus")),this.publicExponent=ia(b,"publicExponent",a.defaultValues("publicExponent")),"schema"in b&&this.fromSchema(b.schema),"json"in b&&this.fromJSON(b.json)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{modulus:"modulus",publicExponent:"publicExponent"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for RSAPublicKey");this.modulus=d.result.modulus.convertFromDER(256),this.publicExponent=d.result.publicExponent}},{key:"toSchema",value:function(){return new Oa({value:[this.modulus.convertToDER(),this.publicExponent]})}},{key:"toJSON",value:function(){return{n:ua(wa(this.modulus.valueBlock.valueHex),!0,!0),e:ua(wa(this.publicExponent.valueBlock.valueHex),!0,!0)}}},{key:"fromJSON",value:function(b){if(!("n"in b))throw new Error('Absent mandatory parameter "n"');if(this.modulus=new Wa({valueHex:xa(va(b.n,!0)).slice(0,256)}),!("e"in b))throw new Error('Absent mandatory parameter "e"');this.publicExponent=new Wa({valueHex:xa(va(b.e,!0)).slice(0,3)})}}],[{key:"defaultValues",value:function(b){switch(b){case"modulus":return new Wa;case"publicExponent":return new Wa;default:throw new Error("Invalid member name for RSAPublicKey class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[new Wa({name:c.modulus||""}),new Wa({name:c.publicExponent||""})]})}}]),a}(),Ib=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.algorithm=ia(b,"algorithm",a.defaultValues("algorithm")),this.subjectPublicKey=ia(b,"subjectPublicKey",a.defaultValues("subjectPublicKey")),"parsedKey"in b&&(this.parsedKey=ia(b,"parsedKey",a.defaultValues("parsedKey"))),"schema"in b&&this.fromSchema(b.schema),"json"in b&&this.fromJSON(b.json)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{algorithm:{names:{blockName:"algorithm"}},subjectPublicKey:"subjectPublicKey"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for PUBLIC_KEY_INFO");switch(this.algorithm=new Eb({schema:d.result.algorithm}),this.subjectPublicKey=d.result.subjectPublicKey,this.algorithm.algorithmId){case"1.2.840.10045.2.1":"algorithmParams"in this.algorithm&&this.algorithm.algorithmParams instanceof $a&&(this.parsedKey=new Gb({namedCurve:this.algorithm.algorithmParams.valueBlock.toString(),schema:this.subjectPublicKey.valueBlock.valueHex}));break;case"1.2.840.113549.1.1.1":var e=Cb(this.subjectPublicKey.valueBlock.valueHex);e.offset!==-1&&(this.parsedKey=new Hb({schema:e.result}))}}},{key:"toSchema",value:function(){return new Oa({value:[this.algorithm.toSchema(),this.subjectPublicKey]})}},{key:"toJSON",value:function(){if("parsedKey"in this==!1)return{algorithm:this.algorithm.toJSON(),subjectPublicKey:this.subjectPublicKey.toJSON()};var b={};switch(this.algorithm.algorithmId){case"1.2.840.10045.2.1":b.kty="EC";break;case"1.2.840.113549.1.1.1":b.kty="RSA"}var c=this.parsedKey.toJSON(),d=!0,e=!1,f=void 0;try{for(var h,g=Object.keys(c)[Symbol.iterator]();!(d=(h=g.next()).done);d=!0){var i=h.value;b[i]=c[i]}}catch(a){e=!0,f=a}finally{try{!d&&g.return&&g.return()}finally{if(e)throw f}}return b}},{key:"fromJSON",value:function(b){if("kty"in b){switch(b.kty.toUpperCase()){case"EC":this.parsedKey=new Gb({json:b}),this.algorithm=new Eb({algorithmId:"1.2.840.10045.2.1",algorithmParams:new $a({value:this.parsedKey.namedCurve})});break;case"RSA":this.parsedKey=new Hb({json:b}),this.algorithm=new Eb({algorithmId:"1.2.840.113549.1.1.1",algorithmParams:new Qa});break;default:throw new Error('Invalid value for "kty" parameter: '+b.kty)}this.subjectPublicKey=new Ua({valueHex:this.parsedKey.toSchema().toBER(!1)})}}},{key:"importKey",value:function(b){var c=Promise.resolve(),d=this;if("undefined"==typeof b)return Promise.reject("Need to provide publicKey input parameter");var e=Rb();return"undefined"==typeof e?Promise.reject("Unable to create WebCrypto object"):(c=c.then(function(){return e.exportKey("spki",b)}),c=c.then(function(a){var b=Cb(a);try{d.fromSchema(b.result)}catch(a){return Promise.reject("Error during initializing object from schema")}},function(a){return Promise.reject("Error during exporting public key: "+a)}))}}],[{key:"defaultValues",value:function(b){switch(b){case"algorithm":return new Eb;case"subjectPublicKey":return new Ua;default:throw new Error("Invalid member name for PublicKeyInfo class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[Eb.schema(c.algorithm||{}),new Ua({name:c.subjectPublicKey||""})]})}}]),a}(),Jb=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.type=ia(b,"type",a.defaultValues("type")),this.values=ia(b,"values",a.defaultValues("values")),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{type:"type",values:"values"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for ATTRIBUTE");this.type=d.result.type.valueBlock.toString(),this.values=d.result.values}},{key:"toSchema",value:function(){return new Oa({value:[new $a({value:this.type}),new Pa({value:this.values})]})}},{key:"toJSON",value:function(){return{type:this.type,values:Array.from(this.values,function(a){return a.toJSON()})}}}],[{key:"defaultValues",value:function(b){switch(b){case"type":return"";case"values":return[];default:throw new Error("Invalid member name for Attribute class: "+b)}}},{key:"compareWithDefault",
value:function(b,c){switch(b){case"type":return""===c;case"values":return 0===c.length;default:throw new Error("Invalid member name for Attribute class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[new $a({name:c.type||""}),new Pa({name:c.setName||"",value:[new zb({name:c.values||"",value:new yb})]})]})}}]),a}(),Kb=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.version=ia(b,"version",a.defaultValues("version")),this.privateKey=ia(b,"privateKey",a.defaultValues("privateKey")),"namedCurve"in b&&(this.namedCurve=ia(b,"namedCurve",a.defaultValues("namedCurve"))),"publicKey"in b&&(this.publicKey=ia(b,"publicKey",a.defaultValues("publicKey"))),"schema"in b&&this.fromSchema(b.schema),"json"in b&&this.fromJSON(b.json)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{version:"version",privateKey:"privateKey",namedCurve:"namedCurve",publicKey:"publicKey"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for ECPrivateKey");if(this.version=d.result.version.valueBlock.valueDec,this.privateKey=d.result.privateKey,"namedCurve"in d.result&&(this.namedCurve=d.result.namedCurve.valueBlock.toString()),"publicKey"in d.result){var e={schema:d.result.publicKey.valueBlock.valueHex};"namedCurve"in this&&(e.namedCurve=this.namedCurve),this.publicKey=new Gb(e)}}},{key:"toSchema",value:function(){var b=[new Wa({value:this.version}),this.privateKey];return"namedCurve"in this&&b.push(new Ja({idBlock:{tagClass:3,tagNumber:0},value:[new $a({value:this.namedCurve})]})),"publicKey"in this&&b.push(new Ja({idBlock:{tagClass:3,tagNumber:1},value:[new Ua({valueHex:this.publicKey.toSchema().toBER(!1)})]})),new Oa({value:b})}},{key:"toJSON",value:function(){if("namedCurve"in this==!1||a.compareWithDefault("namedCurve",this.namedCurve))throw new Error('Not enough information for making JSON: absent "namedCurve" value');var c="";switch(this.namedCurve){case"1.2.840.10045.3.1.7":c="P-256";break;case"1.3.132.0.34":c="P-384";break;case"1.3.132.0.35":c="P-521"}var d={crv:c,d:ua(wa(this.privateKey.valueBlock.valueHex),!0,!0)};if("publicKey"in this){var e=this.publicKey.toJSON();d.x=e.x,d.y=e.y}return d}},{key:"fromJSON",value:function(b){var c=0;if(!("crv"in b))throw new Error('Absent mandatory parameter "crv"');switch(b.crv.toUpperCase()){case"P-256":this.namedCurve="1.2.840.10045.3.1.7",c=32;break;case"P-384":this.namedCurve="1.3.132.0.34",c=48;break;case"P-521":this.namedCurve="1.3.132.0.35",c=66}if(!("d"in b))throw new Error('Absent mandatory parameter "d"');this.privateKey=new Sa({valueHex:xa(va(b.d,!0)).slice(0,c)}),"x"in b&&"y"in b&&(this.publicKey=new Gb({json:b}))}}],[{key:"defaultValues",value:function(b){switch(b){case"version":return 1;case"privateKey":return new Sa;case"namedCurve":return"";case"publicKey":return new Gb;default:throw new Error("Invalid member name for ECCPrivateKey class: "+b)}}},{key:"compareWithDefault",value:function(c,d){switch(c){case"version":return d===a.defaultValues(c);case"privateKey":return d.isEqual(a.defaultValues(c));case"namedCurve":return""===d;case"publicKey":return Gb.compareWithDefault("namedCurve",d.namedCurve)&&Gb.compareWithDefault("x",d.x)&&Gb.compareWithDefault("y",d.y);default:throw new Error("Invalid member name for ECCPrivateKey class: "+c)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[new Wa({name:c.version||""}),new Sa({name:c.privateKey||""}),new Ja({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new $a({name:c.namedCurve||""})]}),new Ja({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new Ua({name:c.publicKey||""})]})]})}}]),a}(),Lb=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.prime=ia(b,"prime",a.defaultValues("prime")),this.exponent=ia(b,"exponent",a.defaultValues("exponent")),this.coefficient=ia(b,"coefficient",a.defaultValues("coefficient")),"schema"in b&&this.fromSchema(b.schema),"json"in b&&this.fromJSON(b.json)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{prime:"prime",exponent:"exponent",coefficient:"coefficient"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for OtherPrimeInfo");this.prime=d.result.prime.convertFromDER(),this.exponent=d.result.exponent.convertFromDER(),this.coefficient=d.result.coefficient.convertFromDER()}},{key:"toSchema",value:function(){return new Oa({value:[this.prime.convertToDER(),this.exponent.convertToDER(),this.coefficient.convertToDER()]})}},{key:"toJSON",value:function(){return{r:ua(wa(this.prime.valueBlock.valueHex),!0,!0),d:ua(wa(this.exponent.valueBlock.valueHex),!0,!0),t:ua(wa(this.coefficient.valueBlock.valueHex),!0,!0)}}},{key:"fromJSON",value:function(b){if(!("r"in b))throw new Error('Absent mandatory parameter "r"');if(this.prime=new Wa({valueHex:xa(va(b.r,!0))}),!("d"in b))throw new Error('Absent mandatory parameter "d"');if(this.exponent=new Wa({valueHex:xa(va(b.d,!0))}),!("t"in b))throw new Error('Absent mandatory parameter "t"');this.coefficient=new Wa({valueHex:xa(va(b.t,!0))})}}],[{key:"defaultValues",value:function(b){switch(b){case"prime":return new Wa;case"exponent":return new Wa;case"coefficient":return new Wa;default:throw new Error("Invalid member name for OtherPrimeInfo class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[new Wa({name:c.prime||""}),new Wa({name:c.exponent||""}),new Wa({name:c.coefficient||""})]})}}]),a}(),Mb=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.version=ia(b,"version",a.defaultValues("version")),this.modulus=ia(b,"modulus",a.defaultValues("modulus")),this.publicExponent=ia(b,"publicExponent",a.defaultValues("publicExponent")),this.privateExponent=ia(b,"privateExponent",a.defaultValues("privateExponent")),this.prime1=ia(b,"prime1",a.defaultValues("prime1")),this.prime2=ia(b,"prime2",a.defaultValues("prime2")),this.exponent1=ia(b,"exponent1",a.defaultValues("exponent1")),this.exponent2=ia(b,"exponent2",a.defaultValues("exponent2")),this.coefficient=ia(b,"coefficient",a.defaultValues("coefficient")),"otherPrimeInfos"in b&&(this.otherPrimeInfos=ia(b,"otherPrimeInfos",a.defaultValues("otherPrimeInfos"))),"schema"in b&&this.fromSchema(b.schema),"json"in b&&this.fromJSON(b.json)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{version:"version",modulus:"modulus",publicExponent:"publicExponent",privateExponent:"privateExponent",prime1:"prime1",prime2:"prime2",exponent1:"exponent1",exponent2:"exponent2",coefficient:"coefficient",otherPrimeInfo:{names:{blockName:"otherPrimeInfos"}}}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for RSAPrivateKey");this.version=d.result.version.valueBlock.valueDec,this.modulus=d.result.modulus.convertFromDER(256),this.publicExponent=d.result.publicExponent,this.privateExponent=d.result.privateExponent.convertFromDER(256),this.prime1=d.result.prime1.convertFromDER(128),this.prime2=d.result.prime2.convertFromDER(128),this.exponent1=d.result.exponent1.convertFromDER(128),this.exponent2=d.result.exponent2.convertFromDER(128),this.coefficient=d.result.coefficient.convertFromDER(128),"otherPrimeInfos"in d.result&&(this.otherPrimeInfos=Array.from(d.result.otherPrimeInfos,function(a){return new Lb({schema:a})}))}},{key:"toSchema",value:function(){var b=[];return b.push(new Wa({value:this.version})),b.push(this.modulus.convertToDER()),b.push(this.publicExponent),b.push(this.privateExponent.convertToDER()),b.push(this.prime1.convertToDER()),b.push(this.prime2.convertToDER()),b.push(this.exponent1.convertToDER()),b.push(this.exponent2.convertToDER()),b.push(this.coefficient.convertToDER()),"otherPrimeInfos"in this&&b.push(new Oa({value:Array.from(this.otherPrimeInfos,function(a){return a.toSchema()})})),new Oa({value:b})}},{key:"toJSON",value:function(){var b={n:ua(wa(this.modulus.valueBlock.valueHex),!0,!0),e:ua(wa(this.publicExponent.valueBlock.valueHex),!0,!0),d:ua(wa(this.privateExponent.valueBlock.valueHex),!0,!0),p:ua(wa(this.prime1.valueBlock.valueHex),!0,!0),q:ua(wa(this.prime2.valueBlock.valueHex),!0,!0),dp:ua(wa(this.exponent1.valueBlock.valueHex),!0,!0),dq:ua(wa(this.exponent2.valueBlock.valueHex),!0,!0),qi:ua(wa(this.coefficient.valueBlock.valueHex),!0,!0)};return"otherPrimeInfos"in this&&(b.oth=Array.from(this.otherPrimeInfos,function(a){return a.toJSON()})),b}},{key:"fromJSON",value:function(b){if(!("n"in b))throw new Error('Absent mandatory parameter "n"');if(this.modulus=new Wa({valueHex:xa(va(b.n,!0,!0))}),!("e"in b))throw new Error('Absent mandatory parameter "e"');if(this.publicExponent=new Wa({valueHex:xa(va(b.e,!0,!0))}),!("d"in b))throw new Error('Absent mandatory parameter "d"');if(this.privateExponent=new Wa({valueHex:xa(va(b.d,!0,!0))}),!("p"in b))throw new Error('Absent mandatory parameter "p"');if(this.prime1=new Wa({valueHex:xa(va(b.p,!0,!0))}),!("q"in b))throw new Error('Absent mandatory parameter "q"');if(this.prime2=new Wa({valueHex:xa(va(b.q,!0,!0))}),!("dp"in b))throw new Error('Absent mandatory parameter "dp"');if(this.exponent1=new Wa({valueHex:xa(va(b.dp,!0,!0))}),!("dq"in b))throw new Error('Absent mandatory parameter "dq"');if(this.exponent2=new Wa({valueHex:xa(va(b.dq,!0,!0))}),!("qi"in b))throw new Error('Absent mandatory parameter "qi"');this.coefficient=new Wa({valueHex:xa(va(b.qi,!0,!0))}),"oth"in b&&(this.otherPrimeInfos=Array.from(b.oth,function(a){return new Lb({json:a})}))}}],[{key:"defaultValues",value:function(b){switch(b){case"version":return 0;case"modulus":return new Wa;case"publicExponent":return new Wa;case"privateExponent":return new Wa;case"prime1":return new Wa;case"prime2":return new Wa;case"exponent1":return new Wa;case"exponent2":return new Wa;case"coefficient":return new Wa;case"otherPrimeInfos":return[];default:throw new Error("Invalid member name for RSAPrivateKey class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[new Wa({name:c.version||""}),new Wa({name:c.modulus||""}),new Wa({name:c.publicExponent||""}),new Wa({name:c.privateExponent||""}),new Wa({name:c.prime1||""}),new Wa({name:c.prime2||""}),new Wa({name:c.exponent1||""}),new Wa({name:c.exponent2||""}),new Wa({name:c.coefficient||""}),new Oa({optional:!0,value:[new zb({name:c.otherPrimeInfosName||"",value:Lb.schema(c.otherPrimeInfo||{})})]})]})}}]),a}(),Nb=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.version=ia(b,"version",a.defaultValues("version")),this.privateKeyAlgorithm=ia(b,"privateKeyAlgorithm",a.defaultValues("privateKeyAlgorithm")),this.privateKey=ia(b,"privateKey",a.defaultValues("privateKey")),"attributes"in b&&(this.attributes=ia(b,"attributes",a.defaultValues("attributes"))),"parsedKey"in b&&(this.parsedKey=ia(b,"parsedKey",a.defaultValues("parsedKey"))),"schema"in b&&this.fromSchema(b.schema),"json"in b&&this.fromJSON(b.json)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{version:"version",privateKeyAlgorithm:{names:{blockName:"privateKeyAlgorithm"}},privateKey:"privateKey",attributes:"attributes"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for PKCS8");switch(this.version=d.result.version.valueBlock.valueDec,this.privateKeyAlgorithm=new Eb({schema:d.result.privateKeyAlgorithm}),this.privateKey=d.result.privateKey,"attributes"in d.result&&(this.attributes=Array.from(d.result.attributes,function(a){return new Jb({schema:a})})),this.privateKeyAlgorithm.algorithmId){case"1.2.840.113549.1.1.1":var e=Cb(this.privateKey.valueBlock.valueHex);e.offset!==-1&&(this.parsedKey=new Mb({schema:e.result}));break;case"1.2.840.10045.2.1":if("algorithmParams"in this.privateKeyAlgorithm&&this.privateKeyAlgorithm.algorithmParams instanceof $a){var f=Cb(this.privateKey.valueBlock.valueHex);f.offset!==-1&&(this.parsedKey=new Kb({namedCurve:this.privateKeyAlgorithm.algorithmParams.valueBlock.toString(),schema:f.result}))}}}},{key:"toSchema",value:function(){var b=[new Wa({value:this.version}),this.privateKeyAlgorithm.toSchema(),this.privateKey];return"attributes"in this&&b.push(new Ja({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.attributes,function(a){return a.toSchema()})})),new Oa({value:b})}},{key:"toJSON",value:function(){if("parsedKey"in this==!1){var b={version:this.version,privateKeyAlgorithm:this.privateKeyAlgorithm.toJSON(),privateKey:this.privateKey.toJSON()};return"attributes"in this&&(b.attributes=Array.from(this.attributes,function(a){return a.toJSON()})),b}var c={};switch(this.privateKeyAlgorithm.algorithmId){case"1.2.840.10045.2.1":c.kty="EC";break;case"1.2.840.113549.1.1.1":c.kty="RSA"}var d=this.parsedKey.toJSON(),e=!0,f=!1,g=void 0;try{for(var i,h=Object.keys(d)[Symbol.iterator]();!(e=(i=h.next()).done);e=!0){var j=i.value;c[j]=d[j]}}catch(a){f=!0,g=a}finally{try{!e&&h.return&&h.return()}finally{if(f)throw g}}return c}},{key:"fromJSON",value:function(b){if("kty"in b){switch(b.kty.toUpperCase()){case"EC":this.parsedKey=new Kb({json:b}),this.privateKeyAlgorithm=new Eb({algorithmId:"1.2.840.10045.2.1",algorithmParams:new $a({value:this.parsedKey.namedCurve})});break;case"RSA":this.parsedKey=new Mb({json:b}),this.privateKeyAlgorithm=new Eb({algorithmId:"1.2.840.113549.1.1.1",algorithmParams:new Qa});break;default:throw new Error('Invalid value for "kty" parameter: '+b.kty)}this.privateKey=new Sa({valueHex:this.parsedKey.toSchema().toBER(!1)})}}}],[{key:"defaultValues",value:function(b){switch(b){case"version":return 0;case"privateKeyAlgorithm":return new Eb;case"privateKey":return new Sa;case"attributes":return[];default:throw new Error("Invalid member name for PrivateKeyInfo class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[new Wa({name:c.version||""}),Eb.schema(c.privateKeyAlgorithm||{}),new Sa({name:c.privateKey||""}),new Ja({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new zb({name:c.attributes||"",value:Jb.schema()})]})]})}}]),a}(),Ob=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.crypto=ia(b,"crypto",{}),this.name=ia(b,"name","")}return _createClass(a,[{key:"importKey",value:function(b,c,d,e,f){var g={};switch(c instanceof Uint8Array&&(c=c.buffer),b.toLowerCase()){case"raw":return this.crypto.importKey("raw",c,d,e,f);case"spki":var h=Cb(c);if(h.offset===-1)return Promise.reject("Incorrect keyData");var i=new Ib;try{i.fromSchema(h.result)}catch(a){return Promise.reject("Incorrect keyData")}switch(d.name.toUpperCase()){case"RSA-PSS":switch(d.hash.name.toUpperCase()){case"SHA-1":g.alg="PS1";break;case"SHA-256":g.alg="PS256";break;case"SHA-384":g.alg="PS384";break;case"SHA-512":g.alg="PS512";break;default:return Promise.reject("Incorrect hash algorithm: "+d.hash.name.toUpperCase())}case"RSASSA-PKCS1-V1_5":if(f=["verify"],g.kty="RSA",g.ext=e,g.key_ops=f,"1.2.840.113549.1.1.1"!==i.algorithm.algorithmId)return Promise.reject("Incorrect public key algorithm: "+i.algorithm.algorithmId);if("alg"in g==!1)switch(d.hash.name.toUpperCase()){case"SHA-1":g.alg="RS1";break;case"SHA-256":g.alg="RS256";break;case"SHA-384":g.alg="RS384";break;case"SHA-512":g.alg="RS512";break;default:return Promise.reject("Incorrect public key algorithm: "+i.algorithm.algorithmId)}var j=i.toJSON(),k=!0,l=!1,m=void 0;try{for(var o,n=Object.keys(j)[Symbol.iterator]();!(k=(o=n.next()).done);k=!0){var p=o.value;g[p]=j[p]}}catch(a){l=!0,m=a}finally{try{!k&&n.return&&n.return()}finally{if(l)throw m}}break;case"ECDSA":f=["verify"];case"ECDH":if(g={kty:"EC",ext:e,key_ops:f},"1.2.840.10045.2.1"!==i.algorithm.algorithmId)return Promise.reject("Incorrect public key algorithm: "+i.algorithm.algorithmId);var q=i.toJSON(),r=!0,s=!1,t=void 0;try{for(var v,u=Object.keys(q)[Symbol.iterator]();!(r=(v=u.next()).done);r=!0){var w=v.value;g[w]=q[w]}}catch(a){s=!0,t=a}finally{try{!r&&u.return&&u.return()}finally{if(s)throw t}}break;case"RSA-OAEP":if(g.kty="RSA",g.ext=e,g.key_ops=f,"safari"===this.name.toLowerCase())g.alg="RSA-OAEP";else switch(d.hash.name.toUpperCase()){case"SHA-1":g.alg="RSA-OAEP-1";break;case"SHA-256":g.alg="RSA-OAEP-256";break;case"SHA-384":g.alg="RSA-OAEP-384";break;case"SHA-512":g.alg="RSA-OAEP-512";break;default:return Promise.reject("Incorrect public key algorithm: "+i.algorithm.algorithmId)}var x=i.toJSON(),y=!0,z=!1,A=void 0;try{for(var C,B=Object.keys(x)[Symbol.iterator]();!(y=(C=B.next()).done);y=!0){var D=C.value;g[D]=x[D]}}catch(a){z=!0,A=a}finally{try{!y&&B.return&&B.return()}finally{if(z)throw A}}break;default:return Promise.reject("Incorrect algorithm name: "+d.name.toUpperCase())}break;case"pkcs8":var E=new Nb,F=Cb(c);if(F.offset===-1)return Promise.reject("Incorrect keyData");try{E.fromSchema(F.result)}catch(a){return Promise.reject("Incorrect keyData")}switch(d.name.toUpperCase()){case"RSA-PSS":switch(d.hash.name.toUpperCase()){case"SHA-1":g.alg="PS1";break;case"SHA-256":g.alg="PS256";break;case"SHA-384":g.alg="PS384";break;case"SHA-512":g.alg="PS512";break;default:return Promise.reject("Incorrect hash algorithm: "+d.hash.name.toUpperCase())}case"RSASSA-PKCS1-V1_5":if(f=["sign"],g.kty="RSA",g.ext=e,g.key_ops=f,"1.2.840.113549.1.1.1"!==E.privateKeyAlgorithm.algorithmId)return Promise.reject("Incorrect private key algorithm: "+E.privateKeyAlgorithm.algorithmId);if("alg"in g==!1)switch(d.hash.name.toUpperCase()){case"SHA-1":g.alg="RS1";break;case"SHA-256":g.alg="RS256";break;case"SHA-384":g.alg="RS384";break;case"SHA-512":g.alg="RS512";break;default:return Promise.reject("Incorrect hash algorithm: "+d.hash.name.toUpperCase())}var G=E.toJSON(),H=!0,I=!1,J=void 0;try{for(var L,K=Object.keys(G)[Symbol.iterator]();!(H=(L=K.next()).done);H=!0){var M=L.value;g[M]=G[M]}}catch(a){I=!0,J=a}finally{try{!H&&K.return&&K.return()}finally{if(I)throw J}}break;case"ECDSA":f=["sign"];case"ECDH":if(g={kty:"EC",ext:e,key_ops:f},"1.2.840.10045.2.1"!==E.privateKeyAlgorithm.algorithmId)return Promise.reject("Incorrect algorithm: "+E.privateKeyAlgorithm.algorithmId);var N=E.toJSON(),O=!0,P=!1,Q=void 0;try{for(var S,R=Object.keys(N)[Symbol.iterator]();!(O=(S=R.next()).done);O=!0){var T=S.value;g[T]=N[T]}}catch(a){P=!0,Q=a}finally{try{!O&&R.return&&R.return()}finally{if(P)throw Q}}break;case"RSA-OAEP":if(g.kty="RSA",g.ext=e,g.key_ops=f,"safari"===this.name.toLowerCase())g.alg="RSA-OAEP";else switch(d.hash.name.toUpperCase()){case"SHA-1":g.alg="RSA-OAEP-1";break;case"SHA-256":g.alg="RSA-OAEP-256";break;case"SHA-384":g.alg="RSA-OAEP-384";break;case"SHA-512":g.alg="RSA-OAEP-512";break;default:return Promise.reject("Incorrect hash algorithm: "+d.hash.name.toUpperCase())}var U=E.toJSON(),V=!0,W=!1,X=void 0;try{for(var Z,Y=Object.keys(U)[Symbol.iterator]();!(V=(Z=Y.next()).done);V=!0){var $=Z.value;g[$]=U[$]}}catch(a){W=!0,X=a}finally{try{!V&&Y.return&&Y.return()}finally{if(W)throw X}}break;default:return Promise.reject("Incorrect algorithm name: "+d.name.toUpperCase())}break;case"jwk":g=c;break;default:return Promise.reject("Incorrect format: "+b)}return"safari"===this.name.toLowerCase()&&g instanceof ArrayBuffer==!1&&(g=xa(JSON.stringify(g))),this.crypto.importKey("jwk",g,d,e,f)}},{key:"exportKey",value:function(b,c){var d=this.crypto.exportKey("jwk",c);switch("safari"===this.name.toLowerCase()&&(d=d.then(function(a){return JSON.parse(wa(a))})),b.toLowerCase()){case"raw":return this.crypto.exportKey("raw",c);case"spki":d=d.then(function(a){var b=new Ib;try{b.fromJSON(a)}catch(a){return Promise.reject("Incorrect key data")}return b.toSchema().toBER(!1)});break;case"pkcs8":d=d.then(function(a){var b=new Nb;try{b.fromJSON(a)}catch(a){return Promise.reject("Incorrect key data")}return b.toSchema().toBER(!1)});break;case"jwk":break;default:return Promise.reject("Incorrect format: "+b)}return d}},{key:"convert",value:function(b,c,d,e,f,g){var h=this;switch(b.toLowerCase()){case"raw":switch(c.toLowerCase()){case"raw":return Promise.resolve(d);case"spki":return Promise.resolve().then(function(){return h.importKey("raw",d,e,f,g)}).then(function(a){return h.exportKey("spki",a)});case"pkcs8":return Promise.resolve().then(function(){return h.importKey("raw",d,e,f,g)}).then(function(a){return h.exportKey("pkcs8",a)});case"jwk":return Promise.resolve().then(function(){return h.importKey("raw",d,e,f,g)}).then(function(a){return h.exportKey("jwk",a)});default:return Promise.reject("Incorrect outputFormat: "+c)}case"spki":switch(c.toLowerCase()){case"raw":return Promise.resolve().then(function(){return h.importKey("spki",d,e,f,g)}).then(function(a){return h.exportKey("raw",a)});case"spki":return Promise.resolve(d);case"pkcs8":return Promise.reject("Impossible to convert between SPKI/PKCS8");case"jwk":return Promise.resolve().then(function(){return h.importKey("spki",d,e,f,g)}).then(function(a){return h.exportKey("jwk",a)});default:return Promise.reject("Incorrect outputFormat: "+c)}case"pkcs8":switch(c.toLowerCase()){case"raw":return Promise.resolve().then(function(){return h.importKey("pkcs8",d,e,f,g)}).then(function(a){return h.exportKey("raw",a)});case"spki":return Promise.reject("Impossible to convert between SPKI/PKCS8");case"pkcs8":return Promise.resolve(d);case"jwk":return Promise.resolve().then(function(){return h.importKey("pkcs8",d,e,f,g)}).then(function(a){return h.exportKey("jwk",a)});default:return Promise.reject("Incorrect outputFormat: "+c)}case"jwk":switch(c.toLowerCase()){case"raw":return Promise.resolve().then(function(){return h.importKey("jwk",d,e,f,g)}).then(function(a){return h.exportKey("raw",a)});case"spki":return Promise.resolve().then(function(){return h.importKey("jwk",d,e,f,g)}).then(function(a){return h.exportKey("spki",a)});case"pkcs8":return Promise.resolve().then(function(){return h.importKey("jwk",d,e,f,g)}).then(function(a){return h.exportKey("pkcs8",a)});case"jwk":return Promise.resolve(d);default:return Promise.reject("Incorrect outputFormat: "+c)}default:return Promise.reject("Incorrect inputFormat: "+b)}}},{key:"encrypt",value:function(){var b;return(b=this.crypto).encrypt.apply(b,arguments)}},{key:"decrypt",value:function(){var b;return(b=this.crypto).decrypt.apply(b,arguments)}},{key:"sign",value:function(){var b;return(b=this.crypto).sign.apply(b,arguments)}},{key:"verify",value:function(){var b;return(b=this.crypto).verify.apply(b,arguments)}},{key:"digest",value:function(){var b;return(b=this.crypto).digest.apply(b,arguments)}},{key:"generateKey",value:function(){var b;return(b=this.crypto).generateKey.apply(b,arguments)}},{key:"deriveKey",value:function(){var b;return(b=this.crypto).deriveKey.apply(b,arguments)}},{key:"deriveBits",value:function(){var b;return(b=this.crypto).deriveBits.apply(b,arguments)}},{key:"wrapKey",value:function(){var b;return(b=this.crypto).wrapKey.apply(b,arguments)}},{key:"unwrapKey",value:function(){var b;return(b=this.crypto).unwrapKey.apply(b,arguments)}}]),a}(),Pb={name:"none",crypto:null,subtle:null};!function(){if("undefined"!=typeof self&&"crypto"in self){var b="webcrypto",c=self.crypto,d=null;"webkitSubtle"in self.crypto&&(d=self.crypto.webkitSubtle,b="safari"),"subtle"in self.crypto&&(d=self.crypto.subtle),Pb={name:b,crypto:c,subtle:new Ob({name:b,crypto:d})}}}();var _b=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.type=ia(b,"type",a.defaultValues("type")),this.value=ia(b,"value",a.defaultValues("value")),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{type:"type",value:"typeValue"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for ATTR_TYPE_AND_VALUE");this.type=d.result.type.valueBlock.toString(),this.value=d.result.typeValue}},{key:"toSchema",value:function(){return new Oa({value:[new $a({value:this.type}),this.value]})}},{key:"toJSON",value:function(){var b={type:this.type};return 0!==Object.keys(this.value).length?b.value=this.value.toJSON():b.value=this.value,b}},{key:"isEqual",value:function(c){if(c instanceof a){if(this.type!==c.type)return!1;if(this.value instanceof ab&&c.value instanceof ab||this.value instanceof cb&&c.value instanceof cb||this.value instanceof eb&&c.value instanceof eb||this.value instanceof hb&&c.value instanceof hb||this.value instanceof ib&&c.value instanceof ib||this.value instanceof jb&&c.value instanceof jb||this.value instanceof kb&&c.value instanceof kb||this.value instanceof lb&&c.value instanceof lb||this.value instanceof mb&&c.value instanceof mb||this.value instanceof nb&&c.value instanceof nb||this.value instanceof ob&&c.value instanceof ob||this.value instanceof pb&&c.value instanceof pb){var d=Wb(this.value.valueBlock.value),e=Wb(c.value.valueBlock.value);if(0!==d.localeCompare(e))return!1}else if(qa(this.value.valueBeforeDecode,c.value.valueBeforeDecode)===!1)return!1;return!0}return c instanceof ArrayBuffer&&qa(this.value.valueBeforeDecode,c)}}],[{key:"defaultValues",value:function(b){switch(b){case"type":return"";case"value":return{};default:throw new Error("Invalid member name for AttributeTypeAndValue class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[new $a({name:c.type||""}),new yb({name:c.value||""})]})}}]),a}(),ac=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.typesAndValues=ia(b,"typesAndValues",a.defaultValues("typesAndValues")),this.valueBeforeDecode=ia(b,"valueBeforeDecode",a.defaultValues("valueBeforeDecode")),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{blockName:"RDN",repeatedSet:"typesAndValues"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for RDN");"typesAndValues"in d.result&&(this.typesAndValues=Array.from(d.result.typesAndValues,function(a){return new _b({schema:a})})),this.valueBeforeDecode=d.result.RDN.valueBeforeDecode}},{key:"toSchema",value:function(){if(0===this.valueBeforeDecode.byteLength)return new Oa({value:[new Pa({value:Array.from(this.typesAndValues,function(a){return a.toSchema()})})]});var b=Cb(this.valueBeforeDecode);return b.result}},{key:"toJSON",value:function(){return{typesAndValues:Array.from(this.typesAndValues,function(a){return a.toJSON()})}}},{key:"isEqual",value:function(c){if(c instanceof a){if(this.typesAndValues.length!==c.typesAndValues.length)return!1;var d=!0,e=!1,f=void 0;try{for(var h,g=this.typesAndValues.entries()[Symbol.iterator]();!(d=(h=g.next()).done);d=!0){var i=_slicedToArray(h.value,2),j=i[0],k=i[1];if(k.isEqual(c.typesAndValues[j])===!1)return!1}}catch(a){e=!0,f=a}finally{try{!d&&g.return&&g.return()}finally{if(e)throw f}}return!0}return c instanceof ArrayBuffer&&qa(this.valueBeforeDecode,c)}}],[{key:"defaultValues",value:function(b){switch(b){case"typesAndValues":return[];case"valueBeforeDecode":return new ArrayBuffer(0);default:throw new Error("Invalid member name for RelativeDistinguishedNames class: "+b)}}},{key:"compareWithDefault",value:function(b,c){switch(b){case"typesAndValues":return 0===c.length;case"valueBeforeDecode":return 0===c.byteLength;default:throw new Error("Invalid member name for RelativeDistinguishedNames class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[new zb({name:c.repeatedSequence||"",value:new Pa({value:[new zb({name:c.repeatedSet||"",value:_b.schema(c.typeAndValue||{})})]})})]})}}]),a}(),ec=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.type=ia(b,"type",a.defaultValues("type")),this.value=ia(b,"value",a.defaultValues("value")),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{blockName:"blockName",otherName:"otherName",rfc822Name:"rfc822Name",dNSName:"dNSName",x400Address:"x400Address",directoryName:{names:{blockName:"directoryName"}},ediPartyName:"ediPartyName",uniformResourceIdentifier:"uniformResourceIdentifier",iPAddress:"iPAddress",registeredID:"registeredID"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for GENERAL_NAME");switch(this.type=d.result.blockName.idBlock.tagNumber,this.type){case 0:this.value=d.result.blockName;break;case 1:case 2:case 6:var e=d.result.blockName;e.idBlock.tagClass=1,e.idBlock.tagNumber=22;var f=e.toBER(!1);this.value=Cb(f).result.valueBlock.value;break;case 3:this.value=d.result.blockName;break;case 4:this.value=new ac({schema:d.result.directoryName});break;case 5:this.value=d.result.ediPartyName;break;case 7:this.value=new Sa({valueHex:d.result.blockName.valueBlock.valueHex});break;case 8:var g=d.result.blockName;g.idBlock.tagClass=1,g.idBlock.tagNumber=6;var h=g.toBER(!1);this.value=Cb(h).result.valueBlock.toString()}}},{key:"toSchema",value:function(){switch(this.type){case 0:case 3:case 5:return new Ja({idBlock:{tagClass:3,tagNumber:this.type},value:[this.value]});case 1:case 2:case 6:var c=new lb({value:this.value});return c.idBlock.tagClass=3,c.idBlock.tagNumber=this.type,c;case 4:return new Ja({idBlock:{tagClass:3,tagNumber:4},value:[this.value.toSchema()]});case 7:var d=this.value;return d.idBlock.tagClass=3,d.idBlock.tagNumber=this.type,d;case 8:var e=new $a({value:this.value});return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e;default:return a.schema()}}},{key:"toJSON",value:function(){var b={type:this.type};return"string"==typeof this.value?b.value=this.value:b.value=this.value.toJSON(),b}}],[{key:"defaultValues",value:function(b){switch(b){case"type":return 9;case"value":return{};default:throw new Error("Invalid member name for GeneralName class: "+b)}}},{key:"compareWithDefault",value:function(c,d){switch(c){case"type":return d===a.defaultValues(c);case"value":return 0===Object.keys(d).length;default:throw new Error("Invalid member name for GeneralName class: "+c)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new xb({value:[new Ja({idBlock:{tagClass:3,tagNumber:0},name:c.blockName||"",value:[new $a,new Ja({idBlock:{tagClass:3,tagNumber:0},value:[new yb]})]}),new Ha({name:c.blockName||"",idBlock:{tagClass:3,tagNumber:1}}),new Ha({name:c.blockName||"",idBlock:{tagClass:3,tagNumber:2}}),new Ja({idBlock:{tagClass:3,tagNumber:3},name:c.blockName||"",value:[bc(c.builtInStandardAttributes||{},!1),cc(!0),dc(!0)]}),new Ja({idBlock:{tagClass:3,tagNumber:4},name:c.blockName||"",value:[ac.schema(c.directoryName||{})]}),new Ja({idBlock:{tagClass:3,tagNumber:5},name:c.blockName||"",value:[new Ja({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new xb({value:[new jb,new ib,new eb,new ab,new cb]})]}),new Ja({idBlock:{tagClass:3,tagNumber:1},value:[new xb({value:[new jb,new ib,new eb,new ab,new cb]})]})]}),new Ha({name:c.blockName||"",idBlock:{tagClass:3,tagNumber:6}}),new Ha({name:c.blockName||"",idBlock:{tagClass:3,tagNumber:7}}),new Ha({name:c.blockName||"",idBlock:{tagClass:3,tagNumber:8}})]})}}]),a}(),fc=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};
_classCallCheck(this,a),this.accessMethod=ia(b,"accessMethod",a.defaultValues("accessMethod")),this.accessLocation=ia(b,"accessLocation",a.defaultValues("accessLocation")),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{accessMethod:"accessMethod",accessLocation:{names:{blockName:"accessLocation"}}}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for AccessDescription");this.accessMethod=d.result.accessMethod.valueBlock.toString(),this.accessLocation=new ec({schema:d.result.accessLocation})}},{key:"toSchema",value:function(){return new Oa({value:[new $a({value:this.accessMethod}),this.accessLocation.toSchema()]})}},{key:"toJSON",value:function(){return{accessMethod:this.accessMethod,accessLocation:this.accessLocation.toJSON()}}}],[{key:"defaultValues",value:function(b){switch(b){case"accessMethod":return"";case"accessLocation":return new ec;default:throw new Error("Invalid member name for AccessDescription class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[new $a({name:c.accessMethod||""}),ec.schema(c.accessLocation||{})]})}}]),a}(),gc=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.altNames=ia(b,"altNames",a.defaultValues("altNames")),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{altNames:"altNames"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for AltName");"altNames"in d.result&&(this.altNames=Array.from(d.result.altNames,function(a){return new ec({schema:a})}))}},{key:"toSchema",value:function(){return new Oa({value:Array.from(this.altNames,function(a){return a.toSchema()})})}},{key:"toJSON",value:function(){return{altNames:Array.from(this.altNames,function(a){return a.toJSON()})}}}],[{key:"defaultValues",value:function(b){switch(b){case"altNames":return[];default:throw new Error("Invalid member name for AltName class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[new zb({name:c.altNames||"",value:ec.schema()})]})}}]),a}(),hc=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.type=ia(b,"type",a.defaultValues("type")),this.value=ia(b,"value",a.defaultValues("value")),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{utcTimeName:"utcTimeName",generalTimeName:"generalTimeName"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for TIME");"utcTimeName"in d.result&&(this.type=0,this.value=d.result.utcTimeName.toDate()),"generalTimeName"in d.result&&(this.type=1,this.value=d.result.generalTimeName.toDate())}},{key:"toSchema",value:function(){var b={};return 0===this.type&&(b=new qb({valueDate:this.value})),1===this.type&&(b=new rb({valueDate:this.value})),b}},{key:"toJSON",value:function(){return{type:this.type,value:this.value}}}],[{key:"defaultValues",value:function(b){switch(b){case"type":return 0;case"value":return new Date(0,0,0);default:throw new Error("Invalid member name for Time class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],d=ia(b,"names",{});return new xb({optional:c,value:[new qb({name:d.utcTimeName||""}),new rb({name:d.generalTimeName||""})]})}}]),a}(),ic=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.attributes=ia(b,"attributes",a.defaultValues("attributes")),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{attributes:"attributes"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for SubjectDirectoryAttributes");this.attributes=Array.from(d.result.attributes,function(a){return new Jb({schema:a})})}},{key:"toSchema",value:function(){return new Oa({value:Array.from(this.attributes,function(a){return a.toSchema()})})}},{key:"toJSON",value:function(){return{attributes:Array.from(this.attributes,function(a){return a.toJSON()})}}}],[{key:"defaultValues",value:function(b){switch(b){case"attributes":return[];default:throw new Error("Invalid member name for SubjectDirectoryAttributes class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[new zb({name:c.attributes||"",value:Jb.schema()})]})}}]),a}(),jc=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),"notBefore"in b&&(this.notBefore=ia(b,"notBefore",a.defaultValues("notBefore"))),"notAfter"in b&&(this.notAfter=ia(b,"notAfter",a.defaultValues("notAfter"))),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{notBefore:"notBefore",notAfter:"notAfter"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for PrivateKeyUsagePeriod");if("notBefore"in d.result){var e=new rb;e.fromBuffer(d.result.notBefore.valueBlock.valueHex),this.notBefore=e.toDate()}if("notAfter"in d.result){var f=new rb({valueHex:d.result.notAfter.valueBlock.valueHex});f.fromBuffer(d.result.notAfter.valueBlock.valueHex),this.notAfter=f.toDate()}}},{key:"toSchema",value:function(){var b=[];return"notBefore"in this&&b.push(new Ha({idBlock:{tagClass:3,tagNumber:0},valueHex:new rb({valueDate:this.notBefore}).valueBlock.valueHex})),"notAfter"in this&&b.push(new Ha({idBlock:{tagClass:3,tagNumber:1},valueHex:new rb({valueDate:this.notAfter}).valueBlock.valueHex})),new Oa({value:b})}},{key:"toJSON",value:function(){var b={};return"notBefore"in this&&(b.notBefore=this.notBefore),"notAfter"in this&&(b.notAfter=this.notAfter),b}}],[{key:"defaultValues",value:function(b){switch(b){case"notBefore":return new Date;case"notAfter":return new Date;default:throw new Error("Invalid member name for PrivateKeyUsagePeriod class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[new Ha({name:c.notBefore||"",optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new Ha({name:c.notAfter||"",optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}}]),a}(),kc=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.cA=ia(b,"cA",!1),"pathLenConstraint"in b&&(this.pathLenConstraint=ia(b,"pathLenConstraint",0)),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{cA:"cA",pathLenConstraint:"pathLenConstraint"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for BasicConstraints");"cA"in d.result&&(this.cA=d.result.cA.valueBlock.value),"pathLenConstraint"in d.result&&(d.result.pathLenConstraint.valueBlock.isHexOnly?this.pathLenConstraint=d.result.pathLenConstraint:this.pathLenConstraint=d.result.pathLenConstraint.valueBlock.valueDec)}},{key:"toSchema",value:function(){var c=[];return this.cA!==a.defaultValues("cA")&&c.push(new Na({value:this.cA})),"pathLenConstraint"in this&&(this.pathLenConstraint instanceof Wa?c.push(this.pathLenConstraint):c.push(new Wa({value:this.pathLenConstraint}))),new Oa({value:c})}},{key:"toJSON",value:function(){var c={};return this.cA!==a.defaultValues("cA")&&(c.cA=this.cA),"pathLenConstraint"in this&&(this.pathLenConstraint instanceof Wa?c.pathLenConstraint=this.pathLenConstraint.toJSON():c.pathLenConstraint=this.pathLenConstraint),c}}],[{key:"defaultValues",value:function(b){switch(b){case"cA":return!1;default:throw new Error("Invalid member name for BasicConstraints class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[new Na({optional:!0,name:c.cA||""}),new Wa({optional:!0,name:c.pathLenConstraint||""})]})}}]),a}(),lc=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),"distributionPoint"in b&&(this.distributionPoint=ia(b,"distributionPoint",a.defaultValues("distributionPoint"))),this.onlyContainsUserCerts=ia(b,"onlyContainsUserCerts",a.defaultValues("onlyContainsUserCerts")),this.onlyContainsCACerts=ia(b,"onlyContainsCACerts",a.defaultValues("onlyContainsCACerts")),"onlySomeReasons"in b&&(this.onlySomeReasons=ia(b,"onlySomeReasons",a.defaultValues("onlySomeReasons"))),this.indirectCRL=ia(b,"indirectCRL",a.defaultValues("indirectCRL")),this.onlyContainsAttributeCerts=ia(b,"onlyContainsAttributeCerts",a.defaultValues("onlyContainsAttributeCerts")),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{distributionPoint:"distributionPoint",distributionPointNames:"distributionPointNames",onlyContainsUserCerts:"onlyContainsUserCerts",onlyContainsCACerts:"onlyContainsCACerts",onlySomeReasons:"onlySomeReasons",indirectCRL:"indirectCRL",onlyContainsAttributeCerts:"onlyContainsAttributeCerts"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for IssuingDistributionPoint");if("distributionPoint"in d.result)switch(!0){case 0===d.result.distributionPoint.idBlock.tagNumber:this.distributionPoint=Array.from(d.result.distributionPointNames,function(a){return new ec({schema:a})});break;case 1===d.result.distributionPoint.idBlock.tagNumber:d.result.distributionPoint.idBlock.tagClass=1,d.result.distributionPoint.idBlock.tagNumber=16,this.distributionPoint=new ac({schema:d.result.distributionPoint});break;default:throw new Error("Unknown tagNumber for distributionPoint: {$asn1.result.distributionPoint.idBlock.tagNumber}")}if("onlyContainsUserCerts"in d.result){var e=new Uint8Array(d.result.onlyContainsUserCerts.valueBlock.valueHex);this.onlyContainsUserCerts=0!==e[0]}if("onlyContainsCACerts"in d.result){var f=new Uint8Array(d.result.onlyContainsCACerts.valueBlock.valueHex);this.onlyContainsCACerts=0!==f[0]}if("onlySomeReasons"in d.result){var g=new Uint8Array(d.result.onlySomeReasons.valueBlock.valueHex);this.onlySomeReasons=g[0]}if("indirectCRL"in d.result){var h=new Uint8Array(d.result.indirectCRL.valueBlock.valueHex);this.indirectCRL=0!==h[0]}if("onlyContainsAttributeCerts"in d.result){var i=new Uint8Array(d.result.onlyContainsAttributeCerts.valueBlock.valueHex);this.onlyContainsAttributeCerts=0!==i[0]}}},{key:"toSchema",value:function(){var c=[];if("distributionPoint"in this){var d=void 0;this.distributionPoint instanceof Array?d=new Ja({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.distributionPoint,function(a){return a.toSchema()})}):(d=this.distributionPoint.toSchema(),d.idBlock.tagClass=3,d.idBlock.tagNumber=1),c.push(d)}if(this.onlyContainsUserCerts!==a.defaultValues("onlyContainsUserCerts")&&c.push(new Ha({idBlock:{tagClass:3,tagNumber:1},valueHex:new Uint8Array([255]).buffer})),this.onlyContainsCACerts!==a.defaultValues("onlyContainsCACerts")&&c.push(new Ha({idBlock:{tagClass:3,tagNumber:2},valueHex:new Uint8Array([255]).buffer})),"onlySomeReasons"in this){var e=new ArrayBuffer(1),f=new Uint8Array(e);f[0]=this.onlySomeReasons,c.push(new Ha({idBlock:{tagClass:3,tagNumber:3},valueHex:e}))}return this.indirectCRL!==a.defaultValues("indirectCRL")&&c.push(new Ha({idBlock:{tagClass:3,tagNumber:4},valueHex:new Uint8Array([255]).buffer})),this.onlyContainsAttributeCerts!==a.defaultValues("onlyContainsAttributeCerts")&&c.push(new Ha({idBlock:{tagClass:3,tagNumber:5},valueHex:new Uint8Array([255]).buffer})),new Oa({value:c})}},{key:"toJSON",value:function(){var c={};return"distributionPoint"in this&&(this.distributionPoint instanceof Array?c.distributionPoint=Array.from(this.distributionPoint,function(a){return a.toJSON()}):c.distributionPoint=this.distributionPoint.toJSON()),this.onlyContainsUserCerts!==a.defaultValues("onlyContainsUserCerts")&&(c.onlyContainsUserCerts=this.onlyContainsUserCerts),this.onlyContainsCACerts!==a.defaultValues("onlyContainsCACerts")&&(c.onlyContainsCACerts=this.onlyContainsCACerts),"onlySomeReasons"in this&&(c.onlySomeReasons=this.onlySomeReasons),this.indirectCRL!==a.defaultValues("indirectCRL")&&(c.indirectCRL=this.indirectCRL),this.onlyContainsAttributeCerts!==a.defaultValues("onlyContainsAttributeCerts")&&(c.onlyContainsAttributeCerts=this.onlyContainsAttributeCerts),c}}],[{key:"defaultValues",value:function(b){switch(b){case"distributionPoint":return[];case"onlyContainsUserCerts":return!1;case"onlyContainsCACerts":return!1;case"onlySomeReasons":return 0;case"indirectCRL":return!1;case"onlyContainsAttributeCerts":return!1;default:throw new Error("Invalid member name for IssuingDistributionPoint class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[new Ja({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new xb({value:[new Ja({name:c.distributionPoint||"",idBlock:{tagClass:3,tagNumber:0},value:[new zb({name:c.distributionPointNames||"",value:ec.schema()})]}),new Ja({name:c.distributionPoint||"",idBlock:{tagClass:3,tagNumber:1},value:ac.schema().valueBlock.value})]})]}),new Ha({name:c.onlyContainsUserCerts||"",optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new Ha({name:c.onlyContainsCACerts||"",optional:!0,idBlock:{tagClass:3,tagNumber:2}}),new Ha({name:c.onlySomeReasons||"",optional:!0,idBlock:{tagClass:3,tagNumber:3}}),new Ha({name:c.indirectCRL||"",optional:!0,idBlock:{tagClass:3,tagNumber:4}}),new Ha({name:c.onlyContainsAttributeCerts||"",optional:!0,idBlock:{tagClass:3,tagNumber:5}})]})}}]),a}(),mc=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.names=ia(b,"names",a.defaultValues("names")),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema());if(d.verified===!1)throw new Error("Object's schema was not verified against input data for GeneralNames");this.names=Array.from(d.result.names,function(a){return new ec({schema:a})})}},{key:"toSchema",value:function(){return new Oa({value:Array.from(this.names,function(a){return a.toSchema()})})}},{key:"toJSON",value:function(){return{names:Array.from(this.names,function(a){return a.toJSON()})}}}],[{key:"defaultValues",value:function(b){switch(b){case"names":return[];default:throw new Error("Invalid member name for GeneralNames class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({value:[new zb({name:c.blockName||"names",value:ec.schema()})]})}}]),a}(),nc=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.base=ia(b,"base",a.defaultValues("base")),this.minimum=ia(b,"minimum",a.defaultValues("minimum")),"maximum"in b&&(this.maximum=ia(b,"maximum",a.defaultValues("maximum"))),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{base:{names:{blockName:"base"}},minimum:"minimum",maximum:"maximum"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for ");this.base=new ec({schema:d.result.base}),"minimum"in d.result&&(d.result.minimum.valueBlock.isHexOnly?this.minimum=d.result.minimum:this.minimum=d.result.minimum.valueBlock.valueDec),"maximum"in d.result&&(d.result.maximum.valueBlock.isHexOnly?this.maximum=d.result.maximum:this.maximum=d.result.maximum.valueBlock.valueDec)}},{key:"toSchema",value:function(){var b=[];if(b.push(this.base.toSchema()),0!==this.minimum){var c=0;c=this.minimum instanceof Wa?this.minimum:new Wa({value:this.minimum}),b.push(new Ja({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[c]}))}if("maximum"in this){var d=0;d=this.maximum instanceof Wa?this.maximum:new Wa({value:this.maximum}),b.push(new Ja({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[d]}))}return new Oa({value:b})}},{key:"toJSON",value:function(){var b={base:this.base.toJSON()};return 0!==this.minimum&&("number"==typeof this.minimum?b.minimum=this.minimum:b.minimum=this.minimum.toJSON()),"maximum"in this&&("number"==typeof this.maximum?b.maximum=this.maximum:b.maximum=this.maximum.toJSON()),b}}],[{key:"defaultValues",value:function(b){switch(b){case"base":return new ec;case"minimum":return 0;case"maximum":return 0;default:throw new Error("Invalid member name for GeneralSubtree class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[ec.schema(c.base||{}),new Ja({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Wa({name:c.minimum||""})]}),new Ja({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new Wa({name:c.maximum||""})]})]})}}]),a}(),oc=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),"permittedSubtrees"in b&&(this.permittedSubtrees=ia(b,"permittedSubtrees",a.defaultValues("permittedSubtrees"))),"excludedSubtrees"in b&&(this.excludedSubtrees=ia(b,"excludedSubtrees",a.defaultValues("excludedSubtrees"))),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{permittedSubtrees:"permittedSubtrees",excludedSubtrees:"excludedSubtrees"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for NameConstraints");"permittedSubtrees"in d.result&&(this.permittedSubtrees=Array.from(d.result.permittedSubtrees,function(a){return new nc({schema:a})})),"excludedSubtrees"in d.result&&(this.excludedSubtrees=Array.from(d.result.excludedSubtrees,function(a){return new nc({schema:a})}))}},{key:"toSchema",value:function(){var b=[];return"permittedSubtrees"in this&&b.push(new Ja({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Oa({value:Array.from(this.permittedSubtrees,function(a){return a.toSchema()})})]})),"excludedSubtrees"in this&&b.push(new Ja({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new Oa({value:Array.from(this.excludedSubtrees,function(a){return a.toSchema()})})]})),new Oa({value:b})}},{key:"toJSON",value:function(){var b={};return"permittedSubtrees"in this&&(b.permittedSubtrees=Array.from(this.permittedSubtrees,function(a){return a.toJSON()})),"excludedSubtrees"in this&&(b.excludedSubtrees=Array.from(this.excludedSubtrees,function(a){return a.toJSON()})),b}}],[{key:"defaultValues",value:function(b){switch(b){case"permittedSubtrees":return[];case"excludedSubtrees":return[];default:throw new Error("Invalid member name for NameConstraints class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[new Ja({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new zb({name:c.permittedSubtrees||"",value:nc.schema()})]}),new Ja({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new zb({name:c.excludedSubtrees||"",value:nc.schema()})]})]})}}]),a}(),pc=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),"distributionPoint"in b&&(this.distributionPoint=ia(b,"distributionPoint",a.defaultValues("distributionPoint"))),"reasons"in b&&(this.reasons=ia(b,"reasons",a.defaultValues("reasons"))),"cRLIssuer"in b&&(this.cRLIssuer=ia(b,"cRLIssuer",a.defaultValues("cRLIssuer"))),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{distributionPoint:"distributionPoint",distributionPointNames:"distributionPointNames",reasons:"reasons",cRLIssuer:"cRLIssuer",cRLIssuerNames:"cRLIssuerNames"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for DistributionPoint");"distributionPoint"in d.result&&(0===d.result.distributionPoint.idBlock.tagNumber&&(this.distributionPoint=Array.from(d.result.distributionPointNames,function(a){return new ec({schema:a})})),1===d.result.distributionPoint.idBlock.tagNumber&&(d.result.distributionPoint.idBlock.tagClass=1,d.result.distributionPoint.idBlock.tagNumber=16,this.distributionPoint=new ac({schema:d.result.distributionPoint}))),"reasons"in d.result&&(this.reasons=new Ua({valueHex:d.result.reasons.valueBlock.valueHex})),"cRLIssuer"in d.result&&(this.cRLIssuer=Array.from(d.result.cRLIssuerNames,function(a){return new ec({schema:a})}))}},{key:"toSchema",value:function(){var b=[];if("distributionPoint"in this){var c=void 0;c=new Ja(this.distributionPoint instanceof Array?{idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.distributionPoint,function(a){return a.toSchema()})}:{idBlock:{tagClass:3,tagNumber:1},value:[this.distributionPoint.toSchema()]}),b.push(new Ja({idBlock:{tagClass:3,tagNumber:0},value:[c]}))}return"reasons"in this&&b.push(new Ha({idBlock:{tagClass:3,tagNumber:1},valueHex:this.reasons.valueBlock.valueHex})),"cRLIssuer"in this&&b.push(new Ja({idBlock:{tagClass:3,tagNumber:2},value:Array.from(this.cRLIssuer,function(a){return a.toSchema()})})),new Oa({value:b})}},{key:"toJSON",value:function(){var b={};return"distributionPoint"in this&&(this.distributionPoint instanceof Array?b.distributionPoint=Array.from(this.distributionPoint,function(a){return a.toJSON()}):b.distributionPoint=this.distributionPoint.toJSON()),"reasons"in this&&(b.reasons=this.reasons.toJSON()),"cRLIssuer"in this&&(b.cRLIssuer=Array.from(this.cRLIssuer,function(a){return a.toJSON()})),b}}],[{key:"defaultValues",value:function(b){switch(b){case"distributionPoint":return[];case"reasons":return new Ua;case"cRLIssuer":return[];default:throw new Error("Invalid member name for DistributionPoint class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[new Ja({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new xb({value:[new Ja({name:c.distributionPoint||"",optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new zb({name:c.distributionPointNames||"",value:ec.schema()})]}),new Ja({name:c.distributionPoint||"",optional:!0,idBlock:{tagClass:3,tagNumber:1},value:ac.schema().valueBlock.value})]})]}),new Ha({name:c.reasons||"",optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new Ja({name:c.cRLIssuer||"",optional:!0,idBlock:{tagClass:3,tagNumber:2},value:[new zb({name:c.cRLIssuerNames||"",value:ec.schema()})]})]})}}]),a}(),qc=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.distributionPoints=ia(b,"distributionPoints",a.defaultValues("distributionPoints")),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{distributionPoints:"distributionPoints"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for CRLDistributionPoints");this.distributionPoints=Array.from(d.result.distributionPoints,function(a){return new pc({schema:a})})}},{key:"toSchema",value:function(){return new Oa({value:Array.from(this.distributionPoints,function(a){return a.toSchema()})})}},{key:"toJSON",value:function(){return{distributionPoints:Array.from(this.distributionPoints,function(a){return a.toJSON()})}}}],[{key:"defaultValues",value:function(b){switch(b){case"distributionPoints":return[];default:throw new Error("Invalid member name for CRLDistributionPoints class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[new zb({name:c.distributionPoints||"",value:pc.schema()})]})}}]),a}(),rc=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.policyQualifierId=ia(b,"policyQualifierId",a.defaultValues("policyQualifierId")),this.qualifier=ia(b,"qualifier",a.defaultValues("qualifier")),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{policyQualifierId:"policyQualifierId",qualifier:"qualifier"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for PolicyQualifierInfo");this.policyQualifierId=d.result.policyQualifierId.valueBlock.toString(),this.qualifier=d.result.qualifier}},{key:"toSchema",value:function(){return new Oa({value:[new $a({value:this.policyQualifierId}),this.qualifier]})}},{key:"toJSON",value:function(){return{policyQualifierId:this.policyQualifierId,qualifier:this.qualifier.toJSON()}}}],[{key:"defaultValues",value:function(b){switch(b){case"policyQualifierId":return"";case"qualifier":return new yb;default:throw new Error("Invalid member name for PolicyQualifierInfo class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[new $a({name:c.policyQualifierId||""}),new yb({name:c.qualifier||""})]})}}]),a}(),sc=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.policyIdentifier=ia(b,"policyIdentifier",a.defaultValues("policyIdentifier")),"policyQualifiers"in b&&(this.policyQualifiers=ia(b,"policyQualifiers",a.defaultValues("policyQualifiers"))),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{policyIdentifier:"policyIdentifier",policyQualifiers:"policyQualifiers"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for PolicyInformation");this.policyIdentifier=d.result.policyIdentifier.valueBlock.toString(),"policyQualifiers"in d.result&&(this.policyQualifiers=Array.from(d.result.policyQualifiers,function(a){return new rc({schema:a})}))}},{key:"toSchema",value:function(){var b=[];return b.push(new $a({value:this.policyIdentifier})),"policyQualifiers"in this&&b.push(new Oa({value:Array.from(this.policyQualifiers,function(a){return a.toSchema()})})),new Oa({value:b})}},{key:"toJSON",value:function(){var b={policyIdentifier:this.policyIdentifier};return"policyQualifiers"in this&&(b.policyQualifiers=Array.from(this.policyQualifiers,function(a){return a.toJSON()})),b}}],[{key:"defaultValues",value:function(b){switch(b){case"policyIdentifier":return"";case"policyQualifiers":return[];default:throw new Error("Invalid member name for PolicyInformation class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[new $a({name:c.policyIdentifier||""}),new Oa({optional:!0,value:[new zb({name:c.policyQualifiers||"",value:rc.schema()})]})]})}}]),a}(),tc=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.certificatePolicies=ia(b,"certificatePolicies",a.defaultValues("certificatePolicies")),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{certificatePolicies:"certificatePolicies"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for CertificatePolicies");this.certificatePolicies=Array.from(d.result.certificatePolicies,function(a){return new sc({schema:a})})}},{key:"toSchema",value:function(){return new Oa({value:Array.from(this.certificatePolicies,function(a){return a.toSchema()})})}},{key:"toJSON",value:function(){return{certificatePolicies:Array.from(this.certificatePolicies,function(a){return a.toJSON()})}}}],[{key:"defaultValues",value:function(b){switch(b){case"certificatePolicies":return[];default:throw new Error("Invalid member name for CertificatePolicies class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[new zb({name:c.certificatePolicies||"",value:sc.schema()})]})}}]),a}(),uc=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.issuerDomainPolicy=ia(b,"issuerDomainPolicy",a.defaultValues("issuerDomainPolicy")),this.subjectDomainPolicy=ia(b,"subjectDomainPolicy",a.defaultValues("subjectDomainPolicy")),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{issuerDomainPolicy:"issuerDomainPolicy",subjectDomainPolicy:"subjectDomainPolicy"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for PolicyMapping");this.issuerDomainPolicy=d.result.issuerDomainPolicy.valueBlock.toString(),this.subjectDomainPolicy=d.result.subjectDomainPolicy.valueBlock.toString()}},{key:"toSchema",value:function(){return new Oa({value:[new $a({value:this.issuerDomainPolicy}),new $a({value:this.subjectDomainPolicy})]})}},{key:"toJSON",value:function(){return{issuerDomainPolicy:this.issuerDomainPolicy,subjectDomainPolicy:this.subjectDomainPolicy}}}],[{key:"defaultValues",value:function(b){switch(b){case"issuerDomainPolicy":return"";case"subjectDomainPolicy":return"";default:throw new Error("Invalid member name for PolicyMapping class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[new $a({name:c.issuerDomainPolicy||""}),new $a({name:c.subjectDomainPolicy||""})]})}}]),a}(),vc=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.mappings=ia(b,"mappings",a.defaultValues("mappings")),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{mappings:"mappings"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for PolicyMappings");this.mappings=Array.from(d.result.mappings,function(a){return new uc({schema:a})})}},{key:"toSchema",value:function(){return new Oa({value:Array.from(this.mappings,function(a){return a.toSchema()})})}},{key:"toJSON",value:function(){return{mappings:Array.from(this.mappings,function(a){return a.toJSON()})}}}],[{key:"defaultValues",value:function(b){switch(b){case"mappings":return[];default:throw new Error("Invalid member name for PolicyMappings class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[new zb({name:c.mappings||"",value:uc.schema()})]})}}]),a}(),wc=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),"keyIdentifier"in b&&(this.keyIdentifier=ia(b,"keyIdentifier",a.defaultValues("keyIdentifier"))),"authorityCertIssuer"in b&&(this.authorityCertIssuer=ia(b,"authorityCertIssuer",a.defaultValues("authorityCertIssuer"))),"authorityCertSerialNumber"in b&&(this.authorityCertSerialNumber=ia(b,"authorityCertSerialNumber",a.defaultValues("authorityCertSerialNumber"))),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{keyIdentifier:"keyIdentifier",authorityCertIssuer:"authorityCertIssuer",
authorityCertSerialNumber:"authorityCertSerialNumber"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for AuthorityKeyIdentifier");"keyIdentifier"in d.result&&(d.result.keyIdentifier.idBlock.tagClass=1,d.result.keyIdentifier.idBlock.tagNumber=4,this.keyIdentifier=d.result.keyIdentifier),"authorityCertIssuer"in d.result&&(this.authorityCertIssuer=Array.from(d.result.authorityCertIssuer,function(a){return new ec({schema:a})})),"authorityCertSerialNumber"in d.result&&(d.result.authorityCertSerialNumber.idBlock.tagClass=1,d.result.authorityCertSerialNumber.idBlock.tagNumber=2,this.authorityCertSerialNumber=d.result.authorityCertSerialNumber)}},{key:"toSchema",value:function(){var b=[];if("keyIdentifier"in this){var c=this.keyIdentifier;c.idBlock.tagClass=3,c.idBlock.tagNumber=0,b.push(c)}if("authorityCertIssuer"in this&&b.push(new Ja({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new Oa({value:Array.from(this.authorityCertIssuer,function(a){return a.toSchema()})})]})),"authorityCertSerialNumber"in this){var d=this.authorityCertSerialNumber;d.idBlock.tagClass=3,d.idBlock.tagNumber=2,b.push(d)}return new Oa({value:b})}},{key:"toJSON",value:function(){var b={};return"keyIdentifier"in this&&(b.keyIdentifier=this.keyIdentifier.toJSON()),"authorityCertIssuer"in this&&(b.authorityCertIssuer=Array.from(this.authorityCertIssuer,function(a){return a.toJSON()})),"authorityCertSerialNumber"in this&&(b.authorityCertSerialNumber=this.authorityCertSerialNumber.toJSON()),b}}],[{key:"defaultValues",value:function(b){switch(b){case"keyIdentifier":return new Sa;case"authorityCertIssuer":return[];case"authorityCertSerialNumber":return new Wa;default:throw new Error("Invalid member name for AuthorityKeyIdentifier class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[new Ha({name:c.keyIdentifier||"",optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new Ja({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new zb({name:c.authorityCertIssuer||"",value:ec.schema()})]}),new Ha({name:c.authorityCertSerialNumber||"",optional:!0,idBlock:{tagClass:3,tagNumber:2}})]})}}]),a}(),xc=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),"requireExplicitPolicy"in b&&(this.requireExplicitPolicy=ia(b,"requireExplicitPolicy",a.defaultValues("requireExplicitPolicy"))),"inhibitPolicyMapping"in b&&(this.inhibitPolicyMapping=ia(b,"inhibitPolicyMapping",a.defaultValues("inhibitPolicyMapping"))),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{requireExplicitPolicy:"requireExplicitPolicy",inhibitPolicyMapping:"inhibitPolicyMapping"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for PolicyConstraints");if("requireExplicitPolicy"in d.result){var e=d.result.requireExplicitPolicy;e.idBlock.tagClass=1,e.idBlock.tagNumber=2;var f=e.toBER(!1),g=Cb(f);this.requireExplicitPolicy=g.result.valueBlock.valueDec}if("inhibitPolicyMapping"in d.result){var h=d.result.inhibitPolicyMapping;h.idBlock.tagClass=1,h.idBlock.tagNumber=2;var i=h.toBER(!1),j=Cb(i);this.inhibitPolicyMapping=j.result.valueBlock.valueDec}}},{key:"toSchema",value:function(){var b=[];if("requireExplicitPolicy"in this){var c=new Wa({value:this.requireExplicitPolicy});c.idBlock.tagClass=3,c.idBlock.tagNumber=0,b.push(c)}if("inhibitPolicyMapping"in this){var d=new Wa({value:this.inhibitPolicyMapping});d.idBlock.tagClass=3,d.idBlock.tagNumber=1,b.push(d)}return new Oa({value:b})}},{key:"toJSON",value:function(){var b={};return"requireExplicitPolicy"in this&&(b.requireExplicitPolicy=this.requireExplicitPolicy),"inhibitPolicyMapping"in this&&(b.inhibitPolicyMapping=this.inhibitPolicyMapping),b}}],[{key:"defaultValues",value:function(b){switch(b){case"requireExplicitPolicy":return 0;case"inhibitPolicyMapping":return 0;default:throw new Error("Invalid member name for PolicyConstraints class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[new Ha({name:c.requireExplicitPolicy||"",optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new Ha({name:c.inhibitPolicyMapping||"",optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}}]),a}(),yc=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.keyPurposes=ia(b,"keyPurposes",a.defaultValues("keyPurposes")),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{keyPurposes:"keyPurposes"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for ExtKeyUsage");this.keyPurposes=Array.from(d.result.keyPurposes,function(a){return a.valueBlock.toString()})}},{key:"toSchema",value:function(){return new Oa({value:Array.from(this.keyPurposes,function(a){return new $a({value:a})})})}},{key:"toJSON",value:function(){return{keyPurposes:Array.from(this.keyPurposes)}}}],[{key:"defaultValues",value:function(b){switch(b){case"keyPurposes":return[];default:throw new Error("Invalid member name for ExtKeyUsage class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[new zb({name:c.keyPurposes||"",value:new $a})]})}}]),a}(),zc=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.accessDescriptions=ia(b,"accessDescriptions",a.defaultValues("accessDescriptions")),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{accessDescriptions:"accessDescriptions"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for InfoAccess");this.accessDescriptions=Array.from(d.result.accessDescriptions,function(a){return new fc({schema:a})})}},{key:"toSchema",value:function(){return new Oa({value:Array.from(this.accessDescriptions,function(a){return a.toSchema()})})}},{key:"toJSON",value:function(){return{accessDescriptions:Array.from(this.accessDescriptions,function(a){return a.toJSON()})}}}],[{key:"defaultValues",value:function(b){switch(b){case"accessDescriptions":return[];default:throw new Error("Invalid member name for InfoAccess class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[new zb({name:c.accessDescriptions||"",value:fc.schema()})]})}}]),a}(),Ac=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.extnID=ia(b,"extnID",a.defaultValues("extnID")),this.critical=ia(b,"critical",a.defaultValues("critical")),"extnValue"in b?this.extnValue=new Sa({valueHex:b.extnValue}):this.extnValue=a.defaultValues("extnValue"),"parsedValue"in b&&(this.parsedValue=ia(b,"parsedValue",a.defaultValues("parsedValue"))),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{extnID:"extnID",critical:"critical",extnValue:"extnValue"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for EXTENSION");if(this.extnID=d.result.extnID.valueBlock.toString(),"critical"in d.result&&(this.critical=d.result.critical.valueBlock.value),this.extnValue=d.result.extnValue,d=Cb(this.extnValue.valueBlock.valueHex),d.offset!==-1)switch(this.extnID){case"2.5.29.9":this.parsedValue=new ic({schema:d.result});break;case"2.5.29.14":this.parsedValue=d.result;break;case"2.5.29.15":this.parsedValue=d.result;break;case"2.5.29.16":this.parsedValue=new jc({schema:d.result});break;case"2.5.29.17":case"2.5.29.18":this.parsedValue=new gc({schema:d.result});break;case"2.5.29.19":this.parsedValue=new kc({schema:d.result});break;case"2.5.29.20":case"2.5.29.27":this.parsedValue=d.result;break;case"2.5.29.21":this.parsedValue=d.result;break;case"2.5.29.24":this.parsedValue=d.result;break;case"2.5.29.28":this.parsedValue=new lc({schema:d.result});break;case"2.5.29.29":this.parsedValue=new mc({schema:d.result});break;case"2.5.29.30":this.parsedValue=new oc({schema:d.result});break;case"2.5.29.31":case"2.5.29.46":this.parsedValue=new qc({schema:d.result});break;case"2.5.29.32":this.parsedValue=new tc({schema:d.result});break;case"2.5.29.33":this.parsedValue=new vc({schema:d.result});break;case"2.5.29.35":this.parsedValue=new wc({schema:d.result});break;case"2.5.29.36":this.parsedValue=new xc({schema:d.result});break;case"2.5.29.37":this.parsedValue=new yc({schema:d.result});break;case"2.5.29.54":this.parsedValue=d.result;break;case"1.3.6.1.5.5.7.1.1":case"1.3.6.1.5.5.7.1.11":this.parsedValue=new zc({schema:d.result})}}},{key:"toSchema",value:function(){var c=[];return c.push(new $a({value:this.extnID})),this.critical!==a.defaultValues("critical")&&c.push(new Na({value:this.critical})),c.push(this.extnValue),new Oa({value:c})}},{key:"toJSON",value:function(){var c={extnID:this.extnID,extnValue:this.extnValue.toJSON()};return this.critical!==a.defaultValues("critical")&&(c.critical=this.critical),"parsedValue"in this&&(c.parsedValue=this.parsedValue.toJSON()),c}}],[{key:"defaultValues",value:function(b){switch(b){case"extnID":return"";case"critical":return!1;case"extnValue":return new Sa;case"parsedValue":return{};default:throw new Error("Invalid member name for Extension class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[new $a({name:c.extnID||""}),new Na({name:c.critical||"",optional:!0}),new Sa({name:c.extnValue||""})]})}}]),a}(),Bc=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.extensions=ia(b,"extensions",a.defaultValues("extensions")),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{extensions:"extensions"}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for EXTENSIONS");this.extensions=Array.from(d.result.extensions,function(a){return new Ac({schema:a})})}},{key:"toSchema",value:function(){return new Oa({value:Array.from(this.extensions,function(a){return a.toSchema()})})}},{key:"toJSON",value:function(){return{extensions:Array.from(this.extensions,function(a){return a.toJSON()})}}}],[{key:"defaultValues",value:function(b){switch(b){case"extensions":return[];default:throw new Error("Invalid member name for Extensions class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],d=ia(b,"names",{});return new Oa({optional:c,name:d.blockName||"",value:[new zb({name:d.extensions||"",value:Ac.schema(d.extension||{})})]})}}]),a}(),Dc=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this.tbs=ia(b,"tbs",a.defaultValues("tbs")),this.version=ia(b,"version",a.defaultValues("version")),this.serialNumber=ia(b,"serialNumber",a.defaultValues("serialNumber")),this.signature=ia(b,"signature",a.defaultValues("signature")),this.issuer=ia(b,"issuer",a.defaultValues("issuer")),this.notBefore=ia(b,"notBefore",a.defaultValues("notBefore")),this.notAfter=ia(b,"notAfter",a.defaultValues("notAfter")),this.subject=ia(b,"subject",a.defaultValues("subject")),this.subjectPublicKeyInfo=ia(b,"subjectPublicKeyInfo",a.defaultValues("subjectPublicKeyInfo")),"issuerUniqueID"in b&&(this.issuerUniqueID=ia(b,"issuerUniqueID",a.defaultValues("issuerUniqueID"))),"subjectUniqueID"in b&&(this.subjectUniqueID=ia(b,"subjectUniqueID",a.defaultValues("subjectUniqueID"))),"extensions"in b&&(this.extensions=ia(b,"extensions",a.defaultValues("extensions"))),this.signatureAlgorithm=ia(b,"signatureAlgorithm",a.defaultValues("signatureAlgorithm")),this.signatureValue=ia(b,"signatureValue",a.defaultValues("signatureValue")),"schema"in b&&this.fromSchema(b.schema)}return _createClass(a,[{key:"fromSchema",value:function(c){var d=Db(c,c,a.schema({names:{tbsCertificate:{names:{extensions:{names:{extensions:"tbsCertificate.extensions"}}}}}}));if(d.verified===!1)throw new Error("Object's schema was not verified against input data for CERT");this.tbs=d.result.tbsCertificate.valueBeforeDecode,"tbsCertificate.version"in d.result&&(this.version=d.result["tbsCertificate.version"].valueBlock.valueDec),this.serialNumber=d.result["tbsCertificate.serialNumber"],this.signature=new Eb({schema:d.result["tbsCertificate.signature"]}),this.issuer=new ac({schema:d.result["tbsCertificate.issuer"]}),this.notBefore=new hc({schema:d.result["tbsCertificate.notBefore"]}),this.notAfter=new hc({schema:d.result["tbsCertificate.notAfter"]}),this.subject=new ac({schema:d.result["tbsCertificate.subject"]}),this.subjectPublicKeyInfo=new Ib({schema:d.result["tbsCertificate.subjectPublicKeyInfo"]}),"tbsCertificate.issuerUniqueID"in d.result&&(this.issuerUniqueID=d.result["tbsCertificate.issuerUniqueID"].valueBlock.valueHex),"tbsCertificate.subjectUniqueID"in d.result&&(this.issuerUniqueID=d.result["tbsCertificate.subjectUniqueID"].valueBlock.valueHex),"tbsCertificate.extensions"in d.result&&(this.extensions=Array.from(d.result["tbsCertificate.extensions"],function(a){return new Ac({schema:a})})),this.signatureAlgorithm=new Eb({schema:d.result.signatureAlgorithm}),this.signatureValue=d.result.signatureValue}},{key:"encodeTBS",value:function(){var c=[];return"version"in this&&this.version!==a.defaultValues("version")&&c.push(new Ja({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Wa({value:this.version})]})),c.push(this.serialNumber),c.push(this.signature.toSchema()),c.push(this.issuer.toSchema()),c.push(new Oa({value:[this.notBefore.toSchema(),this.notAfter.toSchema()]})),c.push(this.subject.toSchema()),c.push(this.subjectPublicKeyInfo.toSchema()),"issuerUniqueID"in this&&c.push(new Ha({optional:!0,idBlock:{tagClass:3,tagNumber:1},valueHex:this.issuerUniqueID})),"subjectUniqueID"in this&&c.push(new Ha({optional:!0,idBlock:{tagClass:3,tagNumber:2},valueHex:this.subjectUniqueID})),"subjectUniqueID"in this&&c.push(new Ha({optional:!0,idBlock:{tagClass:3,tagNumber:3},value:[this.extensions.toSchema()]})),"extensions"in this&&c.push(new Ja({optional:!0,idBlock:{tagClass:3,tagNumber:3},value:[new Oa({value:Array.from(this.extensions,function(a){return a.toSchema()})})]})),new Oa({value:c})}},{key:"toSchema",value:function(){var c=arguments.length>0&&void 0!==arguments[0]&&arguments[0],d={};if(c===!1){if(0===this.tbs.length)return a.schema().value[0];d=Cb(this.tbs).result}else d=this.encodeTBS();return new Oa({value:[d,this.signatureAlgorithm.toSchema(),this.signatureValue]})}},{key:"toJSON",value:function(){var c={tbs:ja(this.tbs,0,this.tbs.byteLength),serialNumber:this.serialNumber.toJSON(),signature:this.signature.toJSON(),issuer:this.issuer.toJSON(),notBefore:this.notBefore.toJSON(),notAfter:this.notAfter.toJSON(),subject:this.subject.toJSON(),subjectPublicKeyInfo:this.subjectPublicKeyInfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};return"version"in this&&this.version!==a.defaultValues("version")&&(c.version=this.version),"issuerUniqueID"in this&&(c.issuerUniqueID=ja(this.issuerUniqueID,0,this.issuerUniqueID.byteLength)),"subjectUniqueID"in this&&(c.subjectUniqueID=ja(this.subjectUniqueID,0,this.subjectUniqueID.byteLength)),"extensions"in this&&(c.extensions=Array.from(this.extensions,function(a){return a.toJSON()})),c}},{key:"getPublicKey",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,c=Rb();if("undefined"==typeof c)return Promise.reject("Unable to create WebCrypto object");if(null===b){b={};var d=Zb(this.signatureAlgorithm);if(""===d)return Promise.reject("Unsupported signature algorithm: "+this.signatureAlgorithm.algorithmId);var e=Yb(this.subjectPublicKeyInfo.algorithm.algorithmId);if("name"in e==!1)return Promise.reject("Unsupported public key algorithm: "+this.subjectPublicKeyInfo.algorithm.algorithmId);b.algorithm=Ub(e.name,"importkey"),"hash"in b.algorithm.algorithm&&(b.algorithm.algorithm.hash.name=d)}var f=this.subjectPublicKeyInfo.toSchema(),g=f.toBER(!1),h=new Uint8Array(g);return c.importKey("spki",h,b.algorithm.algorithm,!0,b.algorithm.usages)}},{key:"getKeyHash",value:function(){var b=Rb();return"undefined"==typeof b?Promise.reject("Unable to create WebCrypto object"):b.digest({name:"sha-1"},new Uint8Array(this.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHex))}},{key:"sign",value:function(b){var c=this,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"SHA-1",e=Tb({name:d});if(""===e)return Promise.reject("Unsupported hash algorithm: "+d);var f=Ub(b.algorithm.name,"sign");switch(f.algorithm.hash.name=d,b.algorithm.name.toUpperCase()){case"RSASSA-PKCS1-V1_5":case"ECDSA":this.signature.algorithmId=Tb(f.algorithm),this.signatureAlgorithm.algorithmId=this.signature.algorithmId;break;case"RSA-PSS":switch(d.toUpperCase()){case"SHA-256":f.algorithm.saltLength=32;break;case"SHA-384":f.algorithm.saltLength=48;break;case"SHA-512":f.algorithm.saltLength=64}var g={};if("SHA-1"!==d.toUpperCase()){var h=Tb({name:d});if(""===h)return Promise.reject("Unsupported hash algorithm: "+d);g.hashAlgorithm=new Eb({algorithmId:h,algorithmParams:new Qa}),g.maskGenAlgorithm=new Eb({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:g.hashAlgorithm.toSchema()})}20!==f.algorithm.saltLength&&(g.saltLength=f.algorithm.saltLength);var i=new Fb(g);this.signature=new Eb({algorithmId:"1.2.840.113549.1.1.10",algorithmParams:i.toSchema()}),this.signatureAlgorithm=this.signature;break;default:return Promise.reject("Unsupported signature algorithm: "+b.algorithm.name)}this.tbs=this.encodeTBS().toBER(!1);var j=Rb();return"undefined"==typeof j?Promise.reject("Unable to create WebCrypto object"):j.sign(f.algorithm,b,new Uint8Array(this.tbs)).then(function(a){"ECDSA"===f.algorithm.name&&(a=Vb(a)),c.signatureValue=new Ua({valueHex:a})},function(a){return Promise.reject("Signing error: "+a)})}},{key:"verify",value:function(){var b=this,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,d=Promise.resolve(),e={},f=this.signatureValue,g=this.tbs;if(null!==c?e=c.subjectPublicKeyInfo:this.issuer.isEqual(this.subject)&&(e=this.subjectPublicKeyInfo),e instanceof Ib==!1)return Promise.reject("Please provide issuer certificate as a parameter");var h=Rb();if("undefined"==typeof h)return Promise.reject("Unable to create WebCrypto object");var i=Zb(this.signatureAlgorithm);return""===i?Promise.reject("Unsupported signature algorithm: "+this.signatureAlgorithm.algorithmId):(d=d.then(function(){var a=void 0;a="1.2.840.113549.1.1.10"===b.signatureAlgorithm.algorithmId?b.signatureAlgorithm.algorithmId:e.algorithm.algorithmId;var c=Yb(a);if("name"in c==!1)return Promise.reject("Unsupported public key algorithm: "+a);var d=Ub(c.name,"importkey");"hash"in d.algorithm&&(d.algorithm.hash.name=i);var f=e.toSchema(),g=f.toBER(!1),j=new Uint8Array(g);return h.importKey("spki",j,d.algorithm,!0,d.usages)}),d=d.then(function(a){var c=Ub(a.algorithm.name,"verify");"hash"in c.algorithm&&(c.algorithm.hash.name=i);var d=f.valueBlock.valueHex;if("ECDSA"===a.algorithm.name){var e=Cb(d);d=Xb(e.result)}if("RSA-PSS"===a.algorithm.name){var j=void 0;try{j=new Fb({schema:b.signatureAlgorithm.algorithmParams})}catch(a){return Promise.reject(a)}"saltLength"in j?c.algorithm.saltLength=j.saltLength:c.algorithm.saltLength=20;var k="SHA-1";if("hashAlgorithm"in j){var l=Yb(j.hashAlgorithm.algorithmId);if("name"in l==!1)return Promise.reject("Unrecognized hash algorithm: "+j.hashAlgorithm.algorithmId);k=l.name}c.algorithm.hash.name=k}return h.verify(c.algorithm,a,new Uint8Array(d),new Uint8Array(g))}))}}],[{key:"defaultValues",value:function(b){switch(b){case"tbs":return new ArrayBuffer(0);case"version":return 0;case"serialNumber":return new Wa;case"signature":return new Eb;case"issuer":return new ac;case"notBefore":return new hc;case"notAfter":return new hc;case"subject":return new ac;case"subjectPublicKeyInfo":return new Ib;case"issuerUniqueID":return new ArrayBuffer(0);case"subjectUniqueID":return new ArrayBuffer(0);case"extensions":return[];case"signatureAlgorithm":return new Eb;case"signatureValue":return new Ua;default:throw new Error("Invalid member name for Certificate class: "+b)}}},{key:"schema",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=ia(b,"names",{});return new Oa({name:c.blockName||"",value:[Cc(c.tbsCertificate),Eb.schema(c.signatureAlgorithm||{names:{blockName:"signatureAlgorithm"}}),new Ua({name:c.signatureValue||"signatureValue"})]})}}]),a}(),Ec=null,Fc=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"setEngine",value:function(b,c){Ec=c,Ec.name=b}},{key:"isNodePlugin",value:function(){return"undefined"==typeof self&&"undefined"==typeof window}},{key:"crypto",get:function(){if(!Ec)throw new F(G.CRYPTOGRAPHIC_NO_MODULE);return Ec}}]),a}();+function(){Fc.isNodePlugin()||Fc.setEngine("W3 WebCrypto module",self.crypto)}();var Gc;!function(a){a[a.BeforeDocElement=0]="BeforeDocElement",a[a.InsideDocElement=1]="InsideDocElement",a[a.AfterDocElement=2]="AfterDocElement"}(Gc||(Gc={}));var Hc=function(){function a(b,c){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new O;_classCallCheck(this,a),this.propagatedNamespaces=new O,this.result=[],this.visibleNamespaces=new O,this.inclusiveNamespacesPrefixList=[],this.state=Gc.BeforeDocElement,this.withComments=b,this.exclusive=c,this.propagatedNamespaces=d}return _createClass(a,[{key:"Canonicalize",value:function(b){if(!b)throw new F(G.CRYPTOGRAPHIC,"Parameter 1 is not Node");var c=void 0;b.nodeType===s.Document?(this.document=b,c=this.document.documentElement):(this.document=b.ownerDocument,c=b),this.WriteNode(c);var d=this.result.join("");return d}},{key:"WriteNode",value:function(b){switch(b.nodeType){case s.Document:case s.DocumentFragment:this.WriteDocumentNode(b);break;case s.Element:this.WriteElementNode(b);break;case s.CDATA:case s.SignificantWhitespace:case s.Text:this.WriteTextNode(b);break;case s.Whitespace:this.state===Gc.InsideDocElement&&this.WriteTextNode(b);break;case s.Comment:this.WriteCommentNode(b);break;case s.ProcessingInstruction:this.WriteProcessingInstructionNode(b);break;case s.EntityReference:for(var c=0;c<b.childNodes.length;c++)this.WriteNode(b.childNodes[c]);break;case s.Attribute:throw new F(G.CRYPTOGRAPHIC,"Attribute node is impossible here");case s.EndElement:throw new F(G.CRYPTOGRAPHIC,"Attribute node is impossible here");case s.EndEntity:throw new F(G.CRYPTOGRAPHIC,"Attribute node is impossible here");case s.DocumentType:case s.Entity:case s.Notation:case s.XmlDeclaration:}}},{key:"WriteDocumentNode",value:function(b){this.state=Gc.BeforeDocElement;for(var c=b.firstChild;null!=c;c=c.nextSibling)this.WriteNode(c)}},{key:"WriteTextNode",value:function(b){this.result.push(this.NormalizeString(b.nodeValue,b.nodeType))}},{key:"WriteCommentNode",value:function(b){this.withComments&&(this.state===Gc.AfterDocElement?this.result.push(String.fromCharCode(10)+"<!--"):this.result.push("<!--"),this.result.push(this.NormalizeString(b.nodeValue,s.Comment)),this.state===Gc.BeforeDocElement?this.result.push("-->"+String.fromCharCode(10)):this.result.push("-->"))}},{key:"WriteProcessingInstructionNode",value:function(b){this.state===Gc.AfterDocElement?this.result.push("\n<?"):this.result.push("<?"),this.result.push(b.nodeName),b.nodeValue&&(this.result.push(" "),this.result.push(this.NormalizeString(b.nodeValue,s.ProcessingInstruction))),this.state===Gc.BeforeDocElement?this.result.push("?>\n"):this.result.push("?>")}},{key:"WriteElementNode",value:function(b){this.state===Gc.BeforeDocElement&&(this.state=Gc.InsideDocElement),this.result.push("<"),this.result.push(b.nodeName);var c=this.WriteNamespacesAxis(b);this.WriteAttributesAxis(b),this.result.push(">");for(var d=b.firstChild;null!=d;d=d.nextSibling)this.WriteNode(d);for(this.result.push("</"),this.result.push(b.nodeName),this.result.push(">"),this.state===Gc.BeforeDocElement&&(this.state=Gc.AfterDocElement);c--;)this.visibleNamespaces.Pop()}},{key:"WriteNamespacesAxis",value:function(b){for(var c=this,d=[],e=0,f=0;f<b.attributes.length;f++){var g=b.attributes[f];if(Lc(g)){if("xmlns"===g.localName&&!g.prefix&&!g.nodeValue){var i={prefix:g.prefix,namespace:g.nodeValue};d.push(i),this.visibleNamespaces.Add(i),e++}var j=null,k=void 0;(k=/xmlns:(\w+)/.exec(g.nodeName))&&(j=k[1]);var l=!0;if(this.exclusive&&!this.IsNamespaceInclusive(b,j)){var m=Kc(b,j);if(m>1)l=!1;else if(0===m)continue}if(!this.IsNamespaceRendered(j,g.nodeValue)&&l){var n={prefix:j,namespace:g.nodeValue};d.push(n),this.visibleNamespaces.Add(n),e++}}else if(g.prefix&&!this.IsNamespaceRendered(g.prefix,g.namespaceURI)){var h={prefix:g.prefix,namespace:g.namespaceURI};d.push(h),this.visibleNamespaces.Add(h),e++}}if(!this.IsNamespaceRendered(b.prefix,b.namespaceURI)&&"http://www.w3.org/2000/xmlns/"!==b.namespaceURI){var o={prefix:b.prefix,namespace:b.namespaceURI};d.push(o),this.visibleNamespaces.Add(o),e++}d.sort(Ic);var p=null;return d.forEach(function(a){a.prefix!==p&&(p=a.prefix,c.result.push(" xmlns"),a.prefix&&c.result.push(":"+a.prefix),c.result.push('="'),c.result.push(a.namespace),c.result.push('"'))}),e}},{key:"WriteAttributesAxis",value:function(b){for(var c=this,d=[],e=0;e<b.attributes.length;e++){var f=b.attributes[e];Lc(f)||d.push(f)}d.sort(Jc),d.forEach(function(a){null!=a&&(c.result.push(" "),c.result.push(a.nodeName),c.result.push('="'),c.result.push(c.NormalizeString(a.nodeValue,s.Attribute)),c.result.push('"'))})}},{key:"NormalizeString",value:function(b,c){var d=[];if(b)for(var e=0;e<b.length;e++){var f=b[e];"<"!==f||c!==s.Attribute&&!this.IsTextNode(c)?">"===f&&this.IsTextNode(c)?d.push("&gt;"):"&"!==f||c!==s.Attribute&&!this.IsTextNode(c)?'"'===f&&c===s.Attribute?d.push("&quot;"):"\t"===f&&c===s.Attribute?d.push("&#x9;"):"\n"===f&&c===s.Attribute?d.push("&#xA;"):"\r"===f?d.push("&#xD;"):d.push(f):d.push("&amp;"):d.push("&lt;")}return d.join("")}},{key:"IsTextNode",value:function(b){switch(b){case s.Text:case s.CDATA:case s.SignificantWhitespace:case s.Whitespace:return!0}return!1}},{key:"IsNamespaceInclusive",value:function(b,c){var d=c||null;return b.prefix!==d&&this.inclusiveNamespacesPrefixList.indexOf(d||"")!==-1}},{key:"IsNamespaceRendered",value:function(b,c){if(b=b||"",c=c||"",!b&&!c)return!0;if("xml"===b&&"http://www.w3.org/XML/1998/namespace"===c)return!0;var d=this.visibleNamespaces.GetPrefix(b);return!!d&&d.namespace===c}},{key:"InclusiveNamespacesPrefixList",get:function(){return this.inclusiveNamespacesPrefixList.join(" ")},set:function(b){this.inclusiveNamespacesPrefixList=b.split(" ")}}]),a}(),Mc={DefaultCanonMethod:"http://www.w3.org/TR/2001/REC-xml-c14n-20010315",DefaultDigestMethod:"http://www.w3.org/2001/04/xmlenc#sha256",DefaultPrefix:"ds",ElementNames:{CanonicalizationMethod:"CanonicalizationMethod",DigestMethod:"DigestMethod",DigestValue:"DigestValue",DSAKeyValue:"DSAKeyValue",DomainParameters:"DomainParameters",EncryptedKey:"EncryptedKey",HMACOutputLength:"HMACOutputLength",RSAPSSParams:"RSAPSSParams",MaskGenerationFunction:"MaskGenerationFunction",SaltLength:"SaltLength",KeyInfo:"KeyInfo",KeyName:"KeyName",KeyValue:"KeyValue",Modulus:"Modulus",Exponent:"Exponent",Manifest:"Manifest",Object:"Object",Reference:"Reference",RetrievalMethod:"RetrievalMethod",RSAKeyValue:"RSAKeyValue",ECDSAKeyValue:"ECDSAKeyValue",NamedCurve:"NamedCurve",PublicKey:"PublicKey",Signature:"Signature",SignatureMethod:"SignatureMethod",SignatureValue:"SignatureValue",SignedInfo:"SignedInfo",Transform:"Transform",Transforms:"Transforms",X509Data:"X509Data",PGPData:"PGPData",SPKIData:"SPKIData",SPKIexp:"SPKIexp",MgmtData:"MgmtData",X509IssuerSerial:"X509IssuerSerial",X509IssuerName:"X509IssuerName",X509SerialNumber:"X509SerialNumber",X509SKI:"X509SKI",X509SubjectName:"X509SubjectName",X509Certificate:"X509Certificate",X509CRL:"X509CRL",XPath:"XPath",X:"X",Y:"Y"},AttributeNames:{Algorithm:"Algorithm",Encoding:"Encoding",Id:"Id",MimeType:"MimeType",Type:"Type",URI:"URI"},AlgorithmNamespaces:{XmlDsigBase64Transform:"http://www.w3.org/2000/09/xmldsig#base64",XmlDsigC14NTransform:"http://www.w3.org/TR/2001/REC-xml-c14n-20010315",XmlDsigC14NWithCommentsTransform:"http://www.w3.org/TR/2001/REC-xml-c14n-20010315#WithComments",XmlDsigEnvelopedSignatureTransform:"http://www.w3.org/2000/09/xmldsig#enveloped-signature",XmlDsigXPathTransform:"http://www.w3.org/TR/1999/REC-xpath-19991116",XmlDsigXsltTransform:"http://www.w3.org/TR/1999/REC-xslt-19991116",XmlDsigExcC14NTransform:"http://www.w3.org/2001/10/xml-exc-c14n#",XmlDsigExcC14NWithCommentsTransform:"http://www.w3.org/2001/10/xml-exc-c14n#WithComments",XmlDecryptionTransform:"http://www.w3.org/2002/07/decrypt#XML",XmlLicenseTransform:"urn:mpeg:mpeg21:2003:01-REL-R-NS:licenseTransform"},Uri:{Manifest:"http://www.w3.org/2000/09/xmldsig#Manifest"},NamespaceURI:"http://www.w3.org/2000/09/xmldsig#",NamespaceURIMore:"http://www.w3.org/2007/05/xmldsig-more#",NamespaceURIPss:"http://www.example.org/xmldsig-pss/#"},Nc=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),b}(M);Nc=d([l({localName:"xmldsig",namespaceURI:Mc.NamespaceURI,prefix:Mc.DefaultPrefix})],Nc);var Oc=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),b}(N);Oc=d([l({localName:"xmldsig_collection",namespaceURI:Mc.NamespaceURI,prefix:Mc.DefaultPrefix})],Oc);var Pc=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),b}(Nc),Qc=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),b}(Nc);d([n({localName:Mc.AttributeNames.Algorithm,required:!0,defaultValue:Mc.DefaultDigestMethod})],Qc.prototype,"Algorithm",void 0),Qc=d([l({localName:Mc.ElementNames.DigestMethod})],Qc);var Rc=function(){function a(){_classCallCheck(this,a)}return _createClass(a,[{key:"getAlgorithmName",value:function(){return this.namespaceURI}}]),a}(),Sc=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),_createClass(b,[{key:"Digest",value:function(b){var c=this;return Promise.resolve().then(function(){var a=void 0;if("string"==typeof b)a=I.FromString(b,"utf8");else if(b instanceof Uint8Array)a=b;else{var d=(new XMLSerializer).serializeToString(b);a=I.FromString(d,"utf8")}return Fc.crypto.subtle.digest(c.algorithm,a)}).then(function(a){return new Uint8Array(a)})}}]),b}(Rc),Tc=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),_createClass(b,[{key:"Sign",value:function(b,c,d){var e=I.FromString(b,"utf8");return Fc.crypto.subtle.sign(d,c,e)}},{key:"Verify",value:function(b,c,d,e){var f=I.FromString(b,"utf8");return Fc.crypto.subtle.verify(e||this.algorithm,c,d,f)}}]),b}(Rc),Uc="SHA-1",Vc="SHA-256",Wc="SHA-384",Xc="SHA-512",Yc="http://www.w3.org/2000/09/xmldsig#sha1",Zc="http://www.w3.org/2001/04/xmlenc#sha256",$c="http://www.w3.org/2001/04/xmldsig-more#sha384",_c="http://www.w3.org/2001/04/xmlenc#sha512",ad=function(a){
function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return a.algorithm={name:Uc},a.namespaceURI=Yc,a}return _inherits(b,a),b}(Sc),bd=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return a.algorithm={name:Vc},a.namespaceURI=Zc,a}return _inherits(b,a),b}(Sc),cd=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return a.algorithm={name:Wc},a.namespaceURI=$c,a}return _inherits(b,a),b}(Sc),dd=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return a.algorithm={name:Xc},a.namespaceURI=_c,a}return _inherits(b,a),b}(Sc),ed="ECDSA",fd="http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha1",gd="http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha256",hd="http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha384",id="http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha512",jd=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return a.algorithm={name:ed,hash:{name:Uc}},a.namespaceURI=fd,a}return _inherits(b,a),b}(Tc),kd=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return a.algorithm={name:ed,hash:{name:Vc}},a.namespaceURI=gd,a}return _inherits(b,a),b}(Tc),ld=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return a.algorithm={name:ed,hash:{name:Wc}},a.namespaceURI=hd,a}return _inherits(b,a),b}(Tc),md=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return a.algorithm={name:ed,hash:{name:Xc}},a.namespaceURI=id,a}return _inherits(b,a),b}(Tc),nd="HMAC",od="http://www.w3.org/2000/09/xmldsig#hmac-sha1",pd="http://www.w3.org/2001/04/xmldsig-more#hmac-sha256",qd="http://www.w3.org/2001/04/xmldsig-more#hmac-sha384",rd="http://www.w3.org/2001/04/xmldsig-more#hmac-sha512",sd=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return a.algorithm={name:nd,hash:{name:Uc}},a.namespaceURI=od,a}return _inherits(b,a),b}(Tc),td=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return a.algorithm={name:nd,hash:{name:Vc}},a.namespaceURI=pd,a}return _inherits(b,a),b}(Tc),ud=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return a.algorithm={name:nd,hash:{name:Wc}},a.namespaceURI=qd,a}return _inherits(b,a),b}(Tc),vd=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return a.algorithm={name:nd,hash:{name:Xc}},a.namespaceURI=rd,a}return _inherits(b,a),b}(Tc),wd="RSASSA-PKCS1-v1_5",xd="http://www.w3.org/2000/09/xmldsig#rsa-sha1",yd="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256",zd="http://www.w3.org/2001/04/xmldsig-more#rsa-sha384",Ad="http://www.w3.org/2001/04/xmldsig-more#rsa-sha512",Bd=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return a.algorithm={name:wd,hash:{name:Uc}},a.namespaceURI=xd,a}return _inherits(b,a),b}(Tc),Cd=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return a.algorithm={name:wd,hash:{name:Vc}},a.namespaceURI=yd,a}return _inherits(b,a),b}(Tc),Dd=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return a.algorithm={name:wd,hash:{name:Wc}},a.namespaceURI=zd,a}return _inherits(b,a),b}(Tc),Ed=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return a.algorithm={name:wd,hash:{name:Xc}},a.namespaceURI=Ad,a}return _inherits(b,a),b}(Tc),Fd="RSA-PSS",Gd="http://www.w3.org/2007/05/xmldsig-more#rsa-pss",Hd=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return c.algorithm={name:Fd,hash:{name:Uc}},c.namespaceURI=Gd,a&&(c.algorithm.saltLength=a),c}return _inherits(b,a),b}(Tc),Id=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.algorithm.hash.name=Uc,c}return _inherits(b,a),b}(Hd),Jd=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.algorithm.hash.name=Vc,c}return _inherits(b,a),b}(Hd),Kd=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.algorithm.hash.name=Wc,c}return _inherits(b,a),b}(Hd),Ld=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.algorithm.hash.name=Xc,c}return _inherits(b,a),b}(Hd),Md=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return a.m_key=null,a.m_jwk=null,a.m_keyusage=[],a}return _inherits(b,a),_createClass(b,[{key:"importKey",value:function(b){var c=this;return new Promise(function(a,d){var e=b.algorithm.name.toUpperCase();if(e!==wd.toUpperCase()&&e!==Fd.toUpperCase())throw new F(G.ALGORITHM_WRONG_NAME,b.algorithm.name);c.m_key=b,Fc.crypto.subtle.exportKey("jwk",b).then(function(a){return c.m_jwk=a,c.Modulus=I.FromBase64Url(a.n),c.Exponent=I.FromBase64Url(a.e),c.m_keyusage=b.usages,Promise.resolve(c)}).then(a,d)})}},{key:"exportKey",value:function(b){var c=this;return new Promise(function(a,d){if(c.m_key)return a(c.m_key);if(!c.Modulus)throw new F(G.CRYPTOGRAPHIC,"RsaKeyValue has no Modulus");var e=I.ToBase64Url(c.Modulus);if(!c.Exponent)throw new F(G.CRYPTOGRAPHIC,"RsaKeyValue has no Exponent");var f=I.ToBase64Url(c.Exponent),g=void 0;switch(b.name.toUpperCase()){case wd.toUpperCase():g="R";break;case Fd.toUpperCase():g="P";break;default:throw new F(G.ALGORITHM_NOT_SUPPORTED,b.name)}switch(b.hash.name.toUpperCase()){case Uc:g+="S1";break;case Vc:g+="S256";break;case Wc:g+="S384";break;case Xc:g+="S512"}var h={kty:"RSA",alg:g,n:e,e:f,ext:!0};Fc.crypto.subtle.importKey("jwk",h,b,!0,c.m_keyusage).then(a,d)})}},{key:"LoadXml",value:function(c){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"LoadXml",this).call(this,c),this.m_keyusage=["verify"]}}]),b}(Pc);d([m({localName:Mc.ElementNames.Modulus,prefix:Mc.DefaultPrefix,namespaceURI:Mc.NamespaceURI,required:!0,converter:J})],Md.prototype,"Modulus",void 0),d([m({localName:Mc.ElementNames.Exponent,prefix:Mc.DefaultPrefix,namespaceURI:Mc.NamespaceURI,required:!0,converter:J})],Md.prototype,"Exponent",void 0),Md=d([l({localName:Mc.ElementNames.RSAKeyValue})],Md);var Nd="http://www.w3.org/2007/05/xmldsig-more#",Od="pss",Pd=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),b}(M);d([m({parser:Qc})],Pd.prototype,"DigestMethod",void 0),d([n({localName:Mc.AttributeNames.Algorithm,defaultValue:"http://www.w3.org/2007/05/xmldsig-more#MGF1"})],Pd.prototype,"Algorithm",void 0),Pd=d([l({localName:Mc.ElementNames.MaskGenerationFunction,prefix:Od,namespaceURI:Nd})],Pd);var Qd=Rd=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return a&&c.FromAlgorithm(a),c}return _inherits(b,a),_createClass(b,[{key:"FromAlgorithm",value:function(b){this.DigestMethod=new Qc;var c=Ae.GetHashAlgorithm(b.hash);this.DigestMethod.Algorithm=c.namespaceURI,b.saltLength&&(this.SaltLength=b.saltLength)}}],[{key:"FromAlgorithm",value:function(b){return new Rd(b)}}]),b}(M);d([m({parser:Qc})],Qd.prototype,"DigestMethod",void 0),d([m({parser:Pd})],Qd.prototype,"MGF",void 0),d([m({converter:K,prefix:Od,namespaceURI:Nd})],Qd.prototype,"SaltLength",void 0),d([m({converter:K})],Qd.prototype,"TrailerField",void 0),Qd=Rd=d([l({localName:Mc.ElementNames.RSAPSSParams,prefix:Od,namespaceURI:Nd})],Qd);var Rd,Sd=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),b}(Nc);d([n({localName:Mc.AttributeNames.Algorithm,required:!0,defaultValue:Mc.DefaultCanonMethod})],Sd.prototype,"Algorithm",void 0),Sd=d([l({localName:Mc.ElementNames.CanonicalizationMethod})],Sd);var Td=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),b}(Nc);d([n({localName:Mc.AttributeNames.Id,defaultValue:""})],Td.prototype,"Id",void 0),d([n({localName:Mc.AttributeNames.MimeType,defaultValue:""})],Td.prototype,"MimeType",void 0),d([n({localName:Mc.AttributeNames.Encoding,defaultValue:""})],Td.prototype,"Encoding",void 0),Td=d([l({localName:Mc.ElementNames.Object})],Td);var Ud=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),b}(Oc);Ud=d([l({localName:"xmldsig_objects",parser:Td})],Ud);var Vd=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),_createClass(b,[{key:"OnLoadXml",value:function(b){for(var c=this,d=function(d){var e=b.childNodes.item(d);if(e.nodeType!==s.Element)return"continue";var f=null;switch(e.localName){case Mc.ElementNames.KeyValue:f=re;break;case Mc.ElementNames.X509Data:f=we;break;case Mc.ElementNames.SPKIData:f=xe;break;case Mc.ElementNames.KeyName:case Mc.ElementNames.RetrievalMethod:case Mc.ElementNames.PGPData:case Mc.ElementNames.MgmtData:}if(f){var g=new f;if(g.LoadXml(e),g instanceof re){var h=null;if([Md,oe].some(function(a){try{for(var b=new a,c=0;c<e.childNodes.length;c++){var d=e.childNodes.item(c);if(d.nodeType===s.Element)return b.LoadXml(d),h=b,!0}}catch(a){}return!1}),!h)throw new F(G.CRYPTOGRAPHIC,"Unsupported KeyValue in use");g.Value=h}c.Add(g)}},e=0;e<b.childNodes.length;e++){d(e)}}}]),b}(Oc);d([n({localName:Mc.AttributeNames.Id,defaultValue:""})],Vd.prototype,"Id",void 0),Vd=d([l({localName:Mc.ElementNames.KeyInfo})],Vd);var Wd=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return a.innerXml=null,a}return _inherits(b,a),_createClass(b,[{key:"GetOutput",value:function(){throw new F(G.METHOD_NOT_IMPLEMENTED)}},{key:"LoadInnerXml",value:function(b){if(!b)throw new F(G.PARAM_REQUIRED,"node");this.innerXml=b}},{key:"GetInnerXml",value:function(){return this.innerXml}}]),b}(Nc);d([n({localName:Mc.AttributeNames.Algorithm,defaultValue:""})],Wd.prototype,"Algorithm",void 0),d([m({localName:Mc.ElementNames.XPath,defaultValue:""})],Wd.prototype,"XPath",void 0),Wd=d([l({localName:Mc.ElementNames.Transform})],Wd);var Xd=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return a.Algorithm=Mc.AlgorithmNamespaces.XmlDsigBase64Transform,a}return _inherits(b,a),_createClass(b,[{key:"GetOutput",value:function(){if(!this.innerXml)throw new F(G.PARAM_REQUIRED,"innerXml");return I.FromString(this.innerXml.textContent||"","base64")}}]),b}(Wd),Yd=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return a.xmlCanonicalizer=new Hc(!1,!1),a.Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315",a}return _inherits(b,a),_createClass(b,[{key:"GetOutput",value:function(){if(!this.innerXml)throw new F(G.PARAM_REQUIRED,"innerXml");return this.xmlCanonicalizer.Canonicalize(this.innerXml)}}]),b}(Wd),Zd=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return a.Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315#WithComments",a.xmlCanonicalizer=new Hc(!0,!1),a}return _inherits(b,a),b}(Yd),$d=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return a.Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature",a}return _inherits(b,a),_createClass(b,[{key:"GetOutput",value:function(){if(!this.innerXml)throw new F(G.PARAM_REQUIRED,"innerXml");var b=x(this.innerXml,".//*[local-name(.)='Signature' and namespace-uri(.)='http://www.w3.org/2000/09/xmldsig#']")[0];return b&&b.parentNode.removeChild(b),this.innerXml}}]),b}(Wd),_d=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return a.xmlCanonicalizer=new Hc(!1,!0),a.Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#",a}return _inherits(b,a),_createClass(b,[{key:"GetOutput",value:function(){if(!this.innerXml)throw new F(G.PARAM_REQUIRED,"innerXml");return this.xmlCanonicalizer.Canonicalize(this.innerXml)}},{key:"InclusiveNamespacesPrefixList",get:function(){return this.xmlCanonicalizer.InclusiveNamespacesPrefixList},set:function(b){this.xmlCanonicalizer.InclusiveNamespacesPrefixList=b}}]),b}(Wd),ae=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return a.Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#WithComments",a.xmlCanonicalizer=new Hc(!0,!0),a}return _inherits(b,a),b}(_d),be=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),_createClass(b,[{key:"OnLoadXml",value:function(c){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"OnLoadXml",this).call(this,c),this.items=this.GetIterator().map(function(a){switch(a.Algorithm){case Mc.AlgorithmNamespaces.XmlDsigEnvelopedSignatureTransform:return ce(a,$d);case Mc.AlgorithmNamespaces.XmlDsigC14NTransform:return ce(a,Yd);case Mc.AlgorithmNamespaces.XmlDsigC14NWithCommentsTransform:return ce(a,Zd);case Mc.AlgorithmNamespaces.XmlDsigExcC14NTransform:return ce(a,_d);case Mc.AlgorithmNamespaces.XmlDsigExcC14NWithCommentsTransform:return ce(a,ae);case Mc.AlgorithmNamespaces.XmlDsigBase64Transform:return ce(a,Xd);default:throw new F(G.CRYPTOGRAPHIC_UNKNOWN_TRANSFORM,a.Algorithm)}})}}]),b}(Oc);be=d([l({localName:Mc.ElementNames.Transforms,parser:Wd})],be);var de=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return a&&(c.Uri=a),c}return _inherits(b,a),b}(Nc);d([n({defaultValue:""})],de.prototype,"Id",void 0),d([n({localName:Mc.AttributeNames.URI,defaultValue:""})],de.prototype,"Uri",void 0),d([n({localName:Mc.AttributeNames.Type,defaultValue:""})],de.prototype,"Type",void 0),d([m({parser:be})],de.prototype,"Transforms",void 0),d([m({required:!0,parser:Qc})],de.prototype,"DigestMethod",void 0),d([m({required:!0,localName:Mc.ElementNames.DigestValue,namespaceURI:Mc.NamespaceURI,prefix:Mc.DefaultPrefix,converter:J})],de.prototype,"DigestValue",void 0),de=d([l({localName:Mc.ElementNames.Reference})],de);var ee=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),b}(Oc);ee=d([l({localName:"References",parser:de})],ee);var fe=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),_createClass(b,[{key:"OnLoadXml",value:function(b){for(var c=0;c<b.childNodes.length;c++){var d=b.childNodes.item(c);if(d.nodeType===s.Element&&d.nodeName!==Mc.ElementNames.HMACOutputLength){var e=void 0;switch(d.localName){case Mc.ElementNames.RSAPSSParams:e=Qd}if(e){var f=new e;f.LoadXml(d),this.Add(f)}}}}}]),b}(Oc);fe=d([l({localName:"Other"})],fe);var ge=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),b}(Nc);d([n({localName:Mc.AttributeNames.Algorithm,required:!0,defaultValue:""})],ge.prototype,"Algorithm",void 0),d([m({localName:Mc.ElementNames.HMACOutputLength,namespaceURI:Mc.NamespaceURI,prefix:Mc.DefaultPrefix,converter:K})],ge.prototype,"HMACOutputLength",void 0),d([m({parser:fe,noRoot:!0,minOccurs:0})],ge.prototype,"Any",void 0),ge=d([l({localName:Mc.ElementNames.SignatureMethod})],ge);var he=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),b}(Nc);d([n({localName:Mc.AttributeNames.Id,defaultValue:""})],he.prototype,"Id",void 0),d([m({parser:Sd,required:!0})],he.prototype,"CanonicalizationMethod",void 0),d([m({parser:ge,required:!0})],he.prototype,"SignatureMethod",void 0),d([m({parser:ee,minOccurs:1,noRoot:!0})],he.prototype,"References",void 0),he=d([l({localName:Mc.ElementNames.SignedInfo})],he);var ie=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),b}(Nc);d([n({localName:Mc.AttributeNames.Id,defaultValue:""})],ie.prototype,"Id",void 0),d([m({parser:he,required:!0})],ie.prototype,"SignedInfo",void 0),d([m({localName:Mc.ElementNames.SignatureValue,namespaceURI:Mc.NamespaceURI,prefix:Mc.DefaultPrefix,required:!0,converter:J,defaultValue:null})],ie.prototype,"SignatureValue",void 0),d([m({parser:Vd})],ie.prototype,"KeyInfo",void 0),d([m({parser:Ud,noRoot:!0})],ie.prototype,"ObjectList",void 0),ie=d([l({localName:Mc.ElementNames.Signature})],ie);var je="http://www.w3.org/2001/04/xmldsig-more#",ke="ecdsa",le=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),b}(M);d([m({localName:Mc.ElementNames.X,namespaceURI:je,prefix:ke,required:!0,converter:J})],le.prototype,"X",void 0),d([m({localName:Mc.ElementNames.Y,namespaceURI:je,prefix:ke,required:!0,converter:J})],le.prototype,"Y",void 0),le=d([l({localName:Mc.ElementNames.PublicKey,namespaceURI:je,prefix:ke})],le);var me=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),b}(M);d([n({localName:Mc.AttributeNames.URI,required:!0})],me.prototype,"Uri",void 0),me=d([l({localName:Mc.ElementNames.NamedCurve,namespaceURI:je,prefix:ke})],me);var ne=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),b}(M);d([m({parser:me})],ne.prototype,"NamedCurve",void 0),ne=d([l({localName:Mc.ElementNames.DomainParameters,namespaceURI:je,prefix:ke})],ne);var oe=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));return a.name=Mc.ElementNames.ECDSAKeyValue,a.m_key=null,a.m_jwk=null,a.m_keyusage=null,a}return _inherits(b,a),_createClass(b,[{key:"importKey",value:function(b){var c=this;return new Promise(function(a,d){if("ECDSA"!==b.algorithm.name.toUpperCase())throw new F(G.ALGORITHM_WRONG_NAME,b.algorithm.name);c.m_key=b,Fc.crypto.subtle.exportKey("jwk",b).then(function(a){return c.m_jwk=a,c.PublicKey=new le,c.PublicKey.X=I.FromString(a.x,"base64url"),c.PublicKey.Y=I.FromString(a.y,"base64url"),c.DomainParameters||(c.DomainParameters=new ne),c.DomainParameters.NamedCurve||(c.DomainParameters.NamedCurve=new me),c.DomainParameters.NamedCurve.Uri=pe(a.crv),c.m_keyusage=b.usages,Promise.resolve(c)}).then(a,d)})}},{key:"exportKey",value:function(b){var c=this;return Promise.resolve().then(function(){if(c.m_key)return c.m_key;var a=I.ToBase64Url(c.PublicKey.X),b=I.ToBase64Url(c.PublicKey.Y),d=qe(c.DomainParameters.NamedCurve.Uri),e={kty:"EC",crv:d,x:a,y:b,ext:!0};return c.m_keyusage=["verify"],Fc.crypto.subtle.importKey("jwk",e,{name:"ECDSA",namedCurve:d},!0,c.m_keyusage)}).then(function(a){return c.m_key=a,c.m_key})}},{key:"NamedCurve",get:function(){return pe(this.DomainParameters.NamedCurve.Uri)}}]),b}(Pc);d([m({parser:ne})],oe.prototype,"DomainParameters",void 0),d([m({parser:le,required:!0})],oe.prototype,"PublicKey",void 0),oe=d([l({localName:Mc.ElementNames.ECDSAKeyValue,namespaceURI:je,prefix:ke})],oe);var re=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return a&&(c.Value=a),c}return _inherits(b,a),_createClass(b,[{key:"importKey",value:function(b){var c=this;return Promise.resolve().then(function(){switch(b.algorithm.name.toUpperCase()){case Fd.toUpperCase():case wd.toUpperCase():return c.Value=new Md,c.Value.importKey(b);case ed.toUpperCase():return c.Value=new oe,c.Value.importKey(b);default:throw new F(G.ALGORITHM_NOT_SUPPORTED,b.algorithm.name)}}).then(function(){return c})}},{key:"exportKey",value:function(b){var c=this;return Promise.resolve().then(function(){if(!c.Value)throw new F(G.NULL_REFERENCE);return c.Value.exportKey(b)})}},{key:"OnGetXml",value:function(b){if(!this.Value)throw new F(G.CRYPTOGRAPHIC,"KeyValue has empty value");var c=this.Value.GetXml();c&&b.appendChild(c)}},{key:"Value",set:function(b){this.element=null,this.value=b},get:function(){return this.value}}]),b}(Pc);re=d([l({localName:Mc.ElementNames.KeyValue})],re);var se={"2.5.4.3":{short:"CN",long:"CommonName"},"2.5.4.6":{short:"C",long:"Country"},"2.5.4.5":{long:"DeviceSerialNumber"},"0.9.2342.19200300.100.1.25":{short:"DC",long:"DomainComponent"},"1.2.840.113549.1.9.1":{short:"E",long:"EMail"},"2.5.4.42":{short:"G",long:"GivenName"},"2.5.4.43":{short:"I",long:"Initials"},"2.5.4.7":{short:"L",long:"Locality"},"2.5.4.10":{short:"O",long:"Organization"},"2.5.4.11":{short:"OU",long:"OrganizationUnit"},"2.5.4.8":{short:"ST",long:"State"},"2.5.4.9":{short:"Street",long:"StreetAddress"},"2.5.4.4":{short:"SN",long:"SurName"},"2.5.4.12":{short:"T",long:"Title"},"1.2.840.113549.1.9.8":{long:"UnstructuredAddress"},"1.2.840.113549.1.9.2":{long:"UnstructuredName"}},te=function(){function a(b){if(_classCallCheck(this,a),this.publicKey=null,b){var c=new Uint8Array(b);this.LoadRaw(c),this.raw=c}}return _createClass(a,[{key:"NameToString",value:function(b){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",",d=[];return b.typesAndValues.forEach(function(a){var b=a.type,c=se[b.toString()].short;d.push((c?c:b)+"="+a.value.valueBlock.value)}),d.join(c+" ")}},{key:"Thumbprint",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"SHA-1";return Fc.crypto.subtle.digest(b,this.raw)}},{key:"LoadRaw",value:function(b){this.raw=new Uint8Array(b);var c=Cb(this.raw.buffer);this.simpl=new Dc({schema:c.result})}},{key:"GetRaw",value:function(){return this.raw}},{key:"exportKey",value:function(b){var c=this;return Promise.resolve().then(function(){Rb()||Qb(Fc.crypto.name,Fc.crypto,Fc.crypto.subtle);var a={algorithm:b,usages:["verify"]};return a.algorithm.name.toUpperCase()===ed&&(a.algorithm.namedCurve=c.simpl.subjectPublicKeyInfo.toJSON().crv),c.simpl.getPublicKey({algorithm:a}).then(function(a){return c.publicKey=a,a})})}},{key:"SerialNumber",get:function(){return I.ToHex(new Uint8Array(this.simpl.serialNumber.valueBlock.valueHex))}},{key:"Issuer",get:function(){return this.NameToString(this.simpl.issuer)}},{key:"Subject",get:function(){return this.NameToString(this.simpl.subject)}},{key:"PublicKey",get:function(){return this.publicKey}}]),a}(),ue=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),b}(Nc);d([m({localName:Mc.ElementNames.X509IssuerName,namespaceURI:Mc.NamespaceURI,prefix:Mc.DefaultPrefix,required:!0})],ue.prototype,"X509IssuerName",void 0),d([m({localName:Mc.ElementNames.X509SerialNumber,namespaceURI:Mc.NamespaceURI,prefix:Mc.DefaultPrefix,required:!0})],ue.prototype,"X509SerialNumber",void 0),ue=d([l({localName:Mc.ElementNames.X509IssuerSerial})],ue);var ve;!function(a){a[a.None=0]="None",a[a.EndCertOnly=1]="EndCertOnly",a[a.ExcludeRoot=2]="ExcludeRoot",a[a.WholeChain=3]="WholeChain"}(ve||(ve={}));var we=function(a){function b(a){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ve.None;_classCallCheck(this,b);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));if(d.x509crl=null,d.SubjectKeyIdList=[],d.key=null,a)if(a instanceof Uint8Array)d.AddCertificate(new te(a));else if(a instanceof te)switch(c){case ve.None:case ve.EndCertOnly:d.AddCertificate(a);break;case ve.ExcludeRoot:d.AddCertificatesChainFrom(a,!1);break;case ve.WholeChain:d.AddCertificatesChainFrom(a,!0)}return d}return _inherits(b,a),_createClass(b,[{key:"importKey",value:function(b){return Promise.reject(new F(G.METHOD_NOT_SUPPORTED))}},{key:"exportKey",value:function(b){var c=this;return Promise.resolve().then(function(){return c.Certificates.length?c.Certificates[0].exportKey(b):Promise.resolve(null)}).then(function(a){return c.key=a,a})}},{key:"AddCertificatesChainFrom",value:function(b,c){throw new F(G.METHOD_NOT_IMPLEMENTED)}},{key:"AddCertificate",value:function(b){if(!b)throw new F(G.PARAM_REQUIRED,"certificate");this.X509CertificateList||(this.X509CertificateList=[]),this.X509CertificateList.push(b)}},{key:"AddIssuerSerial",value:function(b,c){if(null==b)throw new F(G.PARAM_REQUIRED,"issuerName");null==this.IssuerSerialList&&(this.IssuerSerialList=[]);var d={issuerName:b,serialNumber:c};this.IssuerSerialList.push(d)}},{key:"AddSubjectKeyId",value:function(b){if(this.SubjectKeyIdList&&(this.SubjectKeyIdList=[]),"string"==typeof b){if(null!=b){var c=void 0;c=I.FromBase64(b),this.SubjectKeyIdList.push(c)}}else this.SubjectKeyIdList.push(b)}},{key:"AddSubjectName",value:function(b){null==this.SubjectNameList&&(this.SubjectNameList=[]),this.SubjectNameList.push(b)}},{key:"GetXml",value:function(){var b=this.CreateDocument(),c=this.CreateElement(b),d=this.GetPrefix();if(null!=this.IssuerSerialList&&this.IssuerSerialList.length>0&&this.IssuerSerialList.forEach(function(a){var e=b.createElementNS(Mc.NamespaceURI,d+Mc.ElementNames.X509IssuerSerial),f=b.createElementNS(Mc.NamespaceURI,d+Mc.ElementNames.X509IssuerName);f.textContent=a.issuerName,e.appendChild(f);var g=b.createElementNS(Mc.NamespaceURI,d+Mc.ElementNames.X509SerialNumber);g.textContent=a.serialNumber,e.appendChild(g),c.appendChild(e)}),null!=this.SubjectKeyIdList&&this.SubjectKeyIdList.length>0&&this.SubjectKeyIdList.forEach(function(a){var e=b.createElementNS(Mc.NamespaceURI,d+Mc.ElementNames.X509SKI);e.textContent=I.ToBase64(a),c.appendChild(e)}),null!=this.SubjectNameList&&this.SubjectNameList.length>0&&this.SubjectNameList.forEach(function(a){var e=b.createElementNS(Mc.NamespaceURI,d+Mc.ElementNames.X509SubjectName);e.textContent=a,c.appendChild(e)}),null!=this.X509CertificateList&&this.X509CertificateList.length>0&&this.X509CertificateList.forEach(function(a){var e=b.createElementNS(Mc.NamespaceURI,d+Mc.ElementNames.X509Certificate);e.textContent=I.ToBase64(a.GetRaw()),c.appendChild(e)}),null!=this.x509crl){var e=b.createElementNS(Mc.NamespaceURI,d+Mc.ElementNames.X509CRL);e.textContent=I.ToBase64(this.x509crl),c.appendChild(e)}return c}},{key:"LoadXml",value:function(c){var d=this;_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"LoadXml",this).call(this,c),this.IssuerSerialList&&(this.IssuerSerialList=[]),this.SubjectKeyIdList&&(this.SubjectKeyIdList=[]),this.SubjectNameList&&(this.SubjectNameList=[]),this.X509CertificateList&&(this.X509CertificateList=[]),this.x509crl=null;var e=this.GetChildren(Mc.ElementNames.X509IssuerSerial);e&&e.forEach(function(a){var b=Nc.GetChild(a,Mc.ElementNames.X509IssuerName,Mc.NamespaceURI,!0),c=Nc.GetChild(a,Mc.ElementNames.X509SerialNumber,Mc.NamespaceURI,!0);b&&b.textContent&&c&&c.textContent&&d.AddIssuerSerial(b.textContent,c.textContent)}),e=this.GetChildren(Mc.ElementNames.X509SKI),e&&e.forEach(function(a){if(a.textContent){var b=I.FromBase64(a.textContent);d.AddSubjectKeyId(b)}}),e=this.GetChildren(Mc.ElementNames.X509SubjectName),null!=e&&e.forEach(function(a){a.textContent&&d.AddSubjectName(a.textContent)}),e=this.GetChildren(Mc.ElementNames.X509Certificate),e&&e.forEach(function(a){if(a.textContent){var b=I.FromBase64(a.textContent);d.AddCertificate(new te(b))}});var f=this.GetChild(Mc.ElementNames.X509CRL,!1);f&&f.textContent&&(this.x509crl=I.FromBase64(f.textContent))}},{key:"Key",get:function(){return this.key}},{key:"Certificates",get:function(){return this.X509CertificateList}},{key:"CRL",get:function(){return this.x509crl},set:function(b){this.x509crl=b}},{key:"IssuerSerials",get:function(){return this.IssuerSerialList}},{key:"SubjectKeyIds",get:function(){return this.SubjectKeyIdList}},{key:"SubjectNames",get:function(){return this.SubjectNameList}}]),b}(Pc);we=d([l({localName:Mc.ElementNames.X509Data})],we);var xe=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),_createClass(b,[{key:"importKey",value:function(b){var c=this;return Promise.resolve().then(function(){return Fc.crypto.subtle.exportKey("spki",b)}).then(function(a){return c.SPKIexp=new Uint8Array(a),c.Key=b,c})}},{key:"exportKey",value:function(b){var c=this;return Promise.resolve().then(function(){return Fc.crypto.subtle.importKey("spki",c.SPKIexp,b,!0,["verify"])}).then(function(a){return c.Key=a,a})}}]),b}(Pc);d([m({localName:Mc.ElementNames.SPKIexp,namespaceURI:Mc.NamespaceURI,prefix:Mc.DefaultPrefix,required:!0,converter:J})],xe.prototype,"SPKIexp",void 0),xe=d([l({localName:Mc.ElementNames.SPKIData})],xe);var ye={};ye[xd]=Bd,ye[yd]=Cd,ye[zd]=Dd,ye[Ad]=Ed,ye[fd]=jd,ye[gd]=kd,ye[hd]=ld,ye[id]=md,ye[od]=sd,ye[pd]=td,ye[qd]=ud,ye[rd]=vd;var ze={};ze[Yc]=ad,ze[Zc]=bd,ze[$c]=cd,ze[_c]=dd;var Ae=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"CreateFromName",value:function(b){var c=void 0;switch(b){case Mc.AlgorithmNamespaces.XmlDsigBase64Transform:c=new Xd;break;case Mc.AlgorithmNamespaces.XmlDsigC14NTransform:c=new Yd;break;case Mc.AlgorithmNamespaces.XmlDsigC14NWithCommentsTransform:c=new Zd;break;case Mc.AlgorithmNamespaces.XmlDsigEnvelopedSignatureTransform:c=new $d;break;case Mc.AlgorithmNamespaces.XmlDsigXPathTransform:throw new F(G.ALGORITHM_NOT_SUPPORTED,b);case Mc.AlgorithmNamespaces.XmlDsigXsltTransform:throw new F(G.ALGORITHM_NOT_SUPPORTED,b);case Mc.AlgorithmNamespaces.XmlDsigExcC14NTransform:c=new _d;break;case Mc.AlgorithmNamespaces.XmlDsigExcC14NWithCommentsTransform:c=new ae;break;case Mc.AlgorithmNamespaces.XmlDecryptionTransform:
throw new F(G.ALGORITHM_NOT_SUPPORTED,b);default:throw new F(G.ALGORITHM_NOT_SUPPORTED,b)}return c}},{key:"CreateSignatureAlgorithm",value:function(b){var c=ye[b.Algorithm]||null;if(c)return new c;if(b.Algorithm===Gd){var d=function(){var a=void 0;if(b.Any.Some(function(b){return b instanceof Qd&&(a=b),!!a}),a)switch(a.DigestMethod.Algorithm){case Yc:return{v:new Id(a.SaltLength)};case Zc:return{v:new Jd(a.SaltLength)};case $c:return{v:new Kd(a.SaltLength)};case _c:return{v:new Ld(a.SaltLength)}}throw new F(G.CRYPTOGRAPHIC,"Cannot get params for RSA-PSS algoriithm")}();if("object"===("undefined"==typeof d?"undefined":_typeof(d)))return d.v}throw new Error("signature algorithm '"+b.Algorithm+"' is not supported")}},{key:"CreateHashAlgorithm",value:function(b){var c=ze[b];if(c)return new c;throw new Error("hash algorithm '"+b+"' is not supported")}},{key:"GetHashAlgorithm",value:function(b){var c="string"==typeof b?{name:b}:b;switch(c.name.toUpperCase()){case Uc:return new ad;case Vc:return new bd;case Wc:return new cd;case Xc:return new dd;default:throw new F(G.ALGORITHM_NOT_SUPPORTED,c.name)}}},{key:"GetSignatureAlgorithm",value:function(b){"string"==typeof b.hash&&(b.hash={name:b.hash});var c=b.hash.name;if(!c)throw new Error("Signing algorithm doesn't have name for hash");var d=void 0;switch(b.name.toUpperCase()){case wd.toUpperCase():switch(c.toUpperCase()){case Uc:d=new Bd;break;case Vc:d=new Cd;break;case Wc:d=new Dd;break;case Xc:d=new Ed;break;default:throw new F(G.ALGORITHM_NOT_SUPPORTED,b.name+":"+c)}break;case Fd.toUpperCase():var e=b.saltLength;switch(c.toUpperCase()){case Uc:d=new Id(e);break;case Vc:d=new Jd(e);break;case Wc:d=new Kd(e);break;case Xc:d=new Ld(e);break;default:throw new F(G.ALGORITHM_NOT_SUPPORTED,b.name+":"+c)}break;case ed:switch(c.toUpperCase()){case Uc:d=new jd;break;case Vc:d=new kd;break;case Wc:d=new ld;break;case Xc:d=new md;break;default:throw new F(G.ALGORITHM_NOT_SUPPORTED,b.name+":"+c)}break;case nd:switch(c.toUpperCase()){case Uc:d=new sd;break;case Vc:d=new td;break;case Wc:d=new ud;break;case Xc:d=new vd;break;default:throw new F(G.ALGORITHM_NOT_SUPPORTED,b.name+":"+c)}break;default:throw new F(G.ALGORITHM_NOT_SUPPORTED,b.name)}return d}}]),a}(),Be=function(){function a(b){if(_classCallCheck(this,a),this.signature=new ie,b&&b.nodeType===s.Document)this.document=b;else if(b&&b.nodeType===s.Element){var c=(new XMLSerializer).serializeToString(b);this.document=(new DOMParser).parseFromString(c,r)}}return _createClass(a,[{key:"GetPublicKeys",value:function(){var b=this,c=[];return Promise.resolve().then(function(){var a=b.XmlSignature.KeyInfo.GetIterator(),d=[];return a.forEach(function(a){var e=Ae.CreateSignatureAlgorithm(b.XmlSignature.SignedInfo.SignatureMethod);a instanceof we?a.Certificates.forEach(function(a){d.push(a.exportKey(e.algorithm).then(function(a){c.push(a)}))}):d.push(a.exportKey(e.algorithm).then(function(a){c.push(a)}))}),Promise.all(d)}).then(function(){return c})}},{key:"FixupNamespaceNodes",value:function(b,c,d){var e=B(b);for(var f in e){var g=e[f];d&&""===f||c.setAttribute("xmlns"+(f?":"+f:""),g)}}},{key:"DigestReference",value:function(b,c,d){var e=this;return Promise.resolve().then(function(){var a=null;if(c.Uri&&!function(){var a=void 0;if(c.Uri.indexOf("#xpointer"))"#"===c.Uri[0]&&(a=c.Uri.substring(1));else{var d=c.Uri;d=d.substring(9).replace(/[\r\n\t\s]/g,""),d=d.length<2||"("!==d[0]||")"!==d[d.length-1]?"":d.substring(1,d.length-1),d.length>6&&0===d.indexOf("id(")&&")"===d[d.length-1]&&(a=d.substring(4,d.length-2))}a&&!function(){var c=null;if(e.XmlSignature.ObjectList&&e.XmlSignature.ObjectList.Some(function(d){if(c=Ce(d.GetXml(),a)){var f=c.cloneNode(!0);return e.FixupNamespaceNodes(b,f,!0),b=f,!0}return!1}),!c&&b&&(c=M.GetElementById(b,a))){var d=c.cloneNode(!0);e.FixupNamespaceNodes(b,d,!1),b=d}if(null==c)throw new F(G.CRYPTOGRAPHIC,"Cannot get object by reference: "+a)}()}(),c.Transforms&&c.Transforms.Count){if(c.Transforms.Sort(function(a,b){return b instanceof $d?1:0}).ForEach(function(c){c instanceof Zd&&(c=new Yd),c instanceof ae&&(c=new _d),c.LoadInnerXml(b),a=c.GetOutput()}),1===c.Transforms.Count&&c.Transforms.Item(0)instanceof $d){var d=new Yd;d.LoadInnerXml(b),a=d.GetOutput()}}else if(c.Uri&&"#"!==c.Uri[0])a=(new XMLSerializer).serializeToString(b);else{var f=new Yd;f.LoadInnerXml(b),a=f.GetOutput()}if(!c.DigestMethod.Algorithm)throw new F(G.NULL_PARAM,"Reference","DigestMethod");var g=Ae.CreateHashAlgorithm(c.DigestMethod.Algorithm);return g.Digest(a)})}},{key:"DigestReferences",value:function(b){var c=this;return Promise.resolve().then(function(){var a=c.XmlSignature.SignedInfo.References.Map(function(a){return a.DigestMethod.Algorithm||(a.DigestMethod.Algorithm=(new bd).namespaceURI),c.DigestReference(b,a,!1).then(function(b){a.DigestValue=b})}).GetIterator();return Promise.all(a)})}},{key:"TransformSignedInfo",value:function(){var b=Ae.CreateFromName(this.XmlSignature.SignedInfo.CanonicalizationMethod.Algorithm),c=this.XmlSignature.SignedInfo.GetXml();if(!c)throw new F(G.XML_EXCEPTION,"Cannot get Xml element from SignedInfo");var d=c.cloneNode(!0),e=B(c);for(var f in e){var g=e[f];f!==d.prefix&&d.setAttribute("xmlns"+(f?":"+f:""),g)}b.LoadInnerXml(d);var h=b.GetOutput();return h}},{key:"ApplySignOptions",value:function(b,c,d){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Promise.resolve().then(function(){if(e.keyValue&&d.algorithm.name.toUpperCase()!==nd){b.KeyInfo||(b.KeyInfo=new Vd);var a=b.KeyInfo,c=new re;return a.Add(c),c.importKey(e.keyValue)}return Promise.resolve()}).then(function(){return e.x509&&!function(){b.KeyInfo||(b.KeyInfo=new Vd);var a=b.KeyInfo;e.x509.forEach(function(b){var c=I.FromBase64(b),d=new we(c);a.Add(d)})}(),Promise.resolve()}).then(function(){if(e.references&&e.references.forEach(function(a){var c=new de;a.id&&(c.Id=a.id),a.uri&&(c.Uri=a.uri),a.type&&(c.Type=a.type);var d="string"==typeof a.hash?{name:a.hash}:a.hash,e=Ae.GetHashAlgorithm(d);c.DigestMethod.Algorithm=e.namespaceURI,a.transforms&&a.transforms.length&&!function(){var b=new be;a.transforms.forEach(function(a){switch(a){case"enveloped":b.Add(new $d);break;case"c14n":b.Add(new Yd);break;case"c14n-com":b.Add(new Zd);break;case"exc-c14n":b.Add(new _d);break;case"exc-c14n-com":b.Add(new ae);break;case"base64":b.Add(new Xd);break;default:throw new F(G.CRYPTOGRAPHIC_UNKNOWN_TRANSFORM,a)}}),c.Transforms=b}(),b.SignedInfo.References||(b.SignedInfo.References=new ee),b.SignedInfo.References.Add(c)}),!b.SignedInfo.References.Count){var a=new de;b.SignedInfo.References.Add(a)}return Promise.resolve()})}},{key:"Sign",value:function(b,c,d,e){var f=this,g=void 0,h=void 0;return Promise.resolve().then(function(){var a=C({},c.algorithm,b);return g=Ae.GetSignatureAlgorithm(a),f.ApplySignOptions(f.XmlSignature,b,c,e)}).then(function(){return h=f.XmlSignature.SignedInfo,f.DigestReferences(d.documentElement)}).then(function(){if(h.SignatureMethod.Algorithm=g.namespaceURI,Fd.toUpperCase()===b.name.toUpperCase()){var a=C({},c.algorithm,b);"string"==typeof a.hash&&(a.hash={name:a.hash});var d=new Qd(a);f.XmlSignature.SignedInfo.SignatureMethod.Any.Add(d)}else if(nd.toUpperCase()===b.name.toUpperCase()){var e=0,i=c.algorithm;switch(i.hash.name.toUpperCase()){case Uc:e=i.length||160;break;case Vc:e=i.length||256;break;case Wc:e=i.length||384;break;case Xc:e=i.length||512}f.XmlSignature.SignedInfo.SignatureMethod.HMACOutputLength=e}var j=f.TransformSignedInfo();return g.Sign(j,c,b)}).then(function(a){return f.Key=c,f.XmlSignature.SignatureValue=a,f.document=d,f.XmlSignature})}},{key:"ValidateReferences",value:function(b){var c=this;return Promise.resolve().then(function(){return Promise.all(c.XmlSignature.SignedInfo.References.Map(function(a){return c.DigestReference(b,a,!1).then(function(b){var c=I.ToBase64(b),d=I.ToString(a.DigestValue,"base64");if(c!==d){var e="Invalid digest for uri '"+a.Uri+"'. Calculated digest is "+c+" but the xml to validate supplies digest "+d;throw new F(G.CRYPTOGRAPHIC,e)}return Promise.resolve(!0)})}).GetIterator())}).then(function(){return!0})}},{key:"ValidateSignatureValue",value:function(b){var c=this,d=void 0,e=void 0;return Promise.resolve().then(function(){e=c.TransformSignedInfo(),d=Ae.CreateSignatureAlgorithm(c.XmlSignature.SignedInfo.SignatureMethod);var a=Promise.resolve(!1);return b.forEach(function(b){a=a.then(function(a){return a?Promise.resolve(a):d.Verify(e,b,c.Signature)})}),a})}},{key:"Verify",value:function(b){var c=this;return Promise.resolve().then(function(){var a=c.document;if(!a||!a.documentElement)throw new F(G.NULL_PARAM,"SignedXml","document");return c.ValidateReferences(a.documentElement)}).then(function(a){if(a){var d=Promise.resolve([]);return d=b?d.then(function(){return[b]}):d.then(function(){return c.GetPublicKeys()}),d.then(function(a){return c.ValidateSignatureValue(a)})}return!1})}},{key:"GetXml",value:function(){return this.signature.GetXml()}},{key:"LoadXml",value:function(b){this.signature=ie.LoadXml(b)}},{key:"toString",value:function(){var b=this.XmlSignature,c=!1;if(b.SignedInfo.References&&b.SignedInfo.References.Some(function(a){return a.Transforms&&a.Transforms.Some(function(a){return a instanceof $d&&(c=!0),c}),c}),c){var d=this.document.documentElement.cloneNode(!0),e=this.XmlSignature.GetXml();if(!e)throw new F(G.XML_EXCEPTION,"Cannot get Xml element from Signature");var f=e.cloneNode(!0);return d.appendChild(f),(new XMLSerializer).serializeToString(d)}return this.XmlSignature.toString()}},{key:"XmlSignature",get:function(){return this.signature}},{key:"Signature",get:function(){return this.XmlSignature.SignatureValue}}]),a}(),De=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([m({parser:Qc,required:!0})],De.prototype,"DigestMethod",void 0),d([m({localName:Mc.ElementNames.DigestValue,namespaceURI:Mc.NamespaceURI,prefix:Mc.DefaultPrefix,converter:J,required:!0})],De.prototype,"DigestValue",void 0),De=d([l({localName:P.ElementNames.DigestAlgAndValue})],De);var Ee=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(ue);Ee=d([l({localName:P.ElementNames.IssuerSerial,namespaceURI:P.NamespaceURI,prefix:P.DefaultPrefix})],Ee);var Fe=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([m({localName:P.ElementNames.CertDigest,parser:De,required:!0})],Fe.prototype,"CertDigest",void 0),d([m({parser:Ee,required:!0})],Fe.prototype,"IssuerSerial",void 0),d([n({localName:P.AttributeNames.URI})],Fe.prototype,"Uri",void 0),Fe=d([l({localName:P.ElementNames.Cert})],Fe);var Ge=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(R);Ge=d([l({localName:"CertIDList",parser:Fe})],Ge);var He=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Ge);He=d([l({localName:P.ElementNames.SigningCertificate})],He);var Ie=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([n({localName:P.AttributeNames.Id,defaultValue:""})],Ie.prototype,"Id",void 0),d([m({localName:P.ElementNames.CertRefs,parser:Ge,required:!0})],Ie.prototype,"CertRefs",void 0),Ie=d([l({localName:P.ElementNames.CompleteCertificateRefs})],Ie);var Je={set:function(b){return new Date(b)},get:function(b){if(b)return b.toISOString()}},Ke=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(S);Ke=d([l({localName:P.ElementNames.OtherRef})],Ke);var Le=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(R);Le=d([l({localName:P.ElementNames.OtherRefs})],Le);var Me=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([m({localName:P.ElementNames.ByName,namespaceURI:P.NamespaceURI,prefix:P.DefaultPrefix,required:!0})],Me.prototype,"ByName",void 0),d([m({localName:P.ElementNames.ByKey,namespaceURI:P.NamespaceURI,prefix:P.DefaultPrefix,converter:J,required:!0})],Me.prototype,"ByKey",void 0),Me=d([l({localName:P.ElementNames.OCSPIdentifier})],Me);var Ne=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([n({localName:P.AttributeNames.URI,defaultValue:""})],Ne.prototype,"URI",void 0),d([m({parser:Me,required:!0})],Ne.prototype,"ResponderID",void 0),d([m({localName:P.ElementNames.IssueTime,namespaceURI:P.NamespaceURI,prefix:P.DefaultPrefix,converter:Je,required:!0})],Ne.prototype,"ProducedAt",void 0),Ne=d([l({localName:P.ElementNames.OCSPIdentifier})],Ne);var Oe=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([m({parser:Ne})],Oe.prototype,"OCSPIdentifier",void 0),d([m({parser:De,required:!0})],Oe.prototype,"DigestAlgAndValue",void 0),Oe=d([l({localName:P.ElementNames.OCSPRef})],Oe);var Pe=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(R);Pe=d([l({localName:P.ElementNames.OCSPRefs})],Pe);var Qe=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([n({localName:P.AttributeNames.URI,defaultValue:""})],Qe.prototype,"URI",void 0),d([m({localName:P.ElementNames.Issuer,namespaceURI:P.NamespaceURI,prefix:P.DefaultPrefix,required:!0})],Qe.prototype,"Issuer",void 0),d([m({localName:P.ElementNames.IssueTime,namespaceURI:P.NamespaceURI,prefix:P.DefaultPrefix,converter:Je,required:!0})],Qe.prototype,"IssueTime",void 0),d([m({localName:P.ElementNames.Number,namespaceURI:P.NamespaceURI,prefix:P.DefaultPrefix,converter:K})],Qe.prototype,"Number",void 0),Qe=d([l({localName:P.ElementNames.CRLIdentifier})],Qe);var Re=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([m({parser:De,required:!0})],Re.prototype,"DigestAlgAndValue",void 0),d([m({parser:Qe})],Re.prototype,"CRLIdentifier",void 0),Re=d([l({localName:P.ElementNames.CRLRef})],Re);var Se=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(R);Se=d([l({localName:P.ElementNames.CRLRefs})],Se);var Te=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([n({localName:P.AttributeNames.Id,defaultValue:""})],Te.prototype,"Id",void 0),d([m({parser:Se})],Te.prototype,"CRLRefs",void 0),d([m({parser:Pe})],Te.prototype,"OCSPRefs",void 0),d([m({parser:Le})],Te.prototype,"OtherRefs",void 0),Te=d([l({localName:P.ElementNames.CompleteRevocationRefs})],Te);var Ue=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([m({parser:ie,required:!0})],Ue.prototype,"Signature",void 0),Ue=d([l({localName:P.ElementNames.CounterSignature})],Ue);var Ve=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([n({localName:P.AttributeNames.ObjectReference,required:!0})],Ve.prototype,"ObjectReference",void 0),d([m({localName:P.ElementNames.Description,namespaceURI:P.NamespaceURI,prefix:P.DefaultPrefix})],Ve.prototype,"Description",void 0),d([m({parser:ba})],Ve.prototype,"ObjectIdentifier",void 0),d([m({localName:P.ElementNames.MimeType,namespaceURI:P.NamespaceURI,prefix:P.DefaultPrefix})],Ve.prototype,"MimeType",void 0),d([m({localName:P.ElementNames.Encoding,namespaceURI:P.NamespaceURI,prefix:P.DefaultPrefix})],Ve.prototype,"Encoding",void 0),Ve=d([l({localName:P.ElementNames.DataObjectFormat})],Ve);var We=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([n({localName:P.AttributeNames.URI,defaultValue:"",required:!0})],We.prototype,"Uri",void 0),d([n({localName:P.AttributeNames.ReferencedData,defaultValue:!1})],We.prototype,"ReferencedData",void 0),We=d([l({localName:P.ElementNames.Include})],We);var Xe=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([n({localName:P.AttributeNames.URI,defaultValue:""})],Xe.prototype,"Uri",void 0),d([n({localName:P.AttributeNames.Id,defaultValue:""})],Xe.prototype,"Id",void 0),d([m({localName:Mc.ElementNames.DigestMethod,namespaceURI:Mc.NamespaceURI,prefix:Mc.DefaultPrefix,required:!0})],Xe.prototype,"DigestMethod",void 0),d([m({localName:Mc.ElementNames.DigestMethod,namespaceURI:Mc.NamespaceURI,prefix:Mc.DefaultPrefix,converter:J,required:!0})],Xe.prototype,"DigestValue",void 0),Xe=d([l({localName:P.ElementNames.ReferenceInfo})],Xe);var Ye=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(R);Ye=d([l({localName:"ReferenceInfos",parser:Xe})],Ye);var Ze=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(U);Ze=d([l({localName:P.ElementNames.EncapsulatedTimeStamp})],Ze);var $e=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(R);$e=d([l({localName:"EncapsulatedPKIDatas",parser:Ze})],$e);var _e=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(S);_e=d([l({localName:P.ElementNames.XMLTimeStamp})],_e);var af=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(R);af=d([l({localName:"XMLTimeStampCollection",parser:_e})],af);var bf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([n({localName:P.AttributeNames.Id,defaultValue:""})],bf.prototype,"Id",void 0),d([m({parser:We})],bf.prototype,"Include",void 0),d([m({parser:Ye,noRoot:!0})],bf.prototype,"ReferenceInfo",void 0),d([m({parser:Sd})],bf.prototype,"CanonicalizationMethod",void 0),d([m({parser:$e,noRoot:!0})],bf.prototype,"EncapsulatedTimeStamp",void 0),d([m({parser:af,noRoot:!0})],bf.prototype,"XMLTimeStamp",void 0),bf=d([l({localName:"GenericTimeStamp"})],bf);var cf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([n({localName:P.AttributeNames.Id,defaultValue:""})],cf.prototype,"Id",void 0),d([m({parser:Ye,noRoot:!0})],cf.prototype,"ReferenceInfo",void 0),d([m({parser:Sd})],cf.prototype,"CanonicalizationMethod",void 0),d([m({parser:$e,noRoot:!0})],cf.prototype,"EncapsulatedTimeStamp",void 0),d([m({parser:af,noRoot:!0})],cf.prototype,"XMLTimeStamp",void 0),cf=d([l({localName:P.ElementNames.OtherTimeStamp})],cf);var df=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([o({converter:K,required:!0})],df.prototype,"Value",void 0),df=d([l({localName:"int"})],df);var ef=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(R);ef=d([l({localName:"IntegerList",parser:df})],ef);var ff=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([m({localName:P.ElementNames.Organization,namespaceURI:P.NamespaceURI,prefix:P.DefaultPrefix,required:!0})],ff.prototype,"Organization",void 0),d([m({localName:P.ElementNames.NoticeNumbers,parser:ef,required:!0})],ff.prototype,"NoticeNumbers",void 0),ff=d([l({localName:P.ElementNames.NoticeRef})],ff);var gf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([m({localName:P.ElementNames.NoticeRef,parser:ff})],gf.prototype,"NoticeRef",void 0),d([m({localName:P.ElementNames.ExplicitText,namespaceURI:P.NamespaceURI,prefix:P.DefaultPrefix})],gf.prototype,"ExplicitText",void 0),gf=d([l({localName:P.ElementNames.SPUserNotice})],gf);var hf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(S);hf=d([l({localName:P.ElementNames.SigPolicyQualifier})],hf);var jf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(R);jf=d([l({localName:P.ElementNames.SigPolicyQualifiers,parser:hf})],jf);var kf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([m({localName:P.ElementNames.SigPolicyId,parser:ba,required:!0})],kf.prototype,"SigPolicyId",void 0),d([m({parser:be})],kf.prototype,"Transforms",void 0),d([m({localName:P.ElementNames.SigPolicyHash,parser:De,required:!0})],kf.prototype,"SigPolicyHash",void 0),d([m({localName:P.ElementNames.SigPolicyQualifiers,parser:jf})],kf.prototype,"SigPolicyQualifiers",void 0),kf=d([l({localName:P.ElementNames.SignaturePolicyId})],kf);var lf={set:function(b){return!0},get:function(b){return""}},mf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([m({localName:P.ElementNames.SignaturePolicyId,namespaceURI:P.NamespaceURI,prefix:P.DefaultPrefix,parser:kf})],mf.prototype,"SignaturePolicyId",void 0),d([m({localName:P.ElementNames.SignaturePolicyImplied,namespaceURI:P.NamespaceURI,prefix:P.DefaultPrefix,converter:lf,defaultValue:!1})],mf.prototype,"SignaturePolicyImplied",void 0),mf=d([l({localName:P.ElementNames.SignaturePolicyIdentifier})],mf);var nf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([m({localName:P.ElementNames.City,defaultValue:"",namespaceURI:P.NamespaceURI,prefix:P.DefaultPrefix})],nf.prototype,"City",void 0),d([m({localName:P.ElementNames.StateOrProvince,defaultValue:"",namespaceURI:P.NamespaceURI,prefix:P.DefaultPrefix})],nf.prototype,"StateOrProvince",void 0),d([m({localName:P.ElementNames.PostalCode,defaultValue:"",namespaceURI:P.NamespaceURI,prefix:P.DefaultPrefix})],nf.prototype,"PostalCode",void 0),d([m({localName:P.ElementNames.CountryName,defaultValue:"",namespaceURI:P.NamespaceURI,prefix:P.DefaultPrefix})],nf.prototype,"CountryName",void 0),nf=d([l({localName:P.ElementNames.SignatureProductionPlace})],nf);var of=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(S);of=d([l({localName:P.ElementNames.ClaimedRole})],of);var pf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(R);pf=d([l({localName:P.ElementNames.ClaimedRoles,parser:of})],pf);var qf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(U);qf=d([l({localName:P.ElementNames.CertifiedRole})],qf);var rf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(R);rf=d([l({localName:P.ElementNames.CertifiedRoles,parser:qf})],rf);var sf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([m({parser:pf})],sf.prototype,"ClaimedRoles",void 0),d([m({parser:rf})],sf.prototype,"CertifiedRoles",void 0),sf=d([l({localName:P.ElementNames.SignerRole})],sf);var tf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([n({localName:P.AttributeNames.Id,defaultValue:""})],tf.prototype,"Id",void 0),d([m({localName:P.ElementNames.SigningTime,namespaceURI:P.NamespaceURI,prefix:P.DefaultPrefix,converter:Je})],tf.prototype,"SigningTime",void 0),d([m({parser:He})],tf.prototype,"SigningCertificate",void 0),d([m({parser:mf})],tf.prototype,"SignaturePolicyIdentifier",void 0),d([m({parser:nf})],tf.prototype,"SignatureProductionPlace",void 0),d([m({parser:sf})],tf.prototype,"SignerRole",void 0),tf=d([l({localName:P.ElementNames.SignedSignatureProperties})],tf);var uf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([n({localName:P.AttributeNames.Id,defaultValue:""})],uf.prototype,"Id",void 0),d([m({parser:We})],uf.prototype,"Include",void 0),d([m({parser:Sd})],uf.prototype,"CanonicalizationMethod",void 0),d([m({parser:$e,noRoot:!0})],uf.prototype,"EncapsulatedTimeStamp",void 0),d([m({parser:af,noRoot:!0})],uf.prototype,"XMLTimeStamp",void 0),uf=d([l({localName:P.ElementNames.XAdESTimeStamp})],uf);var vf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(uf);vf=d([l({localName:P.ElementNames.IndividualDataObjectsTimeStamp})],vf);var wf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(R);wf=d([l({localName:"IndividualDataObjectsTimeStampCollection",parser:vf})],wf);var xf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(uf);xf=d([l({localName:P.ElementNames.AllDataObjectsTimeStamp})],xf);var yf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(R);yf=d([l({localName:"DataObjectFormatCollection",parser:Ve})],yf);var zf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(R);zf=d([l({localName:"CommitmentTypeIndicationCollection",parser:ha})],zf);var Af=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(R);Af=d([l({localName:"AllDataObjectsTimeStampCollection",parser:xf})],Af);var Bf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([n({localName:P.AttributeNames.Id,defaultValue:""})],Bf.prototype,"Id",void 0),d([m({parser:yf,noRoot:!0})],Bf.prototype,"DataObjectFormats",void 0),d([m({parser:zf,noRoot:!0})],Bf.prototype,"CommitmentTypeIndications",void 0),d([m({parser:Af,noRoot:!0})],Bf.prototype,"AllDataObjectsTimeStamps",void 0),d([m({parser:wf,noRoot:!0})],Bf.prototype,"IndividualDataObjectsTimeStamps",void 0),Bf=d([l({localName:P.ElementNames.SignedDataObjectProperties})],Bf);var Cf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([n({localName:P.AttributeNames.Id,defaultValue:""})],Cf.prototype,"Id",void 0),d([m({parser:tf})],Cf.prototype,"SignedSignatureProperties",void 0),d([m({parser:Bf})],Cf.prototype,"SignedDataObjectProperties",void 0),Cf=d([l({localName:P.ElementNames.SignedProperties})],Cf);var Df=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(U);Df=d([l({localName:P.ElementNames.OtherValue})],Df);var Ef=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(R);Ef=d([l({localName:P.ElementNames.OCSPValues,parser:Df})],Ef);var Ff=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(U);Ff=d([l({localName:P.ElementNames.EncapsulatedOCSPValue})],Ff);var Gf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(R);Gf=d([l({localName:P.ElementNames.OCSPValues})],Gf);var Hf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(U);Hf=d([l({localName:P.ElementNames.EncapsulatedCRLValue})],Hf);var If=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(R);If=d([l({localName:P.ElementNames.CRLValues,parser:Hf})],If);var Jf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([n({localName:P.AttributeNames.Id,defaultValue:""})],Jf.prototype,"Id",void 0),d([m({parser:If})],Jf.prototype,"CRLValues",void 0),d([m({parser:Gf})],Jf.prototype,"OCSPValues",void 0),d([m({parser:Ef})],Jf.prototype,"OtherValues",void 0),Jf=d([l({localName:P.ElementNames.RevocationValues})],Jf);var Kf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(uf);Kf=d([l({localName:P.ElementNames.SignatureTimeStamp})],Kf);var Lf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(uf);Lf=d([l({localName:P.ElementNames.SigAndRefsTimeStamp})],Lf);var Mf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(uf);Mf=d([l({localName:P.ElementNames.RefsOnlyTimeStamp})],Mf);var Nf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(uf);Nf=d([l({localName:P.ElementNames.ArchiveTimeStamp})],Nf);var Of=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Ie);Of=d([l({localName:P.ElementNames.AttributeCertificateRefs})],Of);var Pf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Te);Pf=d([l({localName:P.ElementNames.AttributeRevocationRefs})],Pf);var Qf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Z);Qf=d([l({localName:P.ElementNames.AttrAuthoritiesCertValues})],Qf);var Rf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Jf);Rf=d([l({localName:P.ElementNames.AttributeRevocationValues})],Rf);var Sf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);Sf=d([l({localName:"UnsignedSignatureProperty"})],Sf);var Tf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b.prototype.OnLoadXml=function(a){for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes.item(b);if(c.nodeType===s.Element){var d=void 0;switch(c.localName){case P.ElementNames.CounterSignature:d=Ue;break;case P.ElementNames.SignatureTimeStamp:d=Kf;break;case P.ElementNames.CompleteCertificateRefs:d=Ie;break;case P.ElementNames.CompleteRevocationRefs:d=Te;break;case P.ElementNames.AttributeCertificateRefs:d=Of;break;case P.ElementNames.AttributeRevocationRefs:d=Pf;break;case P.ElementNames.SigAndRefsTimeStamp:d=Lf;break;case P.ElementNames.RefsOnlyTimeStamp:d=Mf;break;case P.ElementNames.CertificateValues:d=Z;break;case P.ElementNames.RevocationValues:d=Jf;break;case P.ElementNames.AttrAuthoritiesCertValues:d=Qf;break;case P.ElementNames.AttributeRevocationValues:d=Rf;break;case P.ElementNames.ArchiveTimeStamp:d=Nf}if(d){var e=d.LoadXml(c);this.Add(e)}}}},b}(R);d([n({localName:P.AttributeNames.Id,defaultValue:""})],Tf.prototype,"Id",void 0),Tf=d([l({localName:P.ElementNames.UnsignedSignatureProperties,parser:Sf})],Tf);var Uf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(S);Uf=d([l({localName:P.ElementNames.UnsignedDataObjectProperty})],Uf);var Vf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(R);d([n({localName:P.AttributeNames.Id,defaultValue:""})],Vf.prototype,"Id",void 0),Vf=d([l({localName:P.ElementNames.UnsignedSignatureProperties,parser:Uf})],Vf);var Wf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([n({localName:P.AttributeNames.Id,defaultValue:""})],Wf.prototype,"Id",void 0),d([m({parser:Tf})],Wf.prototype,"UnsignedSignatureProperties",void 0),d([m({parser:Vf})],Wf.prototype,"UnsignedDataObjectProperties",void 0),Wf=d([l({localName:P.ElementNames.UnsignedProperties})],Wf);var Xf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([n({localName:P.AttributeNames.Target,required:!0})],Xf.prototype,"Target",void 0),d([n({localName:P.AttributeNames.Id,defaultValue:""})],Xf.prototype,"Id",void 0),d([m({parser:Cf})],Xf.prototype,"SignedProperties",void 0),d([m({parser:Wf})],Xf.prototype,"UnsignedProperties",void 0),Xf=d([l({localName:P.ElementNames.QualifyingProperties})],Xf);var Yf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Q);d([n({localName:P.AttributeNames.URI,required:!0})],Yf.prototype,"Uri",void 0),d([n({localName:P.AttributeNames.Id,defaultValue:""})],Yf.prototype,"Id",void 0),Yf=d([l({localName:P.ElementNames.QualifyingPropertiesReference})],Yf);var Zf=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return c(b,a),b}(Td);d([m({parser:Xf})],Zf.prototype,"QualifyingProperties",void 0),Zf=d([l({localName:Mc.ElementNames.Object})],Zf);var $f=Object.freeze({get Any(){return S},get OtherCertificate(){return V},get OtherCertificateCollection(){return W},get EncapsulatedX509Certificate(){return X},get EncapsulatedX509CertificateCollection(){return Y},get CertificateValues(){return Z},get CommitmentTypeQualifier(){return ca},get CommitmentTypeQualifiers(){return da},get ObjectReference(){return ea},get ObjectReferenceCollection(){return fa},get CommitmentTypeIndication(){return ha},get CompleteCertificateRefs(){return Ie},get OtherRef(){return Ke},get OtherRefs(){return Le},get ResponderID(){return Me},get OCSPIdentifier(){return Ne},get OCSPRef(){return Oe},get OCSPRefs(){return Pe},get CRLIdentifier(){return Qe},get CRLRef(){return Re},get CRLRefs(){return Se},get CompleteRevocationRefs(){return Te},get CounterSignature(){return Ue},get DataObjectFormat(){
return Ve},get EncapsulatedPKIData(){return U},get Include(){return We},get ReferenceInfo(){return Xe},get ReferenceInfos(){return Ye},get EncapsulatedTimeStamp(){return Ze},get EncapsulatedTimeStampCollection(){return $e},get XMLTimeStamp(){return _e},get XMLTimeStampCollection(){return af},get GenericTimeStamp(){return bf},get Identifier(){return $},get DocumentationReference(){return _},get DocumentationReferences(){return aa},get ObjectIdentifier(){return ba},get OtherTimeStamp(){return cf},get QualifyingProperties(){return Xf},get QualifyingPropertiesReference(){return Yf},get OtherValue(){return Df},get OtherValues(){return Ef},get EncapsulatedOCSPValue(){return Ff},get OCSPValues(){return Gf},get EncapsulatedCRLValue(){return Hf},get CRLValues(){return If},get RevocationValues(){return Jf},get Integer(){return df},get IntegerList(){return ef},get NoticeReference(){return ff},get SPUserNotice(){return gf},get SigPolicyQualifier(){return hf},get SigPolicyQualifiers(){return jf},get SignaturePolicyId(){return kf},get SignaturePolicyIdentifier(){return mf},get SignatureProductionPlace(){return nf},get IndividualDataObjectsTimeStamp(){return vf},get IndividualDataObjectsTimeStampCollection(){return wf},get AllDataObjectsTimeStamp(){return xf},get DataObjectFormatCollection(){return yf},get CommitmentTypeIndicationCollection(){return zf},get AllDataObjectsTimeStampCollection(){return Af},get SignedDataObjectProperties(){return Bf},get SignedProperties(){return Cf},get SignedSignatureProperties(){return tf},get ClaimedRole(){return of},get ClaimedRoles(){return pf},get CertifiedRole(){return qf},get CertifiedRoles(){return rf},get SignerRole(){return sf},get DigestAlgAndValueType(){return De},get IssuerSerial(){return Ee},get Cert(){return Fe},get CertIDList(){return Ge},get SigningCertificate(){return He},get UnsignedDataObjectProperty(){return Uf},get UnsignedDataObjectProperties(){return Vf},get UnsignedProperties(){return Wf},get SignatureTimeStamp(){return Kf},get SigAndRefsTimeStamp(){return Lf},get RefsOnlyTimeStamp(){return Mf},get ArchiveTimeStamp(){return Nf},get AttributeCertificateRefs(){return Of},get AttributeRevocationRefs(){return Pf},get AttrAuthoritiesCertValues(){return Qf},get AttributeRevocationValues(){return Rf},get UnsignedSignatureProperty(){return Sf},get UnsignedSignatureProperties(){return Tf},get XAdESTimeStamp(){return uf},get DataObject(){return Zf},XmlXades:P}),_f="http://uri.etsi.org/01903#SignedProperties",ag=function(a){function b(b){var c=a.call(this,b)||this;return c.properties=null,c.CreateQualyingProperties(),c}return c(b,a),Object.defineProperty(b.prototype,"Properties",{get:function(){return this.properties},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"SignedProperties",{get:function(){if(!this.Properties)throw new F(G.XML_EXCEPTION,"Properties is empty");return this.Properties.SignedProperties},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"UnsignedProperties",{get:function(){if(!this.Properties)throw new F(G.XML_EXCEPTION,"Properties is empty");return this.Properties.UnsignedProperties},enumerable:!0,configurable:!0}),b.prototype.LoadXml=function(b){a.prototype.LoadXml.call(this,b);var c=null;this.XmlSignature.ObjectList.Some(function(a){if(a.Element)for(var b=0;b<a.Element.childNodes.length;b++){var d=a.Element.childNodes.item(b);if(d.nodeType===s.Element&&d.localName===P.ElementNames.QualifyingProperties)return c=Xf.LoadXml(d),!0}return!1}),this.properties=c},b.prototype.CreateQualyingProperties=function(){if(this.Properties)throw new F(G.XML_EXCEPTION,"Cannot create QualifyingProperties cause currensignature has got one. You must create CounterSignature");var a=Fc.crypto.getRandomValues(new Uint8Array(6)),b=I.ToHex(a);this.XmlSignature.Id="id-"+b;var c=new Zf;c.QualifyingProperties.Target="#"+this.XmlSignature.Id,c.QualifyingProperties.SignedProperties.Id="xades-"+this.XmlSignature.Id,this.properties=c.QualifyingProperties,this.XmlSignature.ObjectList.Add(c)},b.prototype.ApplySignOptions=function(b,c,d,g){return e(this,void 0,void 0,function(){var e,h,i,j;return f(this,function(f){switch(f.label){case 0:return[4,a.prototype.ApplySignOptions.call(this,b,c,d,g)];case 1:return f.sent(),this.Properties?(e=this.Properties.SignedProperties.SignedSignatureProperties,e.SigningTime=new Date,h=C({},c,d.algorithm),i=h.hash,j=new de,j.Type=_f,j.Uri="#"+this.Properties.SignedProperties.Id,j.DigestMethod.Algorithm=Ae.GetHashAlgorithm(i).namespaceURI,b.SignedInfo.References.Add(j),[4,this.ApplySigningCertificate(g.signingCertificate)]):[3,3];case 2:f.sent(),this.ApplySignaturePolicyIdentifier(g.policy),this.ApplySignatureProductionPlace(g.productionPlace),this.ApplySignerRoles(g.signerRole),f.label=3;case 3:return[2]}})})},b.prototype.Sign=function(b,c,d,e){return a.prototype.Sign.apply(this,arguments)},b.prototype.ApplySigningCertificate=function(a){return e(this,void 0,void 0,function(){var b,c,d,e,g,h,i;return f(this,function(f){switch(f.label){case 0:if(!this.Properties||!a)return[3,2];if(b=I.FromBase64(a),c=new te(b),d=this.Properties.SignedProperties.SignedSignatureProperties,d.SigningCertificate.Count)throw new F(G.XML_EXCEPTION,"Signature can contain only one SigningCertificate");return e=new Fe,e.IssuerSerial.X509IssuerName=c.Issuer,e.IssuerSerial.X509SerialNumber=c.SerialNumber,g=Ae.GetHashAlgorithm("SHA-256"),e.CertDigest.DigestMethod.Algorithm=g.namespaceURI,h=e.CertDigest,i=Uint8Array.bind,[4,c.Thumbprint(g.algorithm.name)];case 1:h.DigestValue=new(i.apply(Uint8Array,[void 0,f.sent()])),this.Properties.SignedProperties.SignedSignatureProperties.SigningCertificate.Add(e),f.label=2;case 2:return[2]}})})},b.prototype.ApplySignaturePolicyIdentifier=function(a){if(this.Properties){var b=this.Properties.SignedProperties.SignedSignatureProperties;a||(b.SignaturePolicyIdentifier.SignaturePolicyImplied=!0)}},b.prototype.ApplySignatureProductionPlace=function(a){if(this.Properties&&a){var b=this.Properties.SignedProperties.SignedSignatureProperties;a.city&&(b.SignatureProductionPlace.City=a.city),a.code&&(b.SignatureProductionPlace.PostalCode=a.code),a.country&&(b.SignatureProductionPlace.CountryName=a.country),a.state&&(b.SignatureProductionPlace.StateOrProvince=a.state)}},b.prototype.ApplySignerRoles=function(a){if(this.Properties&&a){var b=this.Properties.SignedProperties.SignedSignatureProperties;a.claimed&&a.claimed.forEach(function(a){var c=new of;c.Value=a,b.SignerRole.ClaimedRoles.Add(c)}),a.certified&&a.certified.forEach(function(a){var c=new qf;c.Encoding="der",c.Value=I.FromBase64(a),b.SignerRole.CertifiedRoles.Add(c)})}},b.prototype.VerifySigningCertificate=function(){return e(this,void 0,void 0,function(){var a,b,c,d,e,g,h,i,j,k,l,m,n,p;return f(this,function(f){switch(f.label){case 0:if(a=null,!this.XmlSignature||!this.Properties)return[3,7];if(b=this.Properties.SignedProperties.SignedSignatureProperties,1!==b.SigningCertificate.Count)throw new F(G.XML_EXCEPTION,"Signature has got wrong amount of SigningCertificate, MUST be one");c=Ae.GetHashAlgorithm("SHA-256"),d=b.SigningCertificate.Item(0),e=I.ToBase64(d.CertDigest.DigestValue),g=this.XmlSignature.KeyInfo,h=0,f.label=1;case 1:if(h<g.Count,!!a)return[3,6];if(i=g.Item(h),!(i instanceof we))return[3,5];j=i.Certificates,k=0,f.label=2;case 2:return k<j.length,a?[3,5]:(l=j[k])?(n=Uint8Array.bind,[4,l.Thumbprint(c.algorithm)]):[3,4];case 3:m=new(n.apply(Uint8Array,[void 0,f.sent()])),p=I.ToBase64(m),p===e&&(a=l),f.label=4;case 4:return k++,[3,2];case 5:return h++,[3,1];case 6:if(!a||a.Issuer!==d.IssuerSerial.X509IssuerName||a.SerialNumber!==d.IssuerSerial.X509SerialNumber)throw new F(G.XML_EXCEPTION,"SigningCertificate not found");f.label=7;case 7:return[2,a]}})})},b}(Be),bg=$f;a.xml=bg,a.Select=x,a.Parse=y,a.Convert=I,a.SignedXml=ag,Object.defineProperty(a,"__esModule",{value:!0})});